\title{
Useful factors are fewer than you think
}

\begin{abstract}
We examine how many factors out of a wide range of 207 have incremental information in explaining cross-sectional stock returns. First, we find that the significance of each factor changes drastically over time. After accounting for the false discovery rate (FDR), only 157 out of 207 factors are significant from 1967 to 2021, and only 56 from 2000 to 2021. Second, from 2000 to 2021, we find strikingly that only 3 clusters of factors have incremental information. We further propose a new flexible timevarying latent factor model, and test in an alternative way on the number of factors that capture the information of the 56 significant factors while controlling for FDR, and find only 3 , the market plus 2 latent ones, when without asset pricing restrictions, and find only 4 , the market plus 3 latent ones, when with asset pricing restrictions, respectively. In either case, the number of factors is much fewer than widely believed.
\end{abstract}

\section*{1 Introduction}

Numerous factors have been identified to explain the cross-section of stock returns in the past 50 years. In his presidential address, Cochrane (2011) asks two important and related questions. First, how many factors do we really need? Second, given a factor model such as the CAPM, are there other factors that can provide incremental information for explaining the cross-section of expected stock returns?

Answers to the questions are inconclusive. On the one hand, Harvey et al. (2016) argue that most claimed findings in significant factors for the cross-sectional stock returns are likely false after controlling for the false discovery rate (FDR), and McLean and Pontiff (2016) show that the out-of-sample and post-publication return are substantially lower. Both studies allow for a large number of factors, although their studies cast doubt on
the validity of many claimed factors. On the other hand, Chen (2021) shows that $p$ hacking cannot explain the large set of observed factors, and Chen and Zimmermann (2021) replicate up to 207 factors, the largest to date, and will be ones analyzed further by this paper. Consistent with Chen and Zimmermann (2021), Jensen et al. (2023) show that most anomalies originally discovered in the US are robust internationally.

In this paper, we address two questions. First, inspired by Harvey et al. (2016), we ask how many of the 207 factors remain significant after controlling for FDR. Complimenting to Harvey et al. (2016), we examine not only far more factors but also use additional statistical procedures and consider weighting factors by their economic motivations. Moreover, we study how the significance changes over time, and the number of economic risk sources as captured by factor clusters.

The second question addressed here is how many economic risk sources we need to capture the risks of a given set of significant factors. For this purpose, we propose a flexible high-dimensional time-varying latent factor model to test the number of factors. While latent factor models are used in finance theoretically since Ross (1976), and empirically by Connor and Korajczyk (1986) and Lettau and Pelger (2020b), among many others, we find that the constant loading models are rejected by the data. Hence, our proposed time-varying latent factor model also adds to the literature on factor models.

Empirically, we find that, of the comprehensive set of 207 factors compiled by Chen and Zimmermann (2021), there are only 157 significant ones after accounting for FDR, from 1967 to 2021, and there are only 56 from 2000 to 2021. A 20-year rolling estimation shows a declining pattern of the number of significant factors. Not all factors are economically well established. Of the 15 factors except for the market that are motivated by well-known factor models of Fama and French (1993, 2015, 2018), Hou et al. (2015), Stambaugh and Yuan (2017), and Daniel et al. (2020), we find that, while 14 of them are significant from 1967 to 2021, there are only 3 of them remain significant from 2000 to 2021. The decline of such model-motivated (MM) factors is simply striking. Moreover, for the 56 significant factors from 2000 to 2021, they are highly correlated and many of them are redundant. In terms of clusters, 3 of them are sufficient to capture the variations of the 56 factors.

Consistent with the above findings, our flexible time-varying latent factor model also reveals, in the case of without imposing asset pricing restrictions in the latent factor model, that there are three factors, the market plus 2 latent factors, which are sufficient to explain all 56 significant factors. To gain improved explanatory power of the latent factor model, we also consider the case of imposing asset pricing restrictions in a manner similar to Lettau and Pelger (2020a, b), who impose such constraints on the PCA. In this case, we find that there are a total of 4 factors that are needed, the market plus 3 latent factors. Overall, our conclusion is that the number of systematic risk sources is much fewer than commonly believed.

Our paper shows a sharp decline in factors from 1967 to 2000. Why is the number of factors declining over time? There appear three major reasons. First, as put forth by Green et al. (2017), there are some major regulatory changes around or after the year 2000: the Sarbanes-Oxley Act, the acceleration of $10-\mathrm{Q}$ and $10-\mathrm{K}$ filing requirements by the SEC, and the introduction of autoquoting by the NYSE. All of these lead to falling costs and faster speed for exploiting mispricing. Second, Schwert (2003) and McLean and Pontiff (2016), among others, argue forcefully that anomalies, such as the size and value, are often attenuated or disappear after the original research was published, due to learning by arbitragers and investors. Third, Lo (2004) proposes his adaptive market hypothesis that investors and the market adapt to a changing environment over time. Nagel (2021) further emphasize that adaptivity is a feature in the age of big financial data. Consistent with the adaptive market hypothesis, many mispricing factors that impact firms' profitability are likely understood and exploited away over time by investors, and hence are no longer as important as they used to be. Some features are subject to structural change around 2000, our analysis below will focus on the 2000 to 2021 period.

Our paper is related to a growing number of recent studies on factors and firm characteristics. Kelly et al. (2019) introduce instrumented PCA (IPCA) to model latent factors and time-varying loadings. In contrast to their model, our loadings are nonparametric and we focus on testing the number of factors in replacing the existing factor candidates. While Freyberger et al. (2020), Gu et al. (2020), Kozak et al. (2020) and Avramov et al. (2022), among others, also provide insights on how many factors or firm characteristics
that matter, they focus on predicting the expected returns using past information. In contrast, we focus on factor models explaining the expected returns with contemporaneous information. The difference between the two is obvious: while the market factor can explain the expected returns well in many applications, it is of little use as a predictor. Although He et al. (2022) and Chib et al. (2022) achieve factor reduction in the explanatory setting, they apply neither clusters nor latent factors. As a result, they reach different conclusions from us.

The rest of the paper is organized as follows. In Section 2, we consider several models and testing procedures including the multiple testing procedure based on the timevarying factor model, which has never been considered in the literature. Section 3 discusses the empirical findings using the long-short strategy returns. In Section 4, we compare the accumulative wealth of investment based on the time-varying latent factor model, the cluster factors and the benchmark Fama-French 3-factor model. Section 5 concludes. All mathematical proofs are provided in the Online Appendix.

\section*{2 Methodology}

\subsection*{2.1 Significant factors under FDR}

Suppose we have $N$ factors formed by long-short portfolios (see, e.g., Chen and Zimmermann (2021)). Consider the CAPM regressions,
$$
\begin{equation*}
r_{i, t}=\alpha_{i}+\beta_{i} f_{t}+u_{i, t}, \quad 1 \leq i \leq N, 1 \leq t \leq T \tag{1}
\end{equation*}
$$
where $r_{i t}$ is the excess return of long-short portfolios $i$ at time $t, f_{t}$ is the market excess return, $\beta_{i}$ is the factor loading, and $u_{i, t}$ is the idiosyncratic component.

The objective is to find those factors with truly significant alphas after controlling for FDR. To do so, we formulate the following hypotheses:
$$
\begin{equation*}
\mathbb{H}_{0}^{i}: \alpha_{i}=0 \quad \text { versus } \mathbb{H}_{A}^{i}: \alpha_{i} \neq 0, \quad \text { for } \quad 1 \leq i \leq N \tag{2}
\end{equation*}
$$

This is a multiple-testing problem. The central difficulty when testing a large number of null hypotheses is that several of them may appear to be rejected, purely by chance. We would like the set of rejected null hypotheses to have high precision so that most discovered risk factors are truly useful for prediction. It is known that separately controlling the FDR for each individual test does not provide any guarantee of precision. Thus, we adopt the popular Benjamini and Hochberg (1995)(BH) method to control the FDR at level $q$ as follows:
1. Run time series regressions and obtain the OLS estimator $\widehat{\boldsymbol{\beta}}_{i}$.
2. Estimate $\alpha_{i}$ by subtracting the estimated risk premium from average returns:
$$
\widehat{\alpha}_{i}=\bar{r}_{i}-\widehat{\boldsymbol{\beta}}_{i}^{\top} \bar{f} .
$$
3. For each $1 \leq i \leq N$, compute the individual t -statistics $t_{i}$ for the hypothesis $\mathbb{H}_{0}^{i}$ and the corresponding p -values $p_{i}$. Sort the p -values and denote $p_{(1)} \leq p_{(2)} \ldots \leq p_{(N)}$ as the ordered p -values.
4. Choose
$$
\widehat{k}=\max \left\{i: p_{(i)} \leq \frac{i q}{N}\right\}
$$
and reject all null hypotheses $\mathbb{H}_{0}^{i}$ for $i=1, \ldots, \widehat{k}$.

\subsection*{2.2 Incorporating economic importance}

Chib et al. (2022) show that a seven-factor asset pricing model, consisting of $\{\mathrm{Mkt}, \mathrm{SMB}$, MOM, ROE, MGMT, PERF, and PEAD $\}$ gets the most support from the data. We divide the set of hypotheses into two groups. One consists of \{Mom12m, Mom12mOffSeason, Mom6m, MomOffSeason, MomOffSeason06YrPlus, MomOffSeason16YrPlus, MomRev, MomSeason, MomSeason06YrPlus, MomSeason11YrPlus, MomSeason16YrPlus, MomSeasonShort, MomVol, Investment, RoE\}, which are factors that cover the markets and fundamentals and correspond to the factors with stronger data support. \{Mom12m, Mom12mOffSeason, Mom6m, MomOffSeason, MomOffSeason06YrPlus, MomOffSeason16YrPlus, MomRev,

MomSeason, MomSeason06YrPlus, MomSeason11YrPlus, MomSeason16YrPlus, MomSeasonShort, MomVol\} are price momentum factors. RoE is the return on equity factor, and Investment is a fundamental factor that measures the investment of a firm. The other group consists of the rest of the factors.

The group of model-motivated factors is expected to be rejected more easily. To understand the difference between the two groups, we adopt the procedure proposed by Genovese et al. (2006) (GRW) to assign weights to individual hypotheses and conduct multiple hypothesis testing while incorporating prior information about the hypotheses:
1. Assign weights so that $\sum_{i=1}^{N} w_{i}=N$.
2. For each $i=1, \ldots, N$, compute $p_{i}^{w}=p_{i} / w_{i}$.
3. Apply Benjamini and Hochberg (1995) at level $q$ to $p_{i}^{w}$.

We consider a binary weighting scheme. Define a confidence parameter $\gamma$, which measures how confident we are in the group with model-motivated factors vs the other group. For example, if $\gamma=1$, we are indifferent between these two groups; if $\gamma=2$, we believe that the important group is twice more likely to be identified than the other group. Let $G_{I}$ denote the group with economically important factors, $G_{R}$ denote the group with the remaining factors, and $N_{I}$ be the number of factors in $G_{I}$. The binary weighting is chosen as:
$$
w_{i}= \begin{cases}\frac{N \gamma}{N+(\gamma-1) N_{I}} & \text { if } \quad i \in G_{I},  \tag{3}\\ \frac{N}{N+(\gamma-1) N_{I}} & \text { otherwise. }\end{cases}
$$

Note that the normalization restriction $\sum_{i=1}^{N} w_{i}=N$ is satisfied by construction.

\subsection*{2.3 Are our results robust to latent factors?}

Model (1) assumes that $f_{t}$ is the market excess return, which is observable. Our empirical analysis shows that the anomaly returns based on model (1) have high cross-sectional correlation ${ }^{1}$, suggesting that anomalies potentially have exposures to unknown common risk factors. As discussed in Giglio and Xiu (2021) and Giglio et al. (2021), uncounted latent factors might lead to biased alpha estimates and misleading testing results. Therefore, we reconsider model (1), assuming $f_{t}$ is a $r$-dimensional vector of factors, which is a collection of the observed factor $f_{o, t}$ and latent factors $f_{l, t}$. Model (1) can be rewritten as
$$
\begin{equation*}
r_{i, t}=\underbrace{\alpha_{i}+\beta_{i}^{\top} \lambda}_{\text {Return }}+\underbrace{\beta_{i}^{\top}\left(f_{t}-\mathbb{E}\left[f_{t}\right]\right)+u_{i, t}}_{\text {Risk }}, \quad i \leq N, t \leq T \tag{4}
\end{equation*}
$$
where the loading $\beta_{i}$ is interpreted as exposure to systematic risk factors, and $\lambda$ as the risk premiums associated with factors. Note that $\alpha_{i}, \beta_{i}, \lambda$ and $f_{l, t}$ are all unobserved and need to be estimated from data. We adopt Giglio et al. (2021)'s procedure to compute the bootstrap p-value $p_{i}$ and then apply Benjamini and Hochberg (1995).

\footnotetext{
${ }^{1}$ Around half of the correlations among the estimated anomaly returns exceed 0.5.
}

\subsection*{2.4 Time-varying alphas}

The rolling regression in Section 2.1 shows that both $\alpha$ and $\beta$ appear to change over time. We further apply Fu et al. (2023) to test whether $\alpha$ and $\beta$ are constant over time and the $p$ value based on 1,000 bootstrap iterations is 0.003 , which suggests strong rejection at any conventional significance levels. Therefore, we consider a time-varying high-dimensional factor model for excess returns of the form
$$
\begin{equation*}
r_{i, t}=\alpha_{i, t}+\beta_{i, t}^{\top} \lambda_{t}+\beta_{i, t}^{\top}\left(f_{t}-\mathbb{E}\left[f_{t}\right]\right)+u_{i, t}, \quad i \leq N, t \leq T, \tag{5}
\end{equation*}
$$
where $f_{t}=\left(f_{o, t}^{\top}, f_{l, t}^{\top}\right)^{\top}$ is again a collection of the observed tradable factors $f_{o, t}$ and latent factors $f_{l, t}$. But unlike model (4), $\alpha_{i, t}, \beta_{i, t}$ and $\lambda_{t}$ are allowed to be changing over time. The number of factors is time-invariant. This model can be viewed as a generalization of the constant parameter factor model considered in Giglio et al. (2021) by allowing for structural changes in alpha and factor loadings.

To cover a wide range of potential time variation, we follow the literature on smooth time-varying parameter models (e.g., Robinson (1989), Cai (2007), Su and Wang (2017))
and model $\alpha_{i, t}$ and $\beta_{i, t}$ as non-stochastic functions of $t / T$, that is,
$$
\begin{aligned}
& \alpha_{i, t}=\alpha_{i}(t / T) \\
& \beta_{i, t}=\beta_{i}(t / T)
\end{aligned}
$$
where $\alpha_{i, t}(\cdot)$ and $\beta_{i, t}(\cdot)$ are some unknown smooth functions of $t / T$ on $[0,1]$ for each $i$. The specification that alpha and beta are some functions of ratio $t / T$ rather than time $t$ only is a common scaling scheme in the literature (see, e.g., Phillips and Hansen (1990), Robinson (1991) and Cai (2007)). The reason for this specification is that nonparametric estimators for $\alpha_{i, t}(\cdot)$ and $\beta_{i, t}(\cdot)$ will not be consistent unless the amount of data on which they depend increases, and merely increasing the sample size will not necessarily improve the estimation of $\alpha_{i, t}(\cdot)$ and $\beta_{i, t}(\cdot)$ at some fixed point $t$, even if some smoothness conditions are imposed. The amount of local information must increase suitably if the variance and bias of nonparametric estimators of $\alpha_{t}$ and $\beta_{t}$ are to decrease suitably.

To estimate the model (5), we first consider a local least squared estimation and obtain the time-varying estimator $\widehat{\beta}_{o, i, t}$ for the loading of the observed factor and residual $z_{i, t}$
$$
\widehat{\beta}_{o, i, t}=\left(\sum_{s=1}^{T} K_{h, t s}\left(f_{o, s}-\bar{f}_{o, t}\right)\left(f_{o, s}-\bar{f}_{o, t}\right)^{\top}\right)^{-1}\left(\sum_{s=1}^{T} K_{h, t s}\left(r_{i, s}-\bar{r}_{i, t}\right)\left(f_{o, s}-\bar{f}_{o, t}\right)\right),
$$
and
$$
z_{i, t}=\left(r_{i, t}-\bar{r}_{i, t}\right)-\widehat{\beta}_{o, i, t}^{\top}\left(f_{o, t}-\bar{f}_{o, t}\right),
$$
where
$$
\bar{f}_{o, t}=\frac{1}{T} \sum_{s=1}^{T} K_{h, t s} f_{o, s}
$$
and
$$
\bar{r}_{i, t}=\frac{1}{T} \sum_{s=1}^{T} K_{h, t s} r_{i, s}
$$
are the local sample averages of the observed factor and return at time $t$ respectively. $K_{h, t s}$
is the boundary-modified kernel function:
$$
K_{h, t s}= \begin{cases}h^{-1} k\left(\frac{t-s}{T h}\right) / \int_{-s /(T h)}^{1} k(u) d u & \text { ifs } \in[1,\lfloor T h\rfloor]  \tag{6}\\ h^{-1} k\left(\frac{t-s}{T h}\right) & \text { ifs } \in[\lfloor T h\rfloor, T-\lfloor T h\rfloor], \\ h^{-1} k\left(\frac{t-s}{T h}\right) / \int_{-1}^{(1-s / T) / h} k(u) d u & \text { otherwise, }\end{cases}
$$
the kernel $k(\cdot):[-1,1] \mapsto \mathbb{R}^{+}$is a prespecified symmetric probability density, $h=h(T, N)$ is a bandwidth parameter, and $\lfloor T h\rfloor$ denotes the integer part of $T h$. Examples of $k(\cdot)$ include the uniform, Epanechnikov and quartic kernels. This boundary-modified kernel function has been used in Hong and Li (2005) and Su and Wang (2017).

Then we define the local sample covariance matrix as
$$
\begin{equation*}
\widehat{\Sigma}_{t}=\frac{1}{T} \sum_{s=1}^{T} K_{h, t s} z_{s} z_{s}^{\top} \tag{7}
\end{equation*}
$$
where $z_{s}=\left(z_{1, s}, z_{2, s}, \cdots, z_{N, s}\right)^{\top}$. Under the identification condition $\frac{1}{N} \beta_{l, t}^{\top} \beta_{l, t}=I$, the L-RPPCA estimator $\widehat{\beta}_{l, t}$ for the loading of the latent factor is comprised of $\sqrt{N}$ times top $r$ eigenvectors of $\widehat{\Sigma}_{t}$ in descending order by corresponding eigenvalues.

Similar to Fan et al. (2022) and Giglio et al. (2021), we run a cross-sectional regression of $\bar{r}_{t}$ on $\widehat{\boldsymbol{\beta}}_{t}$ and a constant regressor $1_{N}$ to obtain the risk premia of latent factors:
$$
\begin{equation*}
\widehat{\lambda}_{l, t}=\left(\widehat{\boldsymbol{\beta}}_{l, t}^{\top} \mathbb{M}_{1_{N}} \widehat{\boldsymbol{\beta}}_{l, t}\right)^{-1}\left(\widehat{\boldsymbol{\beta}}_{l, t}^{\top} \mathbb{M}_{1_{N}} \bar{r}_{\lambda, t}\right) \tag{8}
\end{equation*}
$$
where
- $\bar{r}_{\lambda, t}=\bar{r}_{t}-\widehat{\boldsymbol{\beta}}_{o, t} \bar{f}_{o, t} ;$
- $\mathbb{M}_{1_{N}}=I_{N}-1_{N}\left(1_{N}^{\top} 1_{N}\right)^{-1} 1_{N}^{\top}$, and $1_{N}$ is the $N \times 1$ vector of ones, $I_{p}$ is an identity matrix.

And the mispricing $\widehat{\alpha_{t}}$ is obtained via
$$
\begin{equation*}
\widehat{\alpha}_{t}=\bar{r}_{t}-\widehat{\beta}_{t}^{\top} \widehat{\lambda}_{t} \tag{9}
\end{equation*}
$$
where $\widehat{\boldsymbol{\beta}}_{t}=\left(\widehat{\boldsymbol{\beta}}_{o, t}^{\top}, \widehat{\boldsymbol{\beta}}_{l, t}^{\top}\right)^{\top}$ and $\widehat{\boldsymbol{\lambda}}_{t}=\left(\bar{f}_{o, t}^{\top}, \widehat{\boldsymbol{\lambda}}_{l, t}^{\top}\right)^{\top}$. As shown in Theorem 2 in the appendix, $\widehat{\alpha}_{t}$
has an asymptotic normal distribution and hence the $t$-statistic and $p$-values based on the limiting distribution can be calculated. To improve the finite sample performance, we consider the following bootstrap procedure in the same spirit as Giglio et al. (2021).
1. The above two-step nonparametric estimation yields the residual
$$
\widehat{u}_{i, t}=r_{i, t}-\bar{r}_{i, t}-\widehat{\boldsymbol{\beta}}_{i, t}^{\top} \widehat{\boldsymbol{v}}_{t},
$$
where $\widehat{\boldsymbol{v}}_{t}=\left(\left(f_{o, t}-\bar{f}_{o, t}\right)^{\top}, \widehat{\boldsymbol{v}}_{l, t}^{\top}\right)^{\top}$, and $\widehat{\boldsymbol{v}}_{l, t}=\frac{1}{N} \widehat{\boldsymbol{\beta}}_{l, t}^{\top} z_{t}$. Then obtain a wild bootstrap residual $\widehat{u}_{i, t}^{*}=a_{i, t} \overline{\bar{u}}_{i, t}$, where $\left\{a_{i, t}\right\}$ is a sequence of i.i.d. random variables with mean 0 variance 1 , and $\widehat{\widehat{u}}_{i, t}=\widehat{u}_{i, t}-T^{-1} \sum_{t=1}^{T} \widehat{u}_{i, t}$. And construct a bootstrap sample
$$
r_{i, t}^{*}=\widehat{\boldsymbol{\beta}}_{i, t}^{\top} \widehat{\boldsymbol{\lambda}}_{t}+\widehat{\boldsymbol{\beta}}_{i, t}^{\top} \widehat{v}_{t}+\widehat{u}_{i, t}^{*} .
$$
2. Estimate the $\widehat{\boldsymbol{\beta}}_{i, t}^{*}$ via local LS:
$$
\widehat{\boldsymbol{\beta}}_{i, t}^{*}=\left(\sum_{s=1}^{T} K_{h, t s}\left(\boldsymbol{v}_{s}-\overline{\boldsymbol{v}}_{t}\right)\left(\boldsymbol{v}_{s}-\overline{\boldsymbol{v}}_{t}\right)^{\top}\right)^{-1}\left(\sum_{s=1}^{T} K_{h, t s}\left(r_{i, s}^{*}-\bar{r}_{i, t}^{*}\right)\left(\boldsymbol{v}_{s}-\overline{\boldsymbol{v}}_{t}\right)\right)
$$
3. Obtain $\widehat{\lambda}_{t}^{*}$ and the risk premium $\widehat{\alpha}_{t}^{*}$ for the bootstrap sample
$$
\widehat{\boldsymbol{\lambda}}_{t}^{*}=\left(\widehat{\boldsymbol{\beta}}_{t}^{* T} \mathbb{M}_{1_{N}} \widehat{\boldsymbol{\beta}}_{t}^{*}\right)^{-1}\left(\widehat{\boldsymbol{\beta}}_{t}^{* T} \mathbb{M}_{1_{N}} \bar{r}_{t}^{*}\right),
$$
and
$$
\widehat{\alpha}_{t}^{*}=\bar{r}_{t}^{*}-\widehat{\beta}_{t}^{* \top} \widehat{\lambda}_{t}^{*} .
$$
4. Repeat step 1-3 for B times and compute the bootstrap p-values
$$
p_{i, t}=\frac{1}{B} \sum_{b=1}^{B} 1\left(\widehat{\alpha}_{i, t, b}^{*}>\widehat{\alpha}_{i, t}\right) .
$$

The above procedure assumes that the dimension $r_{l}$ of the latent factor $f_{l, t}$ is known. However, in practice, we need to estimate $r_{l}$ as well. We extend the eigenvalue ratio-
based estimator, proposed by Ahn and Horenstein (2013). Let $\widehat{\phi}_{1, t} \geq \widehat{\phi}_{2, t} \geq \cdots \geq \widehat{\phi}_{r, t} \geq 0$ be the ordered eigenvalues of $\widehat{\Sigma}_{t}$. And the generalized eigenvalue ratio-based estimator for $r$ can be defined as
$$
\begin{equation*}
\widehat{r}_{l}=\underset{1 \leq j \leq r_{\max }}{\operatorname{argmax}} \frac{1}{T} \sum_{t=1}^{T} \frac{\widehat{\phi}_{j, t}}{\widehat{\phi}_{j+1, t}} \tag{10}
\end{equation*}
$$
and $r_{\max }$ is a selected upper bound. We could choose $r_{\max }=\lfloor N / 2\rfloor$ or $r_{\max }=\lfloor N / 3\rfloor$, following Ahn and Horenstein (2013). The consistency of $\widehat{r_{l}}$ is confirmed in Theorem 3 in the appendix. Other estimators such as a BIC-based estimator can be applied as well.

\section*{3 Empirical Results}

\subsection*{3.1 Data Source}

Data for this paper is obtained from two sources: open source asset pricing and the FamaFrench data library. Open source asset pricing database is constructed by Chen and $\mathrm{Zim}-$ mermann (2021), from which we collect the monthly data of long-short strategy returns of 207 factors sampled from 1967 to 2021 . And monthly market excess return is obtained from the Fama-French data library.

\subsection*{3.2 Significant factors in CAPM under FDR control}

We follow the CAPM regression and BH procedure specified in Section 2.1 on two samples differentiated by sampling period: the first one is a full sample from 1967 to 2021, and the other sample is more recent with a sampling period from 2000 to 2021. In the full sample, the observations of some factors start from some years later than 1967. In the recent sample, the observations of some factors end before 2021. These observations are kept as we will conduct a rolling estimation that evaluates the sample size effect in this section.

Table 1 reports the significant factors in the full sample. After the BH procedure is implemented, 157 out of 207 factors get rejected. Among them, DivSeason is the most significant factor with t-stat over 16.

The results on the second sample are presented in Table 2. The estimation with more recent data induces a plunge in the number of rejections. In total, under the same FDR control, only 56 out of 207 factors are rejected, yielding a decline of nearly 100 significant factors compared with the first sample. In addition, AnnouncementReturn takes the place of DivSeason and becomes the most significant factor with $t$ stat 9.44 , which is much less than the $t$-stat of DivSeason on the full sample. Results on the full sample and recent sample suggest that significant factors experience a striking loss.

One possibility of this phenomenon stems from the sample size argument: in the full sample, the observations for each factor are around 2.5 times more than the ones in the recent sample. A rolling-window estimation is conducted to investigate the potential sample size effect. In the rolling-window study, we construct samples starting from 1967/01 with a fixed sample size of 20 years, rolling by month. In total, there are 421 samples constructed with samples starting years from 1967 to 2002. Factors are deleted if there are missing observations in order to control the sample size. The BH FDR control method is applied to each sample, allowing to capture of the trend of the number of rejected factors across time. Figure 1 present the number of rejections across time. The number of rejections follows a hump-like shape: it increases at the beginning and then begins to decrease with the turning point around 1981. The results from the rolling-window study dispute the argument that the decreasing sample size induces fewer numbers of rejections in the recent sample.

\subsection*{3.3 Model-motivated factors}

We follow the GRW procedure specified in Section 2.2 on model-motivated and on full sample and recent sample, respectively. By the nature of the GRW procedure, weights higher than 1 will boost the corresponding p-values so that they could be more likely to be rejected via the BH multiple-test procedure. Since the p-value of investment is too large in the full sample, it cannot be rejected for any value of $\gamma$. Therefore, the procedure is applied only to the recent sample. Table 4 presents the rejection results with $\gamma=2,5$, and 10 in the recent sample. The number of identifications in $G_{I}$ increases from 3 to 5 and then to 8 as $\gamma$ increases from 2 to 5 and then 10.

\subsection*{3.4 Factors in latent factor models}

The procedure specified in Section 2.3 with 3 latent factors as well as the market factor and with bootstrap size equal to 1,000 is conducted. The results are reported in Table 5 and Table 6. The similarity of the results between the OLS model and the latent factor model is observed. In the full sample, 150 out of 207 factors are identified under the BH test, which is close to the result obtained via CAPM (157). In the recent sample, the number of rejected factors drops from 150 to 44 , while in CAPM this number is 56. Therefore, the factor model shows an even sharper decrease in the number of identified factors. Among the model-motivated factors, in the full sample, only Investment fails to be identified, while only 3 important factors are identified in the recent sample. We note that the important factors identified by the latent factor model are in line with the results obtained via CAPM in Section 2.1.

A rolling study with a 20 -year rolling window is also conducted. The results are shown in Figure 3. We observe that the number of rejections rises in fluctuation in the period from 1967 to around 1985. Then it begins to decrease and falls to the bottom at around 40 in around 2000. Combining all these findings from the latent factor model strengthens the robustness of the results obtained in Section 3.2.

\subsection*{3.5 Factors in time-varying factor model}

This section discusses the results obtained from the time-varying factor model specified in Section 2.4. To begin with, we applied the generalized eigenvalue-ratio procedure in (10) to the complete dataset spanning from 1967 to 2021. Our analysis reveals that two latent factors effectively account for the majority of factors after controlling for the impact of the market factor in the dataset. Accordingly, we estimate the time-varying model in (5) using two latent factors and one market factor. We generate heat maps of the alphas estimated using the time-varying factor model for all factors and model-motivated factors, which are shown in Figure 4 and Figure 5, respectively. These heat maps demonstrate that the color density changes smoothly over time, indicating the time-varying nature of the evolution of the alphas. This provides justification for the application of the
time-varying latent factor model to our dataset.
The wild bootstrap procedure, as outlined in Section 2.4, is implemented with bootstrap size $B=1,000$ to obtain the p-value of the alpha estimate of each factor at each time point. And the BH procedure with FDR control at 1 percent is conducted and the corresponding results are presented in Figure 6. The shape of the rejection curve is similar to Figure 1 and Figure 3 that we obtain via the rolling study using the CAPM model and the constant parameter latent factor model, respectively, albeit with some variations in the level of rejection counts. Note that we use the kernel estimation in the time-varying model that obtains estimations using a local, two-sided sample, while in the rolling study in CAPM and constant parameter latent factor model, the rolling sample is one-sided and taken from the date labeled on the axis. Given that, the timing of the peak of the factor identifications of these three models also coincides. We also note that the number of identified factors starts at approximately 90, and the number increases to the peak around 1993, followed by a sharp decline to around 20 by the end of the period. Figure 7 shows the rejections curve of economically important factors identified using the timevarying factor model, which exhibits a similar pattern to that for all factors shown in Figure 6. The peak number of identified factors reaches 13 out of 15 and drops to nearly 0 by the end of the study period, reinforcing our previous findings that there are fewer useful factors than we thought and the number of useful factors is declining over time.

We compare the explanatory power of the identified latent factors with that of the Fama-French 3 factors (ff3) and Fama-French 5 factors (ff5) by applying the time-varying factor model (5) with either ff3 or ff5 or the identified latent factors. Our results show that for the long-short portfolio, the market factor plus two latent factors provide the most significant explanation for the variation in returns, with an $\boldsymbol{R}^{2}$ that is $69 \%$ higher than that of ff3 and $46 \%$ higher than that of ff5.

We further conduct a cluster analysis on the factors identified from CAPM applied to the full sample and to the recent sample. We use the correlation between factors as the distance measure and evaluate aggregation levels across different numbers of clusters, as shown in Figure 8 and in Figure 9 for full sample and recent sample, respectively. The $y$-axis of the plot, named Height, is a measure of intergroup dissimilarity. We find
that among the number of clusters ranging from 2 to 9 , the clustering partitions implement the most effective reduction in intergroup dissimilarity when 5 clusters are selected, while the analogical number for the recent sample is 3 . This result coincides with the number of factors estimated through the generalized eigenvalue-ratio procedure, which reinforces the robustness of the selection of latent factor numbers. The assignment of factors to each cluster is shown in Table 8, while the assignment of model-motivated factors is displayed in Table 10. The correlation matrix among identified factors, sorted by cluster, is visualized in Figure 10. As observed from the figure, factors in each cluster exhibit strong correlation, while factors in different clusters are weakly correlated. Despite the large number of identified factors in the whole sample period, many factors are correlated with each other, and only three factors (the market factor and two latent factors) would be sufficient to explain the major variation.

\section*{4 Dicussion}

\subsection*{4.1 Out-of-sample and Post-publication return study}

As argued by McLean and Pontiff (2016), the out-of-sample and post-publication returns are substantially and significantly lower. Inspired by their work, we conduct a study of out-of-sample and post-publication returns of each factor. First, CAPM is run for the long-short strategy return of each factor before and after publication. The $t$-stats of the intercept are compared. For each factor, the regression is run twice with the sample before publication and after publication. In order to alleviate the issue induced by imbalanced sample size, the samples before publication or after publication are truncated so that they have the same size. The $t$-stats of $\alpha_{i}$ are collected and compared, which are presented in Table 11. Among 207 factors, 157 factors experienced significant decay. dNoa has its significance level affected the most: the $t$-stat dropped by 7.15 after the publication. In addition, among these factors, 72 factors have their significance level drop from above 1.96 to below 1.96, which is the threshold for the 5 -percent-size individual t-test. Also, we conduct BH test procedures on all factors before and after publication, and the results
are displayed in Table 12. Not surprisingly, the number of identified factors witnesses a sharp decline after publication: before publication, 112 out of 207 factors are being identified, while only 30 factors can be identified by BH procedure after publication.

Following McLean and Pontiff (2016), we explore the statistical robustness of postpublication decay. We run the following panel regression:
$$
R_{i, t}=\alpha_{i}+\beta_{1} \text { Out-of-sample }_{i, t}+\beta_{2} \text { Post-publication }_{i, t}+\varepsilon_{i, t},
$$
where Out-of-sample $i_{i, t}$ is a dummy variable equal to 1 when the sample at time $t$ is after the sample period in the original paper of factor $i$, and Post-publication ${ }_{i, t}$ is a dummy variable equal to 1 when the sample at time $t$ is after the publication date of factor $i$. The results are shown in Table 13, which shows a strong negative correlation between out-of-sample and the return, and between post-publication and the return. On average, the long-short strategy of each factor declines by around 0.3 percentage after the publication and after the sampling period in the original paper.

\subsection*{4.2 Extracting Factors using LRP-PCA}

In this section, we explore factors that can capture the information of not only in the covariance of anomalies, but also are capable of explaining their expected returns for the recent data from 2000 to 2021. To achieve this, we consider a time-varying factor model without an intercept term:
$$
\begin{equation*}
r_{i, t}=\beta_{i, t}^{\top} f_{t}+u_{i, t}, \tag{11}
\end{equation*}
$$
where $f_{t} \in \mathbb{R}^{r}$ represents latent factors, and $\beta_{i, t}$ the corresponding factor loading indexed by $t$. To enable $f_{t}$ to capture both the covariance and the expected returns of anomalies, we consider a local risk-premium PCA (LRP-PCA), which extends the RP-PCA (Lettau and Pelger (2020a), Lettau and Pelger (2020b)) to the time-varying latent factor models. The estimation involves the following steps:
1. Calculate the statistic that aggregates the local information in both first and second
moments:
$$
\widehat{\Sigma}_{t, \gamma}=\frac{1}{T} \sum_{s=1}^{T} K_{h, t s}\left(r_{s} r_{s}^{\top}+\gamma \bar{r}_{s} \bar{r}_{s}^{\top}\right)
$$
where $\bar{r}_{s}$ equals the local mean of $r_{t}$ at time $s$ defined in Equation 6 and $K_{h, t s}$ is some boundary-adjusted kernel defined in Equation 6 , and $\gamma \geq-1$ is a hypoparameter that balances the information of the first and second moments.
2. The LRP-PCA estimator $\widehat{\beta}_{t}$ is comprised of $\sqrt{N}$ times top $r$ eigenvectors of $\widehat{\Sigma}_{t, \gamma}$ in descending order by eigenvalues.
3. Obtain the least square estimate of factors $f_{t}$ :
$$
\widehat{f_{t}}=\frac{1}{N} \widehat{\boldsymbol{\beta}}_{t}^{\top} r_{t}
$$

The number of latent factors is set to 3 in alignment with the number of clusters identified in section 3.5. $\gamma$ is set to 1 to better capture the expected returns of anomalies.

We assess the performance of the factor set composed of 3 LRP-PCA latent factors and the market factor, and compare it with the Fama-French factors in explaining the anomalies. Analogous to Section 2.1, a series of regressions of anomalies on 3 latent factors plus market factor are conducted to examine the significance of these anomalies after controlling for FDR at one percent. The results of 3 latent factors, FF3 and FF5 are shown in Table 15. Notably, LRP-PCA latent factors plus the market factor exhibit superior explanatory power for anomalies compared to both FF3 and FF5 factors, characterized by fewest significant anomalies, lowest root mean square of alphas, and the highest $R^{2}$.

Next, we evaluate the extent to which Fama-French 5 factors can be explained by 3 latent factors and the market factor, and vice versa. Regressions of FF5 factors on latent factors and the market factor, as well as the reverse regressions, are conducted, with the results presented in Table 16. After controlling for FDR, none of the FF5 factors are significant when regressed on latent factors and the market factor, meaning that all of them can be explained by the LRP-PCA factors and the market factor.

Conversely, there are only one latent factor can be explained well by the FF3 factors. Therefore, latent factors from LRP-PCA plus the market factor not only explain anomalies
but also provide a comprehensive explanation for the FF5 factors, whereas Fama-French factors exhibit less effectiveness in this regard.

Finally, we compare the Sharpe ratio of the optimal portfolios constructed by 3 latent factors and market factor, FF3 factors and FF5 factors, respectively. As argued by Barillas and Shanken (2017), comparing two factor models is to compare their Sharpe ratios of the optimal portfolio formed out of each set of the factors. Given a set of factors, the optimal portfolio is obtained by solving the following optimization problems:
$$
w_{o p}=\underset{w}{\arg \max } w^{\top} \mu-\frac{1}{3} w^{\top} \Sigma w,
$$
where $\mu$ is the vector of expected returns of factors and $\Sigma$ is the covariance matrix of factors. The findings shown in Table 17 suggest that among the three sets of factors, portfolios constructed with 3 latent factors and the market factor exhibit the highest Sharpe ratio.

\section*{5 Conclusion}

Our paper investigates the number of factors that remain statistically significant under FDR control since 1967 and since 2000, respectively. We find a sharp decline in their numbers. We verify this finding using the comprehensive factor data set constructed by Chen and Zimmermann (2021). Additionally, model-motivated factors that are considered strong in Chib et al. (2022) display a similar pattern. However, Momentum and Return on Equity (RoE) remain strong across the sample period from 1967 to 2021 or from 2000 to 2021.

We apply the weighting BH FDR control procedure in Genovese et al. (2006) to the p-values obtained from the OLS and non-time-varying factor model. A back-of-theenvelope calculation shows that assigning weights that are more than 100 times higher is necessary to identify all economically important factors. However, in the recent sample from 2000 to 2021, this procedure can only increase the number of rejections among model-motivated factors by around 2 , at the cost of a significant decrease in total rejec-
tions.
We propose a time-varying latent factor model, and find that the alphas display smooth changes over the sample period. This finding supports the use of a time-varying model and suggests the time-varying nature of the alpha for each factor. Moreover, in the case of without imposing asset pricing restrictions in the latent factor model, a generalized eigenvalue-ratio procedure reveals that 2 latent factors and the market factor can effectively account for almost all variations of all existing factors. In the case of imposing asset pricing restrictions for improved explanatory power, only one additional factor is needed. The results are largely consistent with the cluster analysis, suggesting no more than 4 factors in total, a number much smaller than most researchers believed

Our study adds to the existing literature on multiple testing in the asset pricing context by introducing a flexible time-varying latent factor framework. We establish the asymptotic properties of a local PCA-based estimator for the time-varying alpha and propose a generalized eigenvalue-ratio estimator for the latent dimension. Our proposed method is simple to implement and can be applied to other multiple testing and factor models in a number of areas, such as factor models for bonds, currencies, and mutual and hedge fund returns.

\section*{Tables}

\subsection*{Table 1: BH procedure on full sample}

The table reports the significant factors obtained via CAPM model in full sample:
$$
r_{i, t}=\alpha_{i}+\beta_{i} f_{t}+u_{i, t},
$$
where $r_{i, t}$ is the long-short strategy return of factors, and $f_{t}$ is the market factor. The t statistic and p-value of $\alpha_{i}$ are shown in the table. The sample period is from 1967 to 2021. The dataset is constructed by Chen and Zimmermann (2021).
\begin{tabular}{llllll}
\hline factor & $\mathbf{t}$ & $\mathbf{p}$ & factor & $\mathbf{t}$ & $\mathbf{p}$ \\
\hline DivSeason & 16.010 & $<0.001$ & EntMult & 6.732 & $<0.001$ \\
AnnouncementReturn & 15.093 & $<0.001$ & NetPayoutYield & 6.651 & $<0.001$ \\
DelFINL & 12.193 & $<0.001$ & hire & 6.470 & $<0.001$ \\
DivYieldST & 11.002 & $<0.001$ & MomSeason11YrPlus & 6.456 & $<0.001$ \\
IndRetBig & 10.971 & $<0.001$ & zerotrade & 6.372 & $<0.001$ \\
dNoa & 10.211 & $<0.001$ & zerotradeAlt12 & 6.341 & $<0.001$ \\
EarningsStreak & 9.967 & $<0.001$ & MomOffSeason06YrPlus & 6.229 & $<0.001$ \\
NumEarnIncrease & 9.769 & $<0.001$ & BM & 6.069 & $<0.001$ \\
NetDebtFinance & 9.767 & $<0.001$ & MomSeason16YrPlus & 6.000 & $<0.001$ \\
SmileSlope & 9.903 & $<0.001$ & DownRecomm & 6.042 & $<0.001$ \\
ShortInterest & 9.526 & $<0.001$ & DelCOL & 5.843 & $<0.001$ \\
ChTax & 9.210 & $<0.001$ & roaq & 5.811 & $<0.001$ \\
AnalystRevision & 9.248 & $<0.001$ & Accruals & 5.806 & $<0.001$ \\
InvestPPEInv & 9.165 & $<0.001$ & VolSD & 5.805 & $<0.001$ \\
ConvDebt & 9.081 & $<0.001$ & PctAcc & 5.710 & $<0.001$ \\
EarningsSurprise & 8.898 & $<0.001$ & MomSeasonShort & 5.708 & $<0.001$ \\
RevenueSurprise & 8.747 & $<0.001$ & grcapx & 5.694 & $<0.001$ \\
TrendFactor & 8.745 & $<0.001$ & DebtIssuance & 5.701 & $<0.001$ \\
STreversal & 8.415 & $<0.001$ & PriceDelayRsq & 5.681 & $<0.001$ \\
ShareIssiY & 8.315 & $<0.001$ & IntMom & 5.661 & $<0.001$ \\
FirmAgeMom & 8.148 & $<0.001$ & ExchSwitch & 5.602 & $<0.001$ \\
ChInv & 8.103 & $<0.001$ & ReturnSkew & 5.592 & $<0.001$ \\
ResidualMomentum & 7.861 & $<0.001$ & UpRecomm & 5.632 & $<0.001$ \\
AssetGrowth & 7.664 & $<0.001$ & SP & 5.559 & $<0.001$ \\
Frontier & 7.539 & $<0.001$ & CBOperProf & 5.391 & $<0.001$ \\
zerotradeAlt1 & 7.532 & $<0.001$ & IdioRisk & 5.379 & $<0.001$ \\
AccrualsBM & 7.496 & $<0.001$ & std_turn & 5.368 & $<0.001$ \\
VolumeTrend & 7.483 & $<0.001$ & MS & 5.361 & $<0.001$ \\
DelCOA & 7.459 & $<0.001$ & ProbInformedTrading & 5.453 & $<0.001$ \\
DelNetFin & 7.438 & $<0.001$ & MomSeason06YrPlus & 5.313 & $<0.001$ \\
BMdec & 7.274 & $<0.001$ & ShareVol & 5.307 & $<0.001$ \\
InvGrowth & 7.211 & $<0.001$ & BetaFP & -5.254 & $<0.001$ \\
CompositeDebtIssuance & 7.173 & $<0.001$ & ChEQ & 5.247 & $<0.001$ \\
NOA & 7.050 & $<0.001$ & MomVol & 5.234 & $<0.001$ \\
VolMkt & 7.017 & $<0.001$ & MaxRet & 5.220 & $<0.001$ \\
ChangeInRecommendation & 7.137 & $<0.001$ & ChInvIA & 5.216 & $<0.001$ \\
ShareIss5Y & 6.987 & $<0.001$ & Tax & 5.210 & $<0.001$ \\
NetEquityFinance & 6.920 & $<0.001$ & IdioVol3F & 5.192 & $<0.001$ \\
XFIN & 6.893 & $<0.001$ & grcapx3y & 5.118 & $<0.001$ \\
retConglomerate & 6.808 & $<0.001$ & RIO_Volatility & 5.067 & $<0.001$ \\
\hline & & & & & \\
\hline
\end{tabular}

Table 1 continued
\begin{tabular}{llllll}
\hline factor & $\mathbf{t}$ & $\mathbf{p}$ & factor & alpha.t & alpha.p \\
\hline FEPS & 5.016 & $<0.001$ & EquityDuration & 3.636 & $<0.001$ \\
MomSeason & 4.936 & $<0.001$ & ShareRepurchase & 3.616 & $<0.001$ \\
ReturnSkew3F & 4.789 & $<0.001$ & IO_ShortInterest & 3.613 & $<0.001$ \\
PctTotAcc & 4.794 & $<0.001$ & AgeIPO & 3.602 & $<0.001$ \\
DivInit & 4.708 & $<0.001$ & Mom6m & 3.517 & $<0.001$ \\
MomOffSeason & 4.632 & $<0.001$ & CompEquIss & 3.509 & $<0.001$ \\
DolVol & 4.629 & $<0.001$ & GrAdExp & 3.473 & 0.001 \\
DelEqu & 4.555 & $<0.001$ & Mom12m & 3.454 & 0.001 \\
IndIPO & 4.540 & $<0.001$ & RIO_Turnover & 3.422 & 0.001 \\
ForecastDispersion & 4.538 & $<0.001$ & AdExp & 3.405 & 0.001 \\
ChNNCOA & 4.461 & $<0.001$ & PS & 3.383 & 0.001 \\
Mom12mOffSeason & 4.451 & $<0.001$ & REV6 & 3.347 & 0.001 \\
Recomm_ShortInterest & 4.474 & $<0.001$ & DelLTI & 3.327 & 0.001 \\
MomRev & 4.437 & $<0.001$ & IntanEP & 3.309 & 0.001 \\
OScore & 4.426 & $<0.001$ & DelBreadth & 3.268 & 0.001 \\
OperProfRD & 4.338 & $<0.001$ & EarnSupBig & 3.256 & 0.001 \\
AM & 4.322 & $<0.001$ & Leverage & 3.184 & 0.002 \\
ChForecastAccrual & 4.260 & $<0.001$ & sfe & 3.174 & 0.002 \\
skew1 & 4.280 & $<0.001$ & ChNWC & 3.169 & 0.002 \\
PriceDelayTstat & 4.162 & $<0.001$ & PayoutYield & 3.144 & 0.002 \\
GrSaleToGrInv & 4.140 & $<0.001$ & MomOffSeason16YrPlus & 3.129 & 0.002 \\
Illiquidity & 4.133 & $<0.001$ & High52 & 3.044 & 0.002 \\
CredRatDG & 4.129 & $<0.001$ & PatentsRD & 3.024 & 0.003 \\
OperProf & 4.065 & $<0.001$ & RIO_MB & 2.983 & 0.003 \\
PriceDelaySlope & 3.966 & $<0.001$ & iomom_cust & 2.965 & 0.003 \\
RD & 3.962 & $<0.001$ & cfp & 2.943 & 0.003 \\
RIO_Disp & 3.948 & $<0.001$ & fgr5yrLag & 2.940 & 0.003 \\
EarningsForecastDisparity & 3.863 & $<0.001$ & RoE & 2.857 & 0.004 \\
AOP & 3.833 & $<0.001$ & EarningsConsistency & 2.802 & 0.005 \\
NetDebtPrice & 3.824 & $<0.001$ & GP & 2.784 & 0.006 \\
IdioVolAHT & 3.822 & $<0.001$ & tang & 2.763 & 0.006 \\
GrLTNOA & 3.818 & $<0.001$ & MRreversal & 2.731 & 0.006 \\
OrgCap & 3.810 & $<0.001$ & IntanCFP & 2.726 & 0.007 \\
Mom6mJunk & 3.767 & $<0.001$ & RDS & 2.727 & 0.007 \\
RDIPO & 3.719 & $<0.001$ & CF & 2.706 & 0.007 \\
betaVIX & 3.716 & $<0.001$ & DivOmit & 2.685 & 0.007 \\
MeanRankRevGrowth & 3.698 & $<0.001$ & CoskewACX & 2.684 & 0.007 \\
CashProd & 3.693 & $<0.001$ & & & \\
ChAssetTurnover & 3.681 & $<0.001$ & & & \\
EBM & 3.676 & $<0.001$ & & & \\
\hline & & & & & \\
\hline
\end{tabular}

\subsection*{Table 2: BH procedure on recent sample}

The table reports the results from the following regression:
$$
r_{i, t}=\alpha_{i}+\beta_{i} f_{t}+u_{i, t},
$$
where $r_{i, t}$ is the long-short strategy return of factors, and $f_{t}$ is the market factor. The t statistic and p -value of $\alpha_{i}$ are shown in the table. In total, The sample period spans from 2000 to 2021. The dataset is constructed by Chen and Zimmermann (2021).
\begin{tabular}{llllll}
\hline factor & $\mathbf{t}$ & $\mathbf{p}$ & factor & $\mathbf{t}$ & $\mathbf{p}$ \\
\hline AnnouncementReturn & 9.440 & $<0.001$ & ExchSwitch & 3.732 & $<0.001$ \\
SmileSlope & 8.152 & $<0.001$ & DolVol & 3.667 & $<0.001$ \\
DivSeason & 7.617 & $<0.001$ & NetEquityFinance & 3.663 & $<0.001$ \\
ShortInterest & 6.265 & $<0.001$ & RIO_Turnover & 3.653 & $<0.001$ \\
VolumeTrend & 6.040 & $<0.001$ & FEPS & 3.634 & $<0.001$ \\
ConvDebt & 5.657 & $<0.001$ & CompositeDebtIssuance & 3.572 & $<0.001$ \\
NetDebtFinance & 5.590 & $<0.001$ & UpRecomm & 3.542 & $<0.001$ \\
EarningsStreak & 5.525 & $<0.001$ & ShareIss5Y & 3.522 & 0.001 \\
ShareIss1Y & 5.112 & $<0.001$ & dNoa & 3.487 & 0.001 \\
FirmAgeMom & 5.018 & $<0.001$ & Recomm_ShortInterest & 3.464 & 0.001 \\
MomOffSeason06YrPlus & 4.824 & $<0.001$ & EntMult & 3.449 & 0.001 \\
ChangeInRecommendation & 4.728 & $<0.001$ & OrgCap & 3.417 & 0.001 \\
VolMkt & 4.689 & $<0.001$ & skew1 & 3.363 & 0.001 \\
NumEarnIncrease & 4.604 & $<0.001$ & Tax & 3.361 & 0.001 \\
Frontier & 4.355 & $<0.001$ & VolSD & 3.346 & 0.001 \\
OperProfRD & 4.340 & $<0.001$ & roaq & 3.296 & 0.001 \\
RevenueSurprise & 4.275 & $<0.001$ & zerotrade & 3.270 & 0.001 \\
CBOperProf & 4.255 & $<0.001$ & BetaFP & -3.248 & 0.001 \\
AccrualsBM & 4.192 & $<0.001$ & RoE & 3.231 & 0.001 \\
IndRetBig & 4.143 & $<0.001$ & SP & 3.218 & 0.001 \\
DivYieldST & 4.131 & $<0.001$ & PriceDelayRsq & 3.200 & 0.002 \\
DelFINL & 4.099 & $<0.001$ & MS & 3.194 & 0.002 \\
DownRecomm & 4.018 & $<0.001$ & zerotradeAlt12 & 3.129 & 0.002 \\
MomSeason16YrPlus & 4.005 & $<0.001$ & AssetGrowth & 3.106 & 0.002 \\
NetPayoutYield & 3.981 & $<0.001$ & Illiquidity & 3.096 & 0.002 \\
RIO_Volatility & 3.965 & $<0.001$ & ChTax & 3.085 & 0.002 \\
XFIN & 3.893 & $<0.001$ & OperProf & 3.080 & 0.002 \\
zerotradeAlt1 & 3.859 & $<0.001$ & IdioRisk & 3.056 & 0.002 \\
\hline & & & & & \\
\hline
\end{tabular}

\subsection*{Table 3: The significant model-motivated factors}

The table reports the results from the following regression:
$$
r_{i, t}=\alpha_{i}+\beta_{i}^{\top} f_{t}+u_{i, t}, \quad 1 \leq i \leq N, 1 \leq t \leq T,
$$
where $r_{i, t}$ is the long-short portfolio of model-motivated factors, and $f_{t}$ is a vector of Fama-French 3 factors. The $t$ value, p value as well as the BH rejection threshold are shown in the table. In total, there are 15 factors with the sampling period spanning from 2000 to 2021. The model-motivated factors are selected based on Chib et al. (2022).
\begin{tabular}{lll|lll}
\hline \multicolumn{2}{c|}{ Full sample } & & \multicolumn{3}{c}{ Recent Sample } \\
\hline factor & $\mathbf{t}$ & $\mathbf{p}$ & factor & $\mathbf{t}$ & $\mathbf{p}$ \\
\hline MomSeason11YrPlus & 6.456 & $<0.001$ & MomOffSeason06YrPlus & 4.824 & $<0.001$ \\
MomOffSeason06YrPlus & 6.229 & $<0.001$ & MomSeason16YrPlus & 4.005 & $<0.001$ \\
MomSeason16YrPlus & 6.000 & $<0.001$ & RoE & 3.231 & 0.001 \\
MomSeasonShort & 5.708 & $<0.001$ & & & \\
MomSeason06YrPlus & 5.313 & $<0.001$ & & & \\
MomVol & 5.234 & $<0.001$ & & & \\
MomSeason & 4.936 & $<0.001$ & & & \\
MomOffSeason & 4.632 & $<0.001$ & & & \\
Mom12mOffSeason & 4.451 & $<0.001$ & & & \\
MomRev & 4.437 & $<0.001$ & & & \\
Mom6m & 3.517 & $<0.001$ & & & \\
Mom12m & 3.454 & 0.001 & & & \\
MomOffSeason16YrPlus & 3.129 & 0.002 & & & \\
RoE & 2.857 & 0.004 & & & \\
\hline
\end{tabular}

\subsection*{Table 4: GRW procedure on recent sample under pre-specified weights}

The table reports the results of the GRW (or weighting BH) procedure on the p-values of modelmotivated factors shown in Table 2. In the GRW procedure, each p-value is assigned a normalized weight and the adjusted p -value is the ratio of the original p -value on the weight. Then BH procedure is applied to the adjusted p -value. $\gamma$ is the ratio of the weight on selected factors to the weight on benchmark factors.
\begin{tabular}{lrrr}
\hline factor & \begin{tabular}{c}
$\gamma=2$ \\
rejected
\end{tabular} & \begin{tabular}{c}
$\gamma=5$ \\
rejected
\end{tabular} & \begin{tabular}{c}
$\gamma=10$ \\
rejected
\end{tabular} \\
\hline RoE & 1 & 1 & 1 \\
MomOffSeason06YrPlus & 1 & 1 & 1 \\
MomSeason16YrPlus & 1 & 1 & 1 \\
MomSeason & 0 & 1 & 1 \\
MomSeason06YrPlus & 0 & 1 & 1 \\
MomSeason11YrPlus & 0 & 0 & 1 \\
MomVol & 0 & 0 & 1 \\
Mom12mOffSeason & 0 & 0 & 1 \\
Mom6m & 0 & 0 & 0 \\
MomOffSeason16YrPlus & 0 & 0 & 0 \\
Mom12m & 0 & 0 & 0 \\
MomRev & 0 & 0 & 0 \\
MomOffSeason & 0 & 0 & 0 \\
Investment & 0 & 0 & 0 \\
MomSeasonShort & 0 & 0 & 0 \\
\hline
\end{tabular}


\subsection*{Table 5: BH rejections on full sample: factor model}

The table reports the results of the alpha factor model on full sample spanning from 1967 to 2021. The factor model is given by:
$$
r_{i, t}=\alpha_{i}+\beta_{i}^{\top} \lambda+\beta_{i}^{\top}\left(f_{t}-\mathbb{E}\left[f_{t}\right]\right)+u_{i, t}, \quad i \leq N, t \leq T
$$

The estimates of $\alpha_{i}$ and its p -value are reported.
\begin{tabular}{|c|c|c|c|c|c|}
\hline factor & p & factor & p & factor & p \\
\hline IntanCFP & $<0.001$ & MomSeason11YrPlus & <0.001 & AccrualsBM & <0.001 \\
\hline ReturnSkew & $<0.001$ & MomSeason06YrPlus & <0.001 & dNoa & <0.001 \\
\hline zerotradeAlt1 & $<0.001$ & MomSeason & <0.001 & DivYieldST & <0.001 \\
\hline IntanBM & <0.001 & RDIPO & <0.001 & XFIN & <0.001 \\
\hline IndRetBig & <0.001 & MomOffSeason06YrPlus & <0.001 & DivSeason & <0.001 \\
\hline ReturnSkew3F & <0.001 & MomOffSeason & <0.001 & DivOmit & <0.001 \\
\hline REV6 & <0.001 & Mom12mOffSeason & <0.001 & DivInit & <0.001 \\
\hline IdioVol3F & <0.001 & Mom12m & <0.001 & DelNetFin & <0.001 \\
\hline IdioRisk & $<0.001$ & LRreversal & <0.001 & Dellti & <0.001 \\
\hline hire & $<0.001$ & ResidualMomentum & $<0.001$ & DelFINL & <0.001 \\
\hline RevenueSurprise & <0.001 & IO_ShortInterest & <0.001 & CompositeDebtIssuance & <0.001 \\
\hline RIO_Volatility & <0.001 & InvGrowth & <0.001 & skew1 & <0.001 \\
\hline roaq & $<0.001$ & EarningsSurprise & <0.001 & DelEqu & <0.001 \\
\hline GrSaleToGrInv & <0.001 & EarningsStreak & <0.001 & SmileSlope & <0.001 \\
\hline IntanSP & $<0.001$ & ShareRepurchase & <0.001 & DebtIssuance & <0.001 \\
\hline RoE & <0.001 & PctTotAcc & <0.001 & ConvDebt & <0.001 \\
\hline grcapx & <0.001 & ChTax & <0.001 & DelCOA & <0.001 \\
\hline GP & $<0.001$ & AnnouncementReturn & $<0.001$ & VolumeTrend & <0.001 \\
\hline sfe & $<0.001$ & ChNNCOA & $<0.001$ & DelCOL & <0.001 \\
\hline Frontier & <0.001 & STreversal & <0.001 & Mom6mJunk & 0.002 \\
\hline ShareIss1Y & <0.001 & ChInvIA & <0.001 & EarningsConsistency & 0.002 \\
\hline ForecastDispersion & $<0.001$ & ChInv & $<0.001$ & RIO_MB & 0.002 \\
\hline FirmAgeMom & <0.001 & ChForecastAccrual & <0.001 & TotalAccruals & 0.002 \\
\hline ShareIss5Y & <0.001 & ChEQ & <0.001 & Recomm_ShortInterest & 0.002 \\
\hline PctAcc & <0.001 & ChangeInRecommendation & <0.001 & ShareVol & 0.002 \\
\hline FEPS & <0.001 & cfp & <0.001 & CredRatDG & 0.002 \\
\hline ExchSwitch & $<0.001$ & SurpriseRD & <0.001 & betaVIX & 0.002 \\
\hline ShortInterest & $<0.001$ & CBOperProf & $<0.001$ & CoskewACX & 0.002 \\
\hline EntMult & $<0.001$ & CashProd & $<0.001$ & AgeIPO & 0.002 \\
\hline grcapx3y & <0.001 & Cash & <0.001 & MS & 0.002 \\
\hline IntMom & <0.001 & tang & <0.001 & MaxRet & 0.003 \\
\hline retConglomerate & <0.001 & Tax & <0.001 & Mom6m & 0.003 \\
\hline InvestPPEInv & <0.001 & AM & <0.001 & IndIPO & 0.003 \\
\hline Price & <0.001 & AnalystRevision & <0.001 & Leverage & 0.004 \\
\hline ProbInformedTrading & <0.001 & BMdec & <0.001 & Coskewness & 0.004 \\
\hline OScore & $<0.001$ & BM & $<0.001$ & OperProfRD & 0.004 \\
\hline RD & <0.001 & BidAskSpread & <0.001 & RIO_Disp & 0.004 \\
\hline OptionVolume1 & $<0.001$ & BetaTailRisk & $<0.001$ & VolMkt & 0.004 \\
\hline OPLeverage & $<0.001$ & TrendFactor & <0.001 & OrderBacklogChg & 0.005 \\
\hline OperProf & $<0.001$ & UpRecomm & <0.001 & ChAssetTurnover & 0.005 \\
\hline NumEarnIncrease & <0.001 & Beta & <0.001 & RDS & 0.005 \\
\hline NOA & <0.001 & AssetGrowth & <0.001 & EquityDuration & 0.005 \\
\hline NetPayoutYield & <0.001 & VarCF & <0.001 & sinAlgo & 0.005 \\
\hline NetEquityFinance & <0.001 & SP & <0.001 & MomOffSeason16YrPlus & 0.006 \\
\hline NetDebtPrice & <0.001 & CompEquIss & <0.001 & IdioVolAHT & 0.006 \\
\hline NetDebtFinance & $<0.001$ & ChNWC & <0.001 & GrAdExp & 0.006 \\
\hline RDcap & <0.001 & AdExp & <0.001 & EarningsForecastDisparity & 0.006 \\
\hline MomVol & $<0.001$ & DownRecomm & <0.001 & OrgCap & 0.007 \\
\hline MomSeasonShort & <0.001 & DolVol & <0.001 & EBM & 0.007 \\
\hline MomSeason16YrPlus & <0.001 & Accruals & <0.001 & MomRev & 0.007 \\
\hline
\end{tabular}

\subsection*{Table 6: BH rejections on recent sample: factor model}
The table reports the results of the alpha factor model on recent sample spanning from 2000 to 2021. The factor model is given by:
$$
r_{i, t}=\alpha_{i}+\beta_{i}^{\top} \lambda+\beta_{i}^{\top}\left(f_{t}-\mathbb{E}\left[f_{t}\right]\right)+u_{i, t}, \quad i \leq N, t \leq T
$$

The estimates of $\alpha_{i}$ and its p -value are reported.
\begin{tabular}{lclc}
\hline \multicolumn{1}{c}{ factor } & $\mathbf{p}$ & \multicolumn{1}{c}{ factor } & $\mathbf{p}$ \\
\hline CBOperProf & 0.001 & SmileSlope & 0.001 \\
BM & 0.001 & OptionVolume1 & 0.001 \\
NetEquityFinance & 0.001 & ExchSwitch & 0.001 \\
ConvDebt & 0.001 & NumEarnIncrease & 0.001 \\
NetDebtFinance & 0.001 & XFIN & 0.001 \\
RevenueSurprise & 0.001 & RoE & 0.001 \\
Cash & 0.001 & AnnouncementReturn & 0.001 \\
NetPayoutYield & 0.001 & VolumeTrend & 0.001 \\
FEPS & 0.001 & roaq & 0.001 \\
UpRecomm & 0.001 & Frontier & 0.001 \\
MomSeason16YrPlus & 0.001 & EarningsStreak & 0.001 \\
ChangeInRecommendation & 0.001 & RIO_Volatility & 0.002 \\
DownRecomm & 0.001 & IndRetBig & 0.002 \\
CompositeDebtIssuance & 0.001 & Tax & 0.002 \\
SP & 0.001 & MomOffSeason06YrPlus & 0.002 \\
DelFINL & 0.001 & dNoa & 0.002 \\
ShortInterest & 0.001 & OPLeverage & 0.002 \\
DivSeason & 0.001 & MS & 0.002 \\
FirmAgeMom & 0.001 & NetDebtPrice & 0.002 \\
RD & 0.001 & skew1 & 0.002 \\
AccrualsBM & 0.001 & OperProf & 0.002 \\
ShareIss1Y & 0.001 & AssetGrowth & 0.002 \\
\hline
\end{tabular}

\subsection*{Table 7: BH rejections of model-motivated factors on full and recent sample: factor model}

The table reports the results of the alpha factor model on model-motivated factors. The factor model is given by:
$$
r_{i, t}=\alpha_{i}+\beta_{i}^{\top} \lambda+\beta_{i}^{\top}\left(f_{t}-\mathbb{E}\left[f_{t}\right]\right)+u_{i, t}, \quad i \leq N, t \leq T
$$

The estimates of $\alpha_{i}$ and its p -value are reported.
\begin{tabular}{lr|lr}
\hline \multicolumn{1}{c|}{ Full sample } & \multicolumn{2}{c}{ Recent sample } \\
\hline \multicolumn{1}{c|}{ factor } & p-value & \multicolumn{1}{c}{ factor } & p-value \\
\hline RoE & 0.001 & MomSeason16YrPlus & 0.001 \\
MomVol & 0.001 & RoE & 0.001 \\
MomSeasonShort & 0.001 & MomOffSeason06YrPlus & 0.002 \\
MomSeason16YrPlus & 0.001 & & \\
MomSeason11YrPlus & 0.001 & & \\
MomSeason06YrPlus & 0.001 & & \\
MomSeason & 0.001 & & \\
MomOffSeason06YrPlus & 0.001 & & \\
MomOffSeason & 0.001 & & \\
Mom12mOffSeason & 0.001 & & \\
Mom12m & 0.001 & & \\
Mom6m & 0.003 & & \\
MomOffSeason16YrPlus & 0.006 & & \\
MomRev & 0.007 & & \\
\hline
\end{tabular}

\subsection*{Table 8: Cluster assignments of factors identified via CAPM in full sample}
The table presents the clustering results of factors identified via CAPM in full sample. 5 clusters chosen based on Figure 8.
\begin{tabular}{|c|c|c|c|c|}
\hline Cluster 1 & Cluster 2 & Cluster 3 & Cluster 4 & Cluster 5 \\
\hline Accruals & AnalystRevision & AssetGrowth & BetaFP & AgeIPO \\
\hline AccrualsBM & AnnouncementReturn & ChAssetTurnover & CBOperProf & AOP \\
\hline AdExp & ChangeInRecommendation & ChEQ & ConvDebt & betaVIX \\
\hline AM & ChForecastAccrual & ChInv & GP & CF \\
\hline BM & ChTax & ChInvIA & IdioRisk & cfp \\
\hline BMdec & CompEquIss & ChNNCOA & IdioVol3F & DelLTI \\
\hline CashProd & CoskewACX & CompositeDebtIssuance & IdioVolAHT & DivInit \\
\hline ChNWC & CredRatDG & DebtIssuance & MaxRet & DivOmit \\
\hline DivSeason & DelBreadth & DelCOA & OperProfRD & FEPS \\
\hline DivYieldST & DownRecomm & DelCOL & OrgCap & fgr5yrLag \\
\hline EBM & EarningsForecastDisparity & DelEqu & PriceDelayTstat & ForecastDispersion \\
\hline EntMult & EarningsStreak & DelFINL & ProbInformedTrading & IndIPO \\
\hline EquityDuration & EarningsSurprise & DelNetFin & PS & NetEquityFinance \\
\hline Frontier & EarnSupBig & dNoa & Recomm_ShortInterest & NetPayoutYield \\
\hline GrLTNOA & FirmAgeMom & DolVol & ShareVol & OperProf \\
\hline IntanCFP & High52 & EarningsConsistency & ShortInterest & OScore \\
\hline IntanEP & IndRetBig & ExchSwitch & SmileSlope & RD \\
\hline Leverage & IntMom & GrAdExp & std_turn & ReturnSkew \\
\hline NetDebtPrice & iomom_cust & grcapx & VolMkt & ReturnSkew3F \\
\hline PayoutYield & Mom12m & grcapx3y & VolSD & roaq \\
\hline PctAcc & Mom12mOffSeason & GrSaleToGrInv & zerotrade & RoE \\
\hline RIO_Disp & Mom6m & hire & zerotradeAlt1 & sfe \\
\hline RIO_MB & Mom6mJunk & Illiquidity & zerotradeAlt12 & ShareIss1Y \\
\hline RIO_Turnover & MomRev & InvestPPEInv & & ShareRepurchase \\
\hline RIO_Volatility & MomSeasonShort & InvGrowth & & tang \\
\hline \multirow[t]{21}{*}{SP} & MomVol & IO_ShortInterest & & Tax \\
\hline & NumEarnIncrease & MeanRankRevGrowth & & XFIN \\
\hline & ResidualMomentum & MomOffSeason & & \\
\hline & retConglomerate & MomOffSeason06YrPlus & & \\
\hline & REV6 & MomOffSeason16YrPlus & & \\
\hline & RevenueSurprise & MomSeason & & \\
\hline & skew1 & MomSeason06YrPlus & & \\
\hline & STreversal & MomSeason11YrPlus & & \\
\hline & TrendFactor & MomSeason16YrPlus & & \\
\hline & UpRecomm & MRreversal & & \\
\hline & & MS & & \\
\hline & & NetDebtFinance & & \\
\hline & & NOA & & \\
\hline & & PatentsRD & & \\
\hline & & PctTotAcc & & \\
\hline & & PriceDelayRsq & & \\
\hline & & PriceDelaySlope & & \\
\hline & & RDIPO & & \\
\hline & & RDS & & \\
\hline & & ShareIss5Y & & \\
\hline & & VolumeTrend & & \\
\hline
\end{tabular}

\subsection*{Table 9: Cluster assignments of factors identified via CAPM in recent sample}

The table presents the assignment of factors identified via CAPM in recent sample. 3 clusters are chosen based on Figure 9.
\begin{tabular}{lll}
\hline Cluster 1 & Cluster 2 & Cluster 3 \\
\hline AnnouncementReturn & DivSeason & ConvDebt \\
SmileSlope & EarningsStreak & VolMkt \\
ShortInterest & ShareIss1Y & OperProfRD \\
VolumeTrend & NumEarnIncrease & CBOperProf \\
NetDebtFinance & Frontier & zerotradeAlt1 \\
FirmAgeMom & RevenueSurprise & Recomm_ShortInterest \\
MomOffSeason06YrPlus & AccrualsBM & VolSD \\
ChangeInRecommendation & DivYieldST & zerotrade \\
IndRetBig & MomSeason16YrPlus & BetaFP \\
DelFINL & NetPayoutYield & MS \\
DownRecomm & XFIN & zerotradeAlt12 \\
RIO_Volatility & NetEquityFinance & IdioRisk \\
ExchSwitch & FEPS & \\
DolVol & EntMult & \\
RIO_Turnover & Tax & \\
CompositeDebtIssuance & roaq & \\
UpRecomm & RoE & \\
ShareIss5Y & SP & \\
dNoa & ChTax & \\
OrgCap & OperProf & \\
skew1 & & \\
PriceDelayRsq & & \\
AssetGrowth & & \\
Illiquidity & & \\
\hline
\end{tabular}

\subsection*{Table 10: Cluster assignments of model-motivated factors}
The table presents the assignment of model-motivated factors identified using CAPM when three clusters are chosen in full sample and in recent sample.
\begin{tabular}{lll}
\hline & Full sample & \\
\hline Cluster 2 & Cluster 3 & Cluster 5 \\
\hline MomSeasonShort & MomSeason11YrPlus & RoE \\
MomVol & MomOffSeason06YrPlus & \\
Mom12mOffSeason & MomSeason16YrPlus & \\
MomRev & MomSeason06YrPlus & \\
Mom6m & MomSeason & \\
Mom12m & MomOffSeason & \\
& MomOffSeason16YrPlus & \\
\hline \multicolumn{3}{l}{ Recent sample } \\
\hline MomOffSeason06YrPlus & MomSeason16YrPlus & \\
& Cluster 2 & \\
\hline
\end{tabular}

\subsection*{Table 11: Factors with significance decay after publication}

The table reports factors with significance decay, i.e. $t$-stat decrease, after publication. The CAPM for each factor with sample before and after publication is implemented. The samples before and after the publication are of the same size. The t-stats of $\alpha$ are compared. In total, 157 factors experience decline in t -stat after publication. Among them, 72 of them drop from above 1.96 to below 1.96 , the critical value of $t$ test of 5 percent size.
Data source: Chen and Zimmermann (2021).
\begin{tabular}{|c|c|c|c|c|c|c|c|}
\hline factors & year of publication & t-stat drop & <1.96 after publication & factors & year of publication & t-stat drop & <1.96 after publication \\
\hline AbnormalAccruals & 2001 & 0.48 & Yes & BMdec & 1992 & 1.25 & No \\
\hline Accruals & 1996 & 6.74 & Yes & BPEBM & 2007 & 0.33 & No \\
\hline AdExp & 2001 & 2.34 & Yes & BrandInvest & 2014 & 0.08 & No \\
\hline AnalystValue & 1998 & 0.88 & Yes & Cash & 2012 & 0.38 & No \\
\hline AOP & 1998 & 3.28 & Yes & CashProd & 2009 & 0.72 & No \\
\hline betaVIX & 2006 & 3.14 & Yes & ChangeInRecommendation & 2004 & 5.36 & No \\
\hline BookLeverage & 1992 & 3.18 & Yes & ChInv & 2002 & 4.09 & No \\
\hline CF & 1994 & 1.73 & Yes & ChNAnalyst & 2008 & 1.72 & No \\
\hline ChAssetTurnover & 2008 & 1.88 & Yes & ChNWC & 2008 & 0.19 & No \\
\hline ChEQ & 2010 & 1.99 & Yes & CompositeDebtIssuance & 2008 & 2.13 & No \\
\hline ChForecastAccrual & 2004 & 1.18 & Yes & ConvDebt & 2016 & 1.74 & No \\
\hline ChInvIA & 1998 & 3.73 & Yes & CredRatDG & 2001 & 1.55 & No \\
\hline ChNNCOA & 2008 & 3.39 & Yes & CustomerMomentum & 2008 & 0.23 & No \\
\hline ConsRecomm & 2002 & 0.70 & Yes & DebtIssuance & 1999 & 4.88 & No \\
\hline CoskewACX & 2006 & 1.75 & Yes & DelDRC & 2012 & 0.72 & No \\
\hline Coskewness & 2000 & 2.21 & Yes & DelFint & 2005 & 7.41 & No \\
\hline DelBreadth & 2002 & 0.60 & Yes & DivInit & 1995 & 3.99 & No \\
\hline DelCOA & 2005 & 5.98 & Yes & DownRecomm & 2002 & 1.93 & No \\
\hline DelCOL & 2005 & 5.81 & Yes & EarningsStreak & 2012 & 0.38 & No \\
\hline DelEqu & 2005 & 3.25 & Yes & EarningsSurprise & 1984 & 4.17 & No \\
\hline Delliti & 2005 & 1.96 & Yes & EBM & 2007 & 1.27 & No \\
\hline DelNetFin & 2005 & 2.62 & Yes & ExchSwitch & 1995 & 0.04 & No \\
\hline DivSeason & 2013 & 4.73 & Yes & FEPS & 2006 & 1.16 & No \\
\hline dNoa & 2004 & 7.15 & Yes & FirmAgeMom & 2004 & 0.59 & No \\
\hline EarningsForecastDisparity & 2011 & 1.17 & Yes & ForecastDispersion & 2002 & 0.51 & No \\
\hline EntMult & 2011 & 3.74 & Yes & Frontier & 2009 & 1.97 & No \\
\hline EP & 1977 & 1.35 & Yes & GradExp & 2014 & 0.57 & No \\
\hline EquityDuration & 2004 & 2.93 & Yes & hire & 2014 & 1.44 & No \\
\hline fgr5yrLag & 1996 & 1.95 & Yes & IdioRisk & 2006 & 0.64 & No \\
\hline grcapx & 2006 & 4.32 & Yes & IdioVol3F & 2006 & 0.38 & No \\
\hline grcapx3y & 2006 & 4.40 & Yes & IndRetBig & 2007 & 1.82 & No \\
\hline GrLTNOA & 2003 & 2.00 & Yes & IntanBM & 2006 & 0.93 & No \\
\hline GrSaleToGrInv & 1998 & 4.09 & Yes & IntanCFP & 2006 & 1.66 & No \\
\hline Herf & 2006 & 2.44 & Yes & Investment & 2004 & 0.02 & No \\
\hline HerfAsset & 2006 & 1.53 & Yes & InvestPPEInv & 2008 & 2.24 & No \\
\hline HerfBE & 2006 & 1.95 & Yes & InvGrowth & 2012 & 0.29 & No \\
\hline IdioVolAHT & 2003 & 1.64 & Yes & IO_ShortInterest & 2005 & 1.02 & No \\
\hline IntanEP & 2006 & 2.06 & Yes & Leverage & 1988 & 2.04 & No \\
\hline IntanSP & 2006 & 1.75 & Yes & Mom12m & 1993 & 2.04 & No \\
\hline IntMom & 2012 & 1.84 & Yes & Mom6m & 1993 & 0.26 & No \\
\hline LRreversal & 1985 & 0.43 & Yes & MomOffSeason06YrPlus & 2008 & 1.71 & No \\
\hline MeanRankRevGrowth & 1994 & 4.56 & Yes & MomSeason16YrPlus & 2008 & 0.44 & No \\
\hline Mom12mOffSeason & 2008 & 1.22 & Yes & MomVol & 2000 & 4.20 & No \\
\hline Mom6mJunk & 2007 & 1.34 & Yes & MS & 2005 & 0.75 & No \\
\hline MomOffSeason & 2008 & 3.25 & Yes & NetDebtFinance & 2006 & 3.96 & No \\
\hline MomOffSeason 11 YrPlus & 2008 & 1.96 & Yes & NetEquityFinance & 2006 & 0.28 & No \\
\hline MomRev & 2006 & 2.89 & Yes & NetPayoutYield & 2007 & 0.39 & No \\
\hline MomSeason & 2008 & 5.15 & Yes & NumEarnIncrease & 2012 & 0.35 & No \\
\hline MomSeason06YrPlus & 2008 & 3.13 & Yes & OperProf & 2006 & 0.69 & No \\
\hline MomSeason 11 YrPlus & 2008 & 1.55 & Yes & OperProfRD & 2016 & 0.51 & No \\
\hline MomSeasonShort & 2008 & 2.25 & Yes & OptionVolume2 & 2012 & 0.51 & No \\
\hline NOA & 2004 & 5.88 & Yes & OScore & 1998 & 1.32 & No \\
\hline OPLeverage & 2010 & 2.01 & Yes & Price & 1972 & 0.72 & No \\
\hline OptionVolume 1 & 2012 & 3.14 & Yes & PS & 2000 & 1.15 & No \\
\hline OrderBacklog & 2003 & 1.34 & Yes & RDcap & 2011 & 0.51 & No \\
\hline OrgCap & 2013 & 1.30 & Yes & RDIPO & 2006 & 0.52 & No \\
\hline PayoutYield & 2007 & 2.25 & Yes & RDS & 2011 & 0.90 & No \\
\hline PctAcc & 2011 & 2.28 & Yes & retConglomerate & 2012 & 0.03 & No \\
\hline PredictedFE & 1998 & 1.71 & Yes & ReturnSkew3F & 2015 & 0.66 & No \\
\hline PriceDelayRsq & 2005 & 2.74 & Yes & RevenueSurprise & 2006 & 2.28 & No \\
\hline PriceDelaySlope & 2005 & 1.53 & Yes & RIO_Volatility & 2005 & 1.51 & No \\
\hline PriceDelayTstat & 2005 & 2.29 & Yes & ShareIssiY & 2008 & 2.53 & No \\
\hline RD & 2001 & 2.73 & Yes & ShareIss5Y & 2006 & 2.10 & No \\
\hline Recomm_ShortInterest & 2011 & 1.68 & Yes & ShareRepurchase & 1995 & 1.34 & No \\
\hline REV6 & 1996 & 4.52 & Yes & ShareVol & 1998 & 2.13 & No \\
\hline RIO_Disp & 2005 & 0.87 & Yes & ShortInterest & 2001 & 1.30 & No \\
\hline RIO_MB & 2005 & 2.62 & Yes & sinAlgo & 2009 & 1.67 & No \\
\hline RIO_Turnover & 2005 & 1.38 & Yes & SmileSlope & 2011 & 1.19 & No \\
\hline Size & 1981 & 1.13 & Yes & SP & 1996 & 1.07 & No \\
\hline SurpriseRD & 2004 & 1.89 & Yes & Spinoff & 1993 & 1.48 & No \\
\hline TotalAccruals & 2005 & 1.87 & Yes & std_turn & 2001 & 3.54 & No \\
\hline VarCF & 1996 & 1.74 & Yes & STreversal & 1989 & 8.37 & No \\
\hline AccrualsBM & 2004 & 3.35 & No & tang & $$
2009
$$ & $$
1.05
$$ & No \\
\hline Activism2 & 2005 & 0.16 & No & Tax & $$
2004
$$ & $$
0.28
$$ & No \\
\hline AgeIPO & 1991 & 1.97 & No & UpRecomm & $$
2002
$$ & $$
4.16
$$ & No \\
\hline AM & 1992 & 1.02 & No & VolMkt & 1996 & 0.55 & No \\
\hline AnnouncementReturn & 1996 & 0.20 & No & XFIN & 2006 & 0.85 & No \\
\hline AssetGrowth & 2008 & 2.03 & No & zerotradeAlt 1 & 2006 & 1.07 & No \\
\hline BetaLiquidityPS & 2003 & 1.56 & No & & & & \\
\hline \multicolumn{3}{|c|}{Total} & \multicolumn{2}{|l|}{157} & & & \\
\hline \multicolumn{3}{|c|}{Significance downgrade} & 72 & & & & \\
\hline
\end{tabular}

\subsection*{Table 12: Factors being identified under BH procedure before and after publication}

The table presents the factors that pass the BH FDR control procedure before and after its publication date. The p values of each factor before and after publication is obtained from results of Table 11. The false discovery rate is controlled at 1 percent.
\begin{tabular}{|c|c|c|}
\hline \multicolumn{2}{|l|}{Before Publication} & After Publication \\
\hline STreversal & OScore & AnnouncementReturn \\
\hline AnnouncementReturn & Frontier & DivYieldST \\
\hline DelFINL & AssetGrowth & AnalystRevision \\
\hline EarningsSurprise & Mom12m & VolumeTrend \\
\hline dNoa & AM & ShortInterest \\
\hline ChangeInRecommendation & ExchSwitch & SmileSlope \\
\hline ShortInterest & BookLeverage & VolMkt \\
\hline DebtIssuance & XFIN & BMdec \\
\hline NetDebtFinance & DelEqu & EarningsSurprise \\
\hline Accruals & CredRatDG & BM \\
\hline UpRecomm & RIO_Volatility & FirmAgeMom \\
\hline DelCOA & EntMult & EarningsStreak \\
\hline AnalystRevision & ShareRepurchase & ExchSwitch \\
\hline NOA & VolSD & VolSD \\
\hline ChInv & Tax & zerotradeAlt1 \\
\hline MomVol & RD & STreversal \\
\hline SmileSlope & IO_ShortInterest & IndIPO \\
\hline AccrualsBM & fgr5yrLag & zerotrade \\
\hline DivInit & ChNNCOA & DolVol \\
\hline ShareIss1Y & Recomm_ShortInterest & IndRetBig \\
\hline DivSeason & MomOffSeason & BetaFP \\
\hline BMdec & ForecastDispersion & ShareIss1Y \\
\hline DelCOL & zerotradeAlt12 & DownRecomm \\
\hline std_turn & NetPayoutYield & zerotradeAlt12 \\
\hline MomSeason & MomRev & MaxRet \\
\hline REV6 & NumEarnIncrease & Tax \\
\hline ChInvIA & EquityDuration & RoE \\
\hline VolMkt & FEPS & SP \\
\hline DownRecomm & PriceDelayTstat & NetDebtFinance \\
\hline IndRetBig & IdioRisk & MS \\
\hline RevenueSurprise & IdioVolAHT & \\
\hline grcapx & DolVol & \\
\hline FirmAgeMom & PS & \\
\hline zerotradeAlt1 & EP & \\
\hline DivYieldST & NetEquityFinance & \\
\hline grcapx3y & OptionVolume1 & \\
\hline InvestPPEInv & MomSeason11YrPlus & \\
\hline GrSaleToGrInv & MomSeason16YrPlus & \\
\hline EarningsStreak & BM & \\
\hline ShareIss5Y & OperProf & \\
\hline MeanRankRevGrowth & Herf & \\
\hline AOP & ChEQ & \\
\hline CompositeDebtIssuance & RIO_Turnover & \\
\hline MomOffSeason06YrPlus & IdioVol3F & \\
\hline SP & zerotrade & \\
\hline ConvDebt & Mom6m & \\
\hline AgeIPO & PriceDelaySlope & \\
\hline VolumeTrend & Mom12mOffSeason & \\
\hline MomSeason06YrPlus & RDIPO & \\
\hline Leverage & HerfBE & \\
\hline DelNetFin & Illiquidity & \\
\hline AdExp & OperProfRD & \\
\hline ShareVol & IndIPO & \\
\hline PriceDelayRsq & IntMom & \\
\hline betaVIX & ChForecastAccrual & \\
\hline MS & CF & \\
\hline Total & 112 & 30 \\
\hline
\end{tabular}

\subsection*{Table 13: Result table of post-publication and out-of-sample regression}

Table 13 reports the results of the following regression:
$$
R_{i, t}=\alpha_{i}+\beta_{1} * \text { Out-of-sample }_{i, t}+\beta_{2} * \text { Post-publication }_{i, t}+\epsilon_{i, t}
$$
where
- $R_{i, t}$ is the long-short strategy return of factor $i$ in period $t$.
- Out-of-sample ${ }_{i, t}$ is a dummy equal to 1 when $t$ is after the sampling period of the original paper of factor $i$.
- Post-publication ${ }_{i, t}$ is a dummy equal to 1 when $t$ is after the publication of factor $i$.

The results provide evidence that factors tend to lose power after publication.
\begin{tabular}{cccc}
\hline Variable & $(\mathbf{1})$ & $(2)$ & $(3)$ \\
\hline Out of sample & $-0.28^{* * *}$ & & $-0.28^{* * *}$ \\
& $(0.02)$ & & $(0.02)$ \\
Post-Publication & & $-0.3^{* * *}$ & $-0.3^{* * *}$ \\
& & $(0.03)$ & $(0.03)$ \\
Constant & $0.66^{* * *}$ & $0.65^{* * *}$ & $0.65^{* * *}$ \\
& $(0.01)$ & $(0.01)$ & $(0.01)$ \\
Observations & 126463 & 126463 & 126463 \\
\hline
\end{tabular}

\subsection*{Table 14: Comparison among RP-PCA, FF3, and FF5}

The table shows the anomalies with significant alphas from the following regressions:
$$
r_{i, t}=\alpha_{i}+\beta_{i} f_{t}+u_{i, t}
$$
where $f_{t}$ is 3 RP-PCA latent factors and market factor, Fama-French 3 factors and Fama-French 5 factors repsectively.
\begin{tabular}{|c|c|c|c|c|c|c|c|c|}
\hline \multicolumn{3}{|l|}{3 RP-PCA latents + market} & \multicolumn{3}{|l|}{Fama-French 3} & \multicolumn{3}{|l|}{Fama-French 5} \\
\hline Anomaly & alpha & p-value & Anomaly & alpha & p-value & Anomaly & alpha & p-value \\
\hline ConvDebt & 0.4560 & < 0.0001 & DivSeason & 0.2585 & < 0.0001 & DivSeason & 0.2504 & < 0.0001 \\
\hline DivSeason & 0.2642 & < 0.0001 & VolumeTrend & 0.7903 & < 0.0001 & NetDebtPrice & 1.2205 & < 0.0001 \\
\hline DivYieldST & 0.5749 & < 0.0001 & VolMkt & 1.0182 & < 0.0001 & ConvDebt & 0.3953 & < 0.0001 \\
\hline EarningsConsistency & 0.4015 & < 0.0001 & ConvDebt & 0.5010 & < 0.0001 & MomOffSeason06YrPlus & 0.9380 & < 0.0001 \\
\hline ExchSwitch & 1.0259 & < 0.0001 & ShareIss1Y & 0.9382 & < 0.0001 & VolumeTrend & 0.5633 & < 0.0001 \\
\hline Frontier & 1.0141 & < 0.0001 & OperProfRD & 1.1837 & < 0.0001 & Frontier & 1.3895 & < 0.0001 \\
\hline IndRetBig & 1.2613 & < 0.0001 & CBOperProf & 1.1013 & < 0.0001 & RD & 1.1864 & < 0.0001 \\
\hline MomOffSeason06YrPlus & 0.9042 & < 0.0001 & RoE & 0.6492 & < 0.0001 & DivYieldST & 0.5093 & 0.0001 \\
\hline MomSeason16YrPlus & 0.6569 & < 0.0001 & NumEarnIncrease & 0.4215 & < 0.0001 & ExchSwitch & 1.0765 & 0.0001 \\
\hline NetPayoutYield & 0.9307 & < 0.0001 & NetPayoutYield & 1.3125 & < 0.0001 & AccrualsBM & 1.0928 & 0.0001 \\
\hline ShareIss 1Y & 0.6278 & < 0.0001 & zerotradeAlt1 & 0.9601 & < 0.0001 & zerotradeAlt1 & 0.8128 & 0.0002 \\
\hline & & & MomOffSeason06YrPlus & 0.9398 & < 0.0001 & RevenueSurprise & 0.4801 & 0.0002 \\
\hline & & & RevenueSurprise & 0.5576 & < 0.0001 & dNoa & 0.4263 & 0.0002 \\
\hline & & & AccrualsBM & 1.1777 & < 0.0001 & zerotradeAlt12 & 0.5940 & 0.0003 \\
\hline & & & Frontier & 1.4096 & < 0.0001 & NOA & 0.7833 & 0.0003 \\
\hline & & & OperProf & 0.8359 & < 0.0001 & MomSeason16YrPlus & 0.6171 & 0.0004 \\
\hline & & & EntMult & 0.7521 & < 0.0001 & ShareIss1Y & 0.5509 & 0.0005 \\
\hline & & & roaq & 1.2569 & < 0.0001 & IndRetBig & 1.1104 & 0.0005 \\
\hline & & & Tax & 0.5006 & < 0.0001 & OperProfRD & 0.6962 & 0.0006 \\
\hline & & & BetaFP & -1.3434 & < 0.0001 & AssetGrowth & 0.7759 & 0.0007 \\
\hline & & & SP & 0.8535 & < 0.0001 & CompositeDebtIssuance & 0.2441 & 0.0007 \\
\hline & & & VolSD & 0.5688 & < 0.0001 & DelFINL & 0.2788 & 0.0008 \\
\hline & & & IdioRisk & 1.2535 & < 0.0001 & NumEarnIncrease & 0.2895 & 0.0008 \\
\hline & & & IdioVol3F & 1.2234 & 0.0001 & CBOperProf & 0.7008 & 0.0008 \\
\hline & & & zerotradeAlt12 & 0.6251 & 0.0001 & VolSD & 0.4782 & 0.0009 \\
\hline & & & IndRetBig & 1.2913 & 0.0001 & DolVol & 0.6736 & 0.0011 \\
\hline & & & zerotrade & 0.8546 & 0.0001 & VolMkt & 0.5038 & 0.0011 \\
\hline & & & DivYieldST & 0.4793 & 0.0001 & zerotrade & 0.7282 & 0.0012 \\
\hline & & & MomSeason16YrPlus & 0.6484 & 0.0001 & & & \\
\hline & & & DelFinL & 0.3081 & 0.0001 & & & \\
\hline & & & RIO_Volatility & 1.0383 & 0.0001 & & & \\
\hline & & & MaxRet & 1.2355 & 0.0002 & & & \\
\hline & & & BMdec & 0.4967 & 0.0002 & & & \\
\hline & & & IdioVolAHT & 1.1259 & 0.0003 & & & \\
\hline & & & ExchSwitch & 0.9600 & 0.0003 & & & \\
\hline & & & RIO_Turnover & 0.8127 & 0.0004 & & & \\
\hline & & & DolVol & 0.6863 & 0.0005 & & & \\
\hline & & & CompositeDebtIssuance & 0.2358 & 0.0005 & & & \\
\hline & & & ChTax & 0.4405 & 0.0007 & & & \\
\hline & & & std_turn & 0.9718 & 0.0008 & & & \\
\hline & & & ShareIss5Y & 0.4311 & 0.0009 & & & \\
\hline & & & dNoa & 0.4473 & 0.0009 & & & \\
\hline & & & EarningsConsistency & 0.4074 & 0.0013 & & & \\
\hline & & & OrgCap & 0.5381 & 0.0013 & & & \\
\hline & & & NetDebtPrice & 0.7854 & 0.0017 & & & \\
\hline & & & Illiquidity & 0.3230 & 0.0022 & & & \\
\hline & & & AssetGrowth & 0.7621 & 0.0024 & & & \\
\hline
\end{tabular}

\subsection*{Table 15: Comparison among RP-PCA, FF3, and FF5, continued}

The table compares the root means square, $R^{2}$, and the number of significant anomalies after controlling for FDR among three models specified in the last table.
\begin{tabular}{cccc}
\hline Factors & RMS of alpha & \# Rejections & R Squared \\
\hline 3 latents + Mkt & 0.397 & 11 & 0.574 \\
FF3 & 0.608 & 47 & 0.370 \\
FF5 & 0.462 & 28 & 0.438 \\
\hline
\end{tabular}

\subsection*{Table 16: Fama-French factors on RP-PCA factors and vice versa}

The table shows the significant alphas from the regressions
$$
y_{i, t}=a_{i}+\beta_{i} x_{t}+u_{i, t}
$$
where $\left(y_{t}, x_{t}\right)$ is FF5, RP-PCA latents and Market (first panel) and RP-PCA latents and Market, FF5 (second panel), respectively.
\begin{tabular}{crrccc}
\hline \multicolumn{6}{c}{ FF5 on 3 Latents + Mkt } \\
\hline factor & alpha & $\mathbf{t}$-stat & p-value & fdr reject & $\mathbf{p}<\mathbf{0 . 0 5}$ \\
\hline SMB & 0.370 & 2.289 & 0.023 & No & Yes \\
HML & -0.233 & -1.157 & 0.248 & No & No \\
RMW & 0.232 & 1.927 & 0.055 & No & No \\
CMA & 0.013 & 0.110 & 0.912 & No & No \\
\hline \multicolumn{6}{c}{} \\
\hline \multicolumn{6}{c}{ 3 latents on FF3 } \\
\hline factor & alpha & $\mathbf{t}$-stat & p-value & fdr reject & $\mathbf{p}<\mathbf{0 . 0 5}$ \\
\hline latent 1 & 0.394 & 3.061 & 0.002 & Yes & Yes \\
latent 2 & 0.052 & 0.495 & 0.621 & No & No \\
latent 3 & -0.363 & -4.253 & $<0.001$ & Yes & Yes \\
\hline
\end{tabular}

\subsection*{Table 17: Sharpe ratio of optimal portfolios}

The table shows the Sharpe ratio of the optimal factors constructed by 3 RP-PCA latent factors, FF3 factors, and FF5 factors, respectively.
\begin{tabular}{cc}
\hline factors & Sharpe ratio \\
\hline 3 latents + Mkt & 0.420 \\
FF3 & 0.173 \\
FF5 & 0.393 \\
\hline
\end{tabular}

\section*{Figures}

\subsection*{Figure 1: The rolling number of identified factors}

The figure reports the rolling number of identified factors in the rolling study in Section 3.2. The rolling window is 20 years. Factors with missing data points in a rolling period are removed.
![](https://cdn.mathpix.com/cropped/2025_03_25_6060b0dbe7eb0e8b3830g-36.jpg?height=670&width=1304&top_left_y=538&top_left_x=405)

\subsection*{Figure 2: Rolling BH procedure}

The figure reports the rolling number of identified factors across rolling samples. The detail of the rolling study design is in Section 3.2.
![](https://cdn.mathpix.com/cropped/2025_03_25_6060b0dbe7eb0e8b3830g-36.jpg?height=681&width=1300&top_left_y=1676&top_left_x=407)

\subsection*{Figure 3: Rolling number of rejections: factor model}
The figure presents the results of the rolling study using constant-loading factor model with the mix of market factor and unknown latent factors. The rolling window is 20 years.
![](https://cdn.mathpix.com/cropped/2025_03_25_6060b0dbe7eb0e8b3830g-37.jpg?height=686&width=1289&top_left_y=1126&top_left_x=418)

\subsection*{Figure 4: Alpha for the factor price: time-varying factor model}

The figure presents the heat map of alpha estimates via time-varying factor model on full sample spanning from 1967 to 2021. The detail of the model is discussed in 2.4. The color density shows the value of the alpha.
![](https://cdn.mathpix.com/cropped/2025_03_25_6060b0dbe7eb0e8b3830g-38.jpg?height=2045&width=1638&top_left_y=468&top_left_x=241)

\subsection*{Figure 5: Alpha for the model-motivated factor price: time-varying factor model}

The figure presents the heat map of alpha estimates of the model-motivated factors via timevarying factor model on full sample spanning from 1967 to 2021 . The detail of the model is discussed in 2.4. The color density shows the value of the alpha.
![](https://cdn.mathpix.com/cropped/2025_03_25_6060b0dbe7eb0e8b3830g-39.jpg?height=646&width=1299&top_left_y=569&top_left_x=413)

\subsection*{Figure 6: Number of BH rejections across time: time-varying model}

The figure shows the number of identified factors after implementing the BH procedure on the p-value on alphas obtained from the time-varying model. The sample period spans from 1967 to 2021.
![](https://cdn.mathpix.com/cropped/2025_03_25_6060b0dbe7eb0e8b3830g-39.jpg?height=668&width=1300&top_left_y=1691&top_left_x=407)

\subsection*{Figure 7: Number of BH rejections of model-motivated factors across time: timevarying model}

The figure shows the number of model-motivated factors identified after implementing the BH procedure on the p-value on alphas obtained from the time-varying model. The sample period spans from 1967 to 2021.
![](https://cdn.mathpix.com/cropped/2025_03_25_6060b0dbe7eb0e8b3830g-40.jpg?height=687&width=1308&top_left_y=1147&top_left_x=406)

\subsection*{Figure 8: The aggregation levels across number of clusters: full sample}

The figure plots the aggregation levels of different number of clusters of factors identified via CAPM in Section 1. The height on y-axis shows the proportion of the intergroup dissimilarity. According to this plot, 5 clusters are chosen that groups identified factors.
![](https://cdn.mathpix.com/cropped/2025_03_25_6060b0dbe7eb0e8b3830g-41.jpg?height=814&width=1319&top_left_y=496&top_left_x=403)

\subsection*{Figure 9: The aggregation levels across number of clusters: recent sample}

The figure plots the aggregation levels of different number of clusters of factors identified via CAPM in Section 2. The height on $y$-axis shows the proportion of the intergroup dissimilarity. According to this plot, 3 clusters are chosen that groups identified factors.
![](https://cdn.mathpix.com/cropped/2025_03_25_6060b0dbe7eb0e8b3830g-41.jpg?height=817&width=1321&top_left_y=1635&top_left_x=399)

\subsection*{Figure 10: Correlation heat map of factors identified via CAPM in full sample}
The heat map shows the correlation between factors identified via CAPM discussed in Section 2.1. The tail number of each factor indicates the cluster number that the factor belongs to. And the diagonal entries are replaced with 0 for better visualization effect.
![](https://cdn.mathpix.com/cropped/2025_03_25_6060b0dbe7eb0e8b3830g-42.jpg?height=1004&width=1305&top_left_y=970&top_left_x=410)

\subsection*{Figure 11: Correlation heat map of factors identified via CAPM in recent sample}
The heat map shows the correlation between factors identified via CAPM in recent sample discussed in Section 2.1. The tail number of each factor indicates the cluster number that the factor belongs to. And the diagonal entries are replaced with 0 for better visualization effect.
![](https://cdn.mathpix.com/cropped/2025_03_25_6060b0dbe7eb0e8b3830g-43.jpg?height=1020&width=1318&top_left_y=956&top_left_x=401)

\section*{References}

Ahn, S. and Horenstein, A. (2013). Eigenvalue ratio test for the number of factors. Econometrica, 81(5):1203-1227.

Avramov, D., Cheng, S., and Metzker, L. (2022). Machine learning vs. economic restrictions: Evidence from stock return predictability.

Bai, J. (2003). Inferential theory for factor models of large dimensions. Econometrica, 71(1):135-171.

Bai, J. and Ng, S. (2002). Determining the number of factors in approximate factor models. Econometrica, 70(1):191-221.

Barillas, F. and Shanken, J. (2017). Which alpha? The Review of financial studies, 30(4):1316-1338.

Benjamini, Y. and Hochberg, Y. (1995). Controlling the false discovery rate: A practical and powerful approach to multiple testing. Journal of the Royal Statistical Society Series B, 57:289-300.

Cai, Z. (2007). Trending time-varying coefficient time series models with serially correlated errors. Journal of Econometrics, 136(1):163-188.

Caner, M., Medeiros, M., and Vasconcelos, G. F. (2022). Sharpe ratio analysis in high dimensions: Residual-based nodewise regression in factor models. Journal of Econometrics.

Chen, A. Y. (2021). The limits of p-hacking: Some thought experimentsthousands of alpha tests. The Journal of Finance, 76(5):2447-2480.

Chen, A. Y. and Zimmermann, T. (2021). Open source cross-sectional asset pricing. Critical Finance Review, forthcoming.

Chib, S., Zhao, L., and Zhou, G. (2022). Winners from winners: A tale of risk factors. Working paper.

Cochrane, J. H. (2011). Presidential address: Discount rates. Journal of Finance, 66:1047 - 1108.

Connor, G. and Korajczyk, R. A. (1986). Performance measurement with the arbitrage pricing theory: A new framework for analysis. Journal of Financial Economics, 15:373394.

Daniel, K., Hirshleifer, D., and Sun, L. (2020). Short- and long-horizon behavioral factors. The Review of financial studies, 33:1673-1736.

Fan, J., Ke, Z. T., Liao, Y., and Neuhierl, A. (2022). Structural deep learning in conditional asset pricing. Available at SSRN 4117882.

Freyberger, J., Neuhierl, A., and Weber, M. (2020). Dissecting characteristics nonparametrically. The Review of financial studies, 33:2326-2377.

Fu, Z., Hong, Y., and Wang, X. (2023). Testing for structural changes in large dimensional factor models via discrete fourier transform. Journal of Econometrics, page forthcoming.

Genovese, C. R., Roeder, K., and Wasserman, L. (2006). False discovery control with p-value weighting. Biometrika, 93(3):509-524.

Giglio, S., Liao, Y., and Xiu, D. (2021). Thousands of alpha tests. The Review of Financial Studies, 34(7):3456-3496.

Giglio, S. and Xiu, D. (2021). Asset pricing with omitted factors. Journal of Political Economy, 129(7):1947-1990.

Green, J., Hand, J. R. M., and Zhang, X. F. (2017). The characteristics that provide independent information about average u.s. monthly stock returns. The Review of financial studies, 30(12):4389-4436.

Gu, S., Kelly, B., and Xiu, D. (2020). Empirical asset pricing via machine learning. The Review of financial studies, 33:2223-2273.

Harvey, C. R., Liu, Y., and Zhu, H. (2016). ... and the cross-section of expected returns. The Review of Financial Studies, 29(1):5-68.

He, A., Huang, D., Li, J., and Zhou, G. (2022). Shrinking factor dimension: A reducedrank approach. Management science.

Hong, Y. and Li, H. (2005). Nonparametric specification testing for continuous-time models with applications to term structure of interest rates. The Review of Financial Studies, 18(1):37-84.

Hou, K., Xue, C., and Zhang, L. (2015). Digesting anomalies: An investment approach. Review of Financial Studies.

Hu, J. X., Zhao, H., and Zhou, H. H. (2010). Cfalse discovery rate control with groups. Journal of the American Statistical Association, 105(491):1215-1227.

Huang, C.-f. and Litzenberger, R. H. (1988). Foundations for financial economics. Prentice Hall.

Jensen, T. I., Kelly, B. T., and Pedersen, L. H. (2023). Is there a replication crisis in finance? The Journal of Finance.

Kelly, B. T., Pruitt, S., and Su, Y. (2019). Characteristics are covariances: A unified model of risk and return. Journal of Financial Economics, 134(3):501-524.

Kozak, S., Nagel, S., and Santosh, S. (2020). Shrinking the cross-section. Journal of financial economics, 135:271-292.

Lettau, M. and Pelger, M. (2020a). Estimating latent asset-pricing factors. Journal of econometrics, 218(1):1-31.

Lettau, M. and Pelger, M. (2020b). Factors that fit the time series and cross-section of stock returns. The Review of Financial Studies, 33:2274-2325.

Lo, A. W. (2004). The adaptive markets hypothesis: market efficiency from an evolutionary perspective. Journal of portfolio management, pages 15-29.

McLean, D. and Pontiff, J. (2016). Does academic research destroy stock return predictability? The Journal of Finance, 71(1):5-32.

Nagel, S. (2021). Machine Learning in Asset Pricing. Princeton Lectures in Finance. Princeton University Press, Princeton.

Phillips, P. and Hansen, B. (1990). Statistical inference in instrumental variables regression with i(1) processes. Rev. Econ. Stud, 57:99-125.

Rand, W. M. (1971). Objective criteria for the evaluation of clustering methods. Journal of the American Statistical Association, 66(336):846-850.

Robinson, P. M. (1989). Nonparametric estimation of time-varying parameters. In Statistical Analysis and Forecasting of Economic Structural Change, pages 253-264. Springer.

Robinson, P. M. (1991). Time-varying nonlinear regression. In Economic Structural Change Analysis and Forecasting, pages 179-190. Springer.

Ross, S. A. (1976). The arbitrage theory of capital asset pricing. Journal of Economic Theory, 13(3):341-360.

Schwert, W. G. (2003). Anomalies and market efficiency. In Handbook of the Economics of Finance Ed. by Constantinides, G.M., Harris, M., and Stulz, R.M. Vol.1B, pages 939-974.

Stambaugh, R. F. and Yuan, Y. (2017). Mispricing factors. The Review of financial studies, 30:1270-1315.

Stock, J. H. and Watson, M. W. (2002). Forecasting using principal components from a large number of predictors. Journal of the American Statistical Association, 97(460):11671179.

Su, L. and Wang, X. (2017). On time-varying factor models: Estimation and testing. Journal of econometrics, 198(1):84-101.

\section*{Appendix}

\subsection*{Appendix A Asymptotic Theory}

To derive the asymptotic properties of our estimators, we impose the following regularity conditions. For simplicity, we consider the case where $\gamma=-1$ and the general results can be derived analogously.

**Assumption A.1.** $\alpha$-mixing. The vector-valued process $\left\{\boldsymbol{f}_{t}^{\top}, \boldsymbol{u}_{t}^{\top}\right\}^{\top}$ is a stationary $\alpha$-mixing process with mixing coefficients $\alpha(j)=\sup _{\tau} \sup _{A \in \mathcal{F}_{-\infty}^{\tau}, B \in \mathcal{F}_{\tau+j}^{\infty}}|P(A \cap B)-P(A) P(B)|$, where $\mathcal{F}_{\tau}^{s}$ is the $\sigma$-field generated by $\left.\left\{\boldsymbol{f}_{t}^{\top}, \boldsymbol{u}_{t}^{\top}\right\}^{\top}: \tau \leq t \leq s\right\}$, and the mixing coefficients satisfy the condition that
$$
\sum_{h=1}^{\infty} \alpha(h)^{1-2 / \gamma}<\infty
$$
for some $\gamma>2$.

**Assumption A.2.** Factor and noise. There exists a positive constant $C<\infty$ such that,
(a) For all $1 \leq i \leq N, 1 \leq t \leq T, \mathbb{E}\left[u_{i, t}\right]=0$ and $\mathbb{E} u_{i, t}^{8} \leq C$.
(b) $\left\{\boldsymbol{u}_{t}\right\}$ is a martingale difference sequence. In particular, $\mathbb{E}\left(\boldsymbol{u}_{t} \mid \mathcal{I}_{t-1}\right)=0$, where $\mathcal{I}_{t}=\left\{\boldsymbol{u}_{t}^{\top}, \boldsymbol{u}_{t-1}^{\top}, \ldots, \boldsymbol{f}_{t}^{\top}, \boldsymbol{f}_{t-1}^{\top}\right.$,.
(c) Factor and noise are uncorrelated, that is, $\mathbb{E}\left[e_{i, t} f_{j, s}\right]=0$ for any $1 \leq i, j \leq N, 1 \leq t, s \leq T$.

**Assumption A.3. Loading and alpha.**
(a) For each row of $\boldsymbol{\beta}_{t}^{(j)},\left\|\boldsymbol{\beta}_{i, t}^{(j)}\right\|=\mathcal{O}(1)$, and, as $N \rightarrow \infty$, we have $\left\|N^{-1} \boldsymbol{\beta}_{t}^{(j) \top} \boldsymbol{\beta}_{t}^{(l)}-\boldsymbol{\Omega}_{t}^{(j, l)}\right\| \longrightarrow$ 0 for some $r \times r$ positive definite matrix $\mathbf{\Omega}_{t}^{(j, l)}$ for $j, l=0,1,2$.
(b) For $1 \leq t \leq T,\left\|\frac{1}{\sqrt{N}} \boldsymbol{\beta}_{t}^{\top} \mathbb{M}_{1_{N}} \boldsymbol{\alpha}_{t}\right\|=O(1)$.

**Assumption A.4.** Cross-sectional correlation of noise. There exists some positive constant $C<\infty$ such that,
(a) $\left\|\mathbb{E}\left[\boldsymbol{u}_{t} \boldsymbol{u}_{t}^{T} / N\right]\right\|_{1} \leq C$.
(b) For all $1 \leq i \leq N, 1 \leq t \leq T$, we assume $\sum_{j=1, j \neq i}^{N}\left|\mathbb{E}\left[u_{t, i} u_{t, j}\right]\right| \leq C$.
(c) For all $1 \leq i, j \leq N, 1 \leq t \leq T$, we assume
$$
\sum_{l=1}^{N} \sum_{s=1}^{T}\left|\operatorname{Cov}\left(u_{i, t} u_{j, t}, u_{i, s} u_{l, s}\right)\right| \leq C
$$

**Assumption A.5.** $\boldsymbol{\beta}_{i \cdot}(t / T)$ and $\boldsymbol{\alpha}_{i \cdot( }(t / T)$ have continuous derivatives up to the second order. Moreover, there exists $m>2,1<a, b<\infty, 1 / a+1 / b=1, c=0,1,2$ such that, for some positive $C<\infty, \mathbb{E}\left[\left|\frac{1}{\sqrt{N}} \sum_{i=1}^{N} u_{i, t}\right|^{m b}\right]=\mathcal{O}(1), \mathbb{E}\left[\left\|\frac{1}{\sqrt{N}} \sum_{i=1}^{N} \beta_{i, t}^{(c)} u_{i, t}\right\|^{m b}\right]=\mathcal{O}(1)$, and $\mathbb{E}\left[\left\|f_{t}\right\|^{\max (m a, 4)}\right] \leq$ $C$ for any $1 \leq t \leq T$,

**Assumption A.6. Kernel.** The kernel function $k(\cdot):[-1,1] \rightarrow \mathbb{R}^{+}$is a symmetric and Lipschitz continuous probability density function such that $\int_{-1}^{1} k(u) d u=1, \int_{-1}^{1} u k(u) d u=0$, and $\int_{-1}^{1} u^{2} k(u) d u<\infty$.

The $\alpha$-mixing condition in Assumption A. 1 allows weak temporal correlations for both the factors and noises. Assumption A. 2 mainly imposes moment condition on the error as well as zero correlation between the error and factor. Different from Giglio et al. (2021), both the error and factor are allowed to have serial dependence. Assumption A.3(a) imposes the pervasive condition of the factor loading, following (Stock and Watson, 2002). It ensures that each row of the factor vector $f_{t}$ has a nontrivial contribution to the variance of $\boldsymbol{r}_{t}$. Assumption A.3(b) imposes a mild condition on the relationship between the loading and alpha, which is weaker than Assumption A.4(i) imposed in Fan et al. (2022).

In the high-dimensional factor model, the diverging cross-sectional dimension $N$ also determines the convergence rate of our estimator, which is affected by the cross-sectional dependence. Thus Assumptions A. 4 and A. 5 are imposed so that the information accumulated over the cross-sectional dimension is useful too. These conditions are obviously satisfied if $\left\{u_{i, t}\right\}$ is cross-sectional independent and is independent of $f_{t}$, with assumed moment conditions. We include them to allow for weak cross-sectional and temporal dependence and our model is an approximate static factor model similar to Bai and Ng
(2002) and Bai (2003). Assumption A. 5 also imposes smoothness conditions on the alpha and beta functions, which have been commonly imposed in the literature (see Robinson (1989), Cai (2007), Su and Wang (2017)). Assumptions A. 6 is a standard assumption for kernel regressions. This condition is satisfied by widely used second-order kernels, such as the Epanechnikov, uniform, and quartic kernels.

We now state the consistency of $\widehat{\boldsymbol{\alpha}}_{t}$.

**Theorem 1.** Suppose Assumptions A.1-A. 6 are satisfied. As $k$ fixed, $h \rightarrow 0, T h^{3} \rightarrow \infty$, and $T, N \rightarrow \infty$, we have
$$
\frac{1}{N}\left\|\widehat{\boldsymbol{\alpha}}_{t}-\alpha_{t}\right\|^{2}=\mathcal{O}_{p}\left(\frac{1}{N^{2}}+\frac{1}{T h}+h^{4}\right)
$$

Theorem 1 establishes the convergence rate of our nonparametric estimator $\widehat{\alpha}_{t}$, which depends on both $T$ and $N$. Unlike the latent factor $f_{t}$ and the factor loading $\beta_{t}$, which are only identified up to a rotation transformation, $\alpha_{t}$ is identifiable.

**Theorem 2.** Suppose Assumptions A.1-A. 6 are satisfied. As $k$ fixed, $h \rightarrow 0, T h^{3} \rightarrow \infty, T h^{5} \rightarrow$ $0, T h / N \rightarrow 0$, and $T, N \rightarrow \infty$, for each $i=1, \cdots, N$ and $t=1, \cdots, T$, we have
$$
\sqrt{\operatorname{Th}}\left(\widehat{\alpha}_{t, i}-\alpha_{t, i}\right) \rightarrow^{d} N\left(0, v_{0} \Sigma_{\alpha_{t, i}}\right),
$$
where
$$
\Sigma_{\alpha_{t, i}}=\mathbb{E}\left[u_{t, i}^{2}\left(1-\boldsymbol{v}_{t}^{\top} \Sigma_{f}^{-1} \lambda_{t}\right)^{2}\right]
$$
$v_{0}=\int_{-1}^{1} k^{2}(u) d u$, and $\Sigma_{f}$ is the covariance matrix of $f_{t}$.
Theorem 2 shows the asymptotic normality of the nonparametric estimator $\widehat{\alpha}_{t, i}$. As shown in the appendix, the asymptotic bias $\widehat{\boldsymbol{\alpha}}_{t, i}$ is proportional to $h^{2}$ in both interior region and boundary regions, thanks to the use of the boundary-modified kernel function in (6). Therefore, when $T h^{5} \rightarrow 0$, the asymptotic bias is asymptotically negligible. A candidate bandwidth that satisfies the assumptions is $h=T^{-1 / 4.5}$ when $T^{3.5 / 4.5} / N \rightarrow 0$.

Theorems 1 and 2 present the asymptotic properties when the dimension of the latent factor $r$ is assumed to be known. In practice, we can estimate and $r$ via the generalized eigenvalue ratio-based estimator defined in (10). The asymptotic validity of $\widehat{r}$ is justified in Theorem 3 below.

**Theorem 3.** Suppose Assumptions A.1-A. 6 are satisfied and $r_{\text {max }}$ is a predetermined constant no smaller than $r$. Then we have
$$
P(\widehat{r}=r) \rightarrow 1
$$
as $h \rightarrow 0, T h^{3} \rightarrow \infty, T, N \rightarrow \infty$, where $\widehat{r}$ are defined in (10).

Theorem 3 derives the consistency of the ratio-based estimator $\widehat{r}$. This can be viewed as a generalization of Theorem 1 of Ahn and Horenstein (2013) from constant parameter factor models to time-varying factor models. Other selection criteria, such as BIC (Bai and Ng (2002)) can be adopted too.

\section*{Appendix B Proofs}

\subsection*{Proof of Theorem 1}

Proof. Recall that our estimator $\widehat{\boldsymbol{\beta}}_{t}$ is given by the matrix of $\sqrt{N}$ times the top $k$ eigenvectors of $\widehat{\Sigma}_{t}$ in descending order by corresponding eigenvalues. By the definition of eigenvectors and eigenvalues, we have
$$
\widehat{\boldsymbol{\beta}}_{t}=\widehat{\Sigma}_{t} \widehat{\beta}_{t} \widehat{V}_{t}^{-1} .
$$

Let
$$
\boldsymbol{H}_{t}=\frac{1}{N T} \sum_{s=1}^{T}\left(\boldsymbol{v}_{s}-\overline{\boldsymbol{v}}_{t}\right)\left(\boldsymbol{u}_{s}-\overline{\boldsymbol{u}}_{t}\right)^{\top} \boldsymbol{\beta}_{t}^{\top} \widehat{\boldsymbol{\beta}}_{t} K_{h, s t} \widehat{\boldsymbol{V}}_{t}^{-1}
$$

Then we have the following decomposition:
$$
\begin{align*}
\widehat{\boldsymbol{\beta}}_{t}-\boldsymbol{\beta}_{t} \boldsymbol{H}_{t} & =\widehat{\boldsymbol{\Sigma}}_{t} \widehat{\boldsymbol{\beta}}_{t} \widehat{\boldsymbol{V}}_{t}^{-1}-\boldsymbol{\beta}_{t} \boldsymbol{H}_{t} \\
& =\frac{1}{N T} \sum_{s=1}^{T} K_{h, s t}\left[\boldsymbol{\beta}_{t}\left(\boldsymbol{v}_{s}-\overline{\boldsymbol{v}}_{t}\right)\left(\boldsymbol{u}_{s}-\overline{\boldsymbol{u}}_{t}\right)^{\top}+\left(\boldsymbol{u}_{s}-\overline{\boldsymbol{u}}_{t}\right)\left(\boldsymbol{v}_{s}-\overline{\boldsymbol{v}}_{t}\right)^{\top} \boldsymbol{\beta}_{t}^{\top}+\left(\boldsymbol{u}_{s}-\overline{\boldsymbol{u}}_{t}\right)\left(\boldsymbol{u}_{s}-\overline{\boldsymbol{u}}_{t}\right)^{\top}\right. \\
& +\boldsymbol{D}_{s t} \boldsymbol{v}_{s}\left(\boldsymbol{v}_{s}-\overline{\boldsymbol{v}}_{t}\right)^{\top} \boldsymbol{\beta}_{t}^{\top}+\left(\boldsymbol{D}_{s t} \boldsymbol{v}_{s}-T^{-1} \sum_{s=1}^{T} K_{h, s t} \boldsymbol{D}_{s t} \boldsymbol{v}_{s}\right) \boldsymbol{v}_{s}^{\top} \boldsymbol{D}_{s t}^{\top}+\boldsymbol{\beta}_{t}\left(\boldsymbol{v}_{s}-\overline{\boldsymbol{v}}_{t}\right) \boldsymbol{v}_{s}^{\top} \boldsymbol{D}_{s t}^{\top} \\
& +\left(\boldsymbol{u}_{s}-\overline{\boldsymbol{u}}_{t}\right) \boldsymbol{v}_{s}^{\top} \boldsymbol{D}_{s t}^{\top}+\boldsymbol{D}_{s t} \boldsymbol{v}_{s}\left(\boldsymbol{u}_{s}-\overline{\boldsymbol{u}}_{t}\right)^{\top}+\boldsymbol{\alpha}_{s}\left(\boldsymbol{\alpha}_{s}-\boldsymbol{\alpha}_{t}\right)^{\top}+\left(\boldsymbol{\alpha}_{s}\left(\boldsymbol{\beta}_{s} \boldsymbol{v}_{s}+\beta_{s} \boldsymbol{\lambda}_{s}+u_{s}\right)^{\top}\right. \\
& \left.-\boldsymbol{\alpha}_{s} T^{-1} \sum_{r=1}^{T} K_{h, r t}\left(\boldsymbol{\beta}_{r} \boldsymbol{v}_{r}+\boldsymbol{\beta}_{r} \boldsymbol{\lambda}_{r}+\boldsymbol{u}_{r}\right)\right) \\
& \left.+\left(\left(\beta_{s} \boldsymbol{v}_{s}+\boldsymbol{\beta}_{s} \boldsymbol{\lambda}_{s}+u_{s}\right) \boldsymbol{\alpha}_{s}^{\top}-T^{-1} \sum_{r=1}^{T} K_{h, r t}\left(\boldsymbol{\beta}_{r} \boldsymbol{v}_{r}+\boldsymbol{\beta}_{r} \boldsymbol{\lambda}_{r}+\boldsymbol{u}_{r}\right) \boldsymbol{\alpha}_{s}^{\top}\right)\right] \widehat{\boldsymbol{\beta}}_{t} \widehat{\boldsymbol{V}}_{t}^{-1} \\
& \triangleq \sum_{j=1}^{11} \mathrm{I}_{\mathrm{j}} \widehat{\boldsymbol{\beta}}_{\mathrm{t}} \widehat{\boldsymbol{V}}_{\mathrm{t}}^{-1}, \tag{12}
\end{align*}
$$
where $\boldsymbol{D}_{s t}=\boldsymbol{\beta}_{s}-\boldsymbol{\beta}_{t}$ and $\boldsymbol{v}_{t}=\boldsymbol{f}_{t}-\mathbb{E}\left[\boldsymbol{f}_{t}\right]$. Then we have $\frac{1}{\sqrt{N}}\left\|\widehat{\boldsymbol{\beta}}_{t}-\boldsymbol{\beta}_{t} \boldsymbol{H}_{t}\right\|=\mathcal{O}_{p}\left(\frac{1}{\sqrt{T h}}+\frac{1}{N}+h^{2}\right)$ by Lemma 1 below.

Secondly, we expand $\widehat{\boldsymbol{\lambda}}_{t}-\boldsymbol{H}_{t}^{-1} \boldsymbol{\lambda}_{t}$ :
$$
\begin{align*}
\widehat{\boldsymbol{\lambda}}_{t}-\boldsymbol{H}_{t}^{-1} \boldsymbol{\lambda}_{t} & =\boldsymbol{H}_{t}^{-1} \overline{\boldsymbol{v}}_{t}+\frac{1}{N} \widehat{\boldsymbol{S}}_{\boldsymbol{\beta}}^{1} \boldsymbol{H}_{t}^{\top} \boldsymbol{\beta}_{t} \mathbb{M}_{1_{N}} \overline{\boldsymbol{\alpha}}_{t}+\frac{1}{N} \widehat{\boldsymbol{S}}_{\boldsymbol{\beta}}^{1} \widehat{\boldsymbol{\beta}}_{t}^{\top} \mathbb{M}_{1_{N}} \overline{\boldsymbol{u}}_{t} \\
& +\frac{1}{N} \widehat{\boldsymbol{S}}_{\boldsymbol{\beta}}^{1} \widehat{\boldsymbol{\beta}}_{t}^{\top} \mathbb{M}_{1_{N}}\left(\boldsymbol{\beta}_{t} \boldsymbol{H}_{t}-\widehat{\boldsymbol{\beta}}_{t}\right) \boldsymbol{H}_{t}^{-1} \overline{\boldsymbol{v}}_{t}+\frac{1}{N} \widehat{\boldsymbol{S}}_{\boldsymbol{\beta}}^{1} \widehat{\boldsymbol{\beta}}_{t}^{\top} \mathbb{M}_{1_{N}}\left(\overline{\boldsymbol{\beta}}_{t} \boldsymbol{H}_{t}-\widehat{\boldsymbol{\beta} K_{t}}\right) \boldsymbol{H}_{t}^{-1} \boldsymbol{\lambda}_{t} \\
& +\frac{1}{N} \widehat{\boldsymbol{S}}_{\boldsymbol{\beta}}^{-1}\left(\widehat{\boldsymbol{\beta}}_{t}-\boldsymbol{\beta}_{t} \boldsymbol{H}_{t}\right)^{\top} \mathbb{M}_{1_{N}} \overline{\boldsymbol{\alpha}}_{t}+\frac{1}{N} \widehat{\boldsymbol{S}}_{\boldsymbol{\beta}}^{1} \widehat{\boldsymbol{\beta}}_{t}^{\top} \mathbb{M}_{1_{N}}\left(T^{-1} \sum_{s=1}^{T} D_{s t} \boldsymbol{v}_{s} K_{h, s t}\right) \\
& =\boldsymbol{H}_{t}^{-1} \overline{\boldsymbol{v}}_{t}+\frac{1}{N} \widehat{\boldsymbol{S}}_{\boldsymbol{\beta}}^{1} \boldsymbol{H}_{t}^{\top} \boldsymbol{\beta}_{t}^{\top} \mathbb{M}_{1_{N}} \overline{\boldsymbol{\alpha}}_{t}+\mathcal{O}_{p}\left(\frac{1}{N}+\frac{1}{T h}+h^{2}\right), \tag{13}
\end{align*}
$$
where $\overline{\boldsymbol{x}}_{t}=T^{-1} \sum_{s=1}^{T} \boldsymbol{x}_{s} K_{h, s t}, \boldsymbol{x}=\boldsymbol{v}, \boldsymbol{u}, \boldsymbol{f}, \boldsymbol{\alpha}$, or $\boldsymbol{\beta}$ and $\bar{K}_{t}=T^{-1} \sum_{s=1}^{T} K_{h, s t}$.

Last, we expand $\widehat{\alpha_{t}}-\alpha_{t}$ :
$$
\begin{align*}
\widehat{\alpha}_{t}-\boldsymbol{\alpha}_{t} & =\overline{\boldsymbol{u}}_{t}+\frac{1}{T} \sum_{s=1}^{T} \boldsymbol{\beta}_{s} \boldsymbol{v}_{s} K_{h, s t}+\left(\overline{\boldsymbol{\alpha}}_{t}-\boldsymbol{\alpha}_{t}\right)-\boldsymbol{\beta}_{t} \boldsymbol{H}_{t}\left(\widehat{\lambda}_{t}-\boldsymbol{H}_{t}^{-1} \boldsymbol{\lambda}_{t}\right)+\left(\boldsymbol{\beta}_{t} \boldsymbol{H}_{t}-\widehat{\boldsymbol{\beta}}_{t}\right) \widehat{\boldsymbol{\lambda}}_{t}+\left(\overline{\boldsymbol{\beta}}_{t} \lambda_{t}-\boldsymbol{\beta}_{t} \lambda_{t}\right) \\
& =\overline{\boldsymbol{u}}_{t}+\left(\frac{1}{T} \sum_{s=1}^{T} \beta_{s} \boldsymbol{v}_{s} K_{h, s t}-\boldsymbol{\beta}_{t} \overline{\boldsymbol{v}}_{t}\right)+\left(\overline{\boldsymbol{\alpha}}_{t}-\boldsymbol{\alpha}_{t}\right)-\frac{1}{N} \boldsymbol{\beta}_{t} \boldsymbol{H}_{t} \widehat{\boldsymbol{S}}_{\boldsymbol{\beta}}^{-1} \boldsymbol{H}_{t}^{\top} \boldsymbol{\beta}_{t} \mathbb{M}_{1_{N}} \overline{\boldsymbol{\alpha}}_{t} \\
& -\frac{1}{N} \boldsymbol{\beta}_{t} \boldsymbol{H}_{t} \widehat{\boldsymbol{s}}_{\boldsymbol{\beta}}^{-1} \boldsymbol{H}_{t}^{\top} \boldsymbol{\beta}_{t}^{\top} \mathbb{M _ { 1 _ { N } }}\left(T^{-1} \sum_{s=1}^{T} D_{s t} \boldsymbol{v}_{s} K_{h, s t}\right)-\sum_{j=1}^{11} \mathrm{I}_{\mathrm{j}} \widehat{\boldsymbol{\beta}}_{\mathrm{t}} \widehat{\boldsymbol{V}}_{\mathrm{t}}^{-1} \widehat{\lambda}_{\mathrm{t}}+\mathcal{O}_{\mathrm{p}}\left(\frac{1}{\mathrm{~N}}+\frac{1}{\mathrm{Th}}+\mathrm{h}^{2}\right), \tag{14}
\end{align*}
$$
where $I_{j}, j=1, \cdots, 8$, is defined in (12). Theorem 1 follows by Lemma 1 below. Note: need the condition $\max _{t}\left\|\frac{1}{\sqrt{N}} \boldsymbol{\beta}_{t}^{\top} I M_{1_{N}} \boldsymbol{\alpha}_{t}\right\|=O(1)$

Lemma 1. Under Assumption A.1-A.6, we have for any $1 \leq t \leq T$,
(a) $\frac{1}{N}\left\|\mathrm{I}_{1} \widehat{\boldsymbol{\beta}}_{\mathrm{t}}\right\|_{F}^{2}=\mathcal{O}_{p}\left(\frac{1}{T h}\right)$;
(b) $\frac{1}{N}\left\|\mathrm{I}_{2} \widehat{\boldsymbol{\beta}}_{\mathrm{t}}\right\|_{F}^{2}=\mathcal{O}_{p}\left(\frac{1}{T h}\right)$;
(c) $\frac{1}{N}\left\|\mathrm{I}_{3} \widehat{\boldsymbol{\beta}}_{\mathrm{t}}\right\|_{F}^{2}=\mathcal{O}_{p}\left(\frac{1}{\mathrm{Th}}\right)+\mathcal{O}_{p}\left(\frac{1}{N^{2}}\right)$;
(d) $\frac{1}{N}\left\|\mathrm{I}_{\mathrm{j}} \widehat{\boldsymbol{\beta}}_{\mathrm{t}}\right\|_{F}^{2}=\mathcal{O}_{p}\left(h^{4}\right), j=4,5,6$;
(e) $\frac{1}{N}\left\|\mathrm{I}_{\mathrm{j}} \widehat{\boldsymbol{\beta}}_{\mathrm{t}}\right\|_{F}^{2}=\mathrm{o}_{\mathrm{p}}\left(h^{4}\right), j=7,8$;
(f) $\frac{1}{N}\left\|\mathrm{I}_{9} \widehat{\boldsymbol{\beta}}_{\mathrm{t}}\right\|_{F}^{2}=\mathcal{O}_{p}\left(h^{4}\right)+\mathcal{O}_{p}\left(\frac{1}{T^{2} h^{2}}\right)$;
(g) $\frac{1}{N}\left\|\mathrm{I}_{\mathrm{j}} \widehat{\boldsymbol{\beta}}_{\mathrm{t}}\right\|_{F}^{2}=\mathcal{O}_{p}\left(\frac{h^{4}}{T h}\right), j=10,11$;
(h) $\frac{1}{N}\left\|\bar{v}_{t}\right\|_{F}^{2}=\mathcal{O}_{p}\left(\frac{1}{T h}\right)$;
(i) $\frac{1}{N}\left\|\overline{\boldsymbol{u}}_{t}\right\|_{F}^{2}=\mathcal{O}_{p}\left(\frac{1}{T h}\right)$;
(j) $\frac{1}{N}\left\|\frac{1}{T} \sum_{s=1}^{T} \beta_{s} \boldsymbol{v}_{s} K_{h, s t}-\beta_{t} \overline{\boldsymbol{v}}_{t}\right\|_{F}^{2}=\mathcal{O}_{p}\left(\frac{h}{T}\right)$;
(k) $\frac{1}{N}\left\|\bar{\alpha}_{t}-\boldsymbol{\alpha}_{t}\right\|_{F}^{2}=\mathcal{O}_{p}\left(h^{4}\right) ;$
(l) $\frac{1}{N}\left\|\frac{1}{N} \beta_{t} \boldsymbol{H}_{t} \widehat{\boldsymbol{S}}_{\boldsymbol{\beta}}^{-1} \boldsymbol{H}_{t}^{\top} \boldsymbol{\beta}_{t}^{\top} \mathbb{M}_{1_{N}} \overline{\boldsymbol{\alpha}}_{t}\right\|_{F}^{2}=\mathcal{O}_{p}\left(\frac{1}{N}\right)$;
(m) $\frac{1}{N}\left\|\frac{1}{N} \boldsymbol{\beta}_{t} \boldsymbol{H}_{t} \widehat{\boldsymbol{S}}_{\boldsymbol{\beta}}^{-1} \boldsymbol{H}_{t}^{\top} \boldsymbol{\beta}_{t}^{\top} \mathbb{M}_{1_{N}}\left(T^{-1} \sum_{s=1}^{T} D_{s t} \boldsymbol{v}_{s} K_{h, s t}\right)\right\|_{F}^{2}=\mathcal{O}_{p}\left(\frac{h}{T}\right) ;$

\subsection*{Proof of Theorem 2}

Proof.
$$
\begin{align*}
\widehat{\alpha}_{t, i}-\boldsymbol{\alpha}_{t, i} & =\overline{\boldsymbol{u}}_{t, i}+\left(\frac{1}{T} \sum_{s=1}^{T} \boldsymbol{\beta}_{s, i} \boldsymbol{v}_{s} K_{h, s t}-\boldsymbol{\beta}_{t, i} \overline{\boldsymbol{v}}_{t}\right)+\left(\overline{\boldsymbol{\alpha}}_{t, i}-\boldsymbol{\alpha}_{t, i}\right)-\frac{1}{N} \boldsymbol{\beta}_{t, i} \boldsymbol{H}_{t} \widehat{\boldsymbol{S}}_{\boldsymbol{\beta}}^{-1} \boldsymbol{H}_{t}^{\top} \boldsymbol{\beta}_{t} \mathbb{M}_{1_{N}} \overline{\boldsymbol{\alpha}}_{t} \\
& -\frac{1}{N} \boldsymbol{\beta}_{t, i} \boldsymbol{H}_{t} \widehat{\boldsymbol{S}}_{\boldsymbol{\beta}}^{1} \boldsymbol{H}_{t}^{\top} \boldsymbol{\beta}_{t}^{\top} \mathbb{M}_{1_{N}}\left(T^{-1} \sum_{s=1}^{T} D_{s t} \boldsymbol{v}_{s} K_{h, s t}\right)-\sum_{j=1}^{11}\left(\mathrm{I}_{\mathrm{j}}\right)_{\mathrm{i}} \widehat{\boldsymbol{\beta}}_{\mathrm{t}} \widehat{\boldsymbol{V}}_{\mathrm{t}}^{-1} \widehat{\lambda}_{\mathrm{t}}+\mathcal{O}_{\mathrm{p}}\left(\frac{1}{\mathrm{~N}}+\frac{1}{\mathrm{Th}}+\mathrm{h}^{2}\right) \\
& \triangleq \sum_{j=1}^{16} \mathrm{II}_{\mathrm{j}}, \tag{15}
\end{align*}
$$
where $\left(\mathrm{I}_{\mathrm{j}}\right)_{i}$ denotes the $i$ th row of $\mathrm{I}_{\mathrm{j}}$. By Lemma 2 below, we have
$$
\begin{aligned}
\sqrt{T h}\left(\widehat{\alpha}_{t, i}-\alpha_{t, i}\right) & =\frac{1}{\sqrt{T h}} \sum_{s=1}^{T} K\left(\frac{s-t}{T h}\right) \boldsymbol{u}_{s, i}\left(1-\boldsymbol{v}_{s}^{\top} \Sigma_{f}^{-1} \lambda_{s}\right)+\mathrm{o}_{\mathrm{p}}(1) \\
& \xrightarrow{\mathcal{D}} \mathcal{N}\left(\mathbf{0}, v_{0} \Sigma_{\alpha_{t, i}}\right)
\end{aligned}
$$
by Lemma 2 and continuous mapping theorem. Note that Here $v_{0} \Sigma_{\alpha_{t, i}}$ is defined in Theorem 2.

Lemma 2. Under Assumption A.1-A.6, we have for any $1 \leq t \leq T$,
(a) $\mathrm{II}_{2}=\mathcal{O}_{\mathrm{p}}\left(\frac{\mathrm{h}}{\mathrm{T}}\right)$;
(b) $\mathrm{II}_{3}=\mathcal{O}_{\mathrm{p}}\left(\mathrm{h}^{2}\right)$;
(c) $\mathrm{II}_{4}=\mathcal{O}_{\mathrm{p}}\left(\frac{1}{\sqrt{\mathrm{~N}}}\right)$;
(d) $\mathrm{II}_{5}=\mathcal{O}_{\mathrm{p}}\left(\frac{\mathrm{h}}{\mathrm{T}}\right)$;
(e) $\mathrm{II}_{6}=\mathcal{O}_{\mathrm{p}}\left(\frac{1}{\mathrm{Th}}\right)$;
(f) $\left\|\mathrm{II}_{7}-\frac{1}{\mathrm{~T}} \sum_{\mathrm{s}=1}^{\mathrm{T}} \mathrm{K}_{\mathrm{h}, \mathrm{st}} \boldsymbol{u}_{\mathrm{s}, \mathrm{i}} \boldsymbol{v}_{\mathrm{s}}^{\top} \Sigma_{\mathrm{f}}^{-1} \boldsymbol{\lambda}_{\mathrm{s}}\right\|=\mathcal{O}_{p}\left(\frac{1}{\mathrm{Th}}\right)$;
(g) $\mathrm{II}_{8}=\mathcal{O}_{\mathrm{p}}\left(\frac{1}{\mathrm{Th}}\right)$;
(h) $\mathrm{II}_{\mathrm{j}}=\mathcal{O}_{\mathrm{p}}\left(\mathrm{h}^{2}\right), \mathrm{j}=9,10,11$;
(i) $\mathrm{II}_{1} 2=\mathcal{O}_{\mathrm{p}}\left(\mathrm{h}^{2}\right)+\mathcal{O}_{\mathrm{p}}\left(\frac{1}{\mathrm{Th}}\right)$;
(j) $I_{j}=\mathcal{O}_{\mathrm{p}}\left(\frac{\mathrm{h}^{2}}{\mathrm{Th}}\right), \mathrm{j}=13,14$;
(k) $\mathrm{II}_{\mathrm{j}}=\mathrm{o}_{\mathrm{p}}\left(\mathrm{h}^{2}\right), \mathrm{j}=15,16$.

\subsection*{Proof of Theorem 3}

Proof. Let $\Gamma_{i}=\frac{1}{T} \sum_{t=1}^{T} \frac{\widehat{\phi}_{i, t}}{\widehat{\phi}_{i+1, t}}$, where $\widehat{\phi}_{i, t}$ is the $i t h$ largest eigenvalue of $\widehat{\Sigma}_{t}$. By Lemma 3 below, we have $\Gamma_{i}=\mathcal{O}_{p}(1)$ uniformly for $i=1, \cdots, r-1$. We also have $\Gamma_{i}=\mathcal{O}_{p}(1)$, uniformly for $i=r+1, \cdots, p-1$ and $\Gamma_{r} \rightarrow \infty$ by Lemma 4. Then
$$
\begin{aligned}
& \mathbb{P}(\widehat{r} \leq r)=\mathbb{P}\left(\Gamma_{r}>\max \left(\Gamma_{r+1}, \Gamma_{r+2}, \cdots, \Gamma_{r \max }\right)\right) \rightarrow 1 \\
& \mathbb{P}(\widehat{r} \geq r)=\mathbb{P}\left(\Gamma_{r}>\max \left(\Gamma_{1}, \Gamma_{2}, \cdots, \Gamma_{r-1}\right)\right) \rightarrow 1
\end{aligned}
$$

Therefore, we have $\mathbb{P}(\widehat{r}=r) \rightarrow 1$.

Lemma 3. For $j=1, \cdots, r-1$,
$$
\frac{1}{T} \sum_{t=1}^{T} \frac{\widehat{\phi}_{j, t}}{\widehat{\phi}_{j+1, t}}=\mathcal{O}_{p}(1)
$$

Lemma 4. , For $j=r, \cdots, p-1$,
$$
c+\mathrm{o}_{\mathrm{p}}(1) \leq \min (\sqrt{q T h}, p) \widehat{\phi}_{j, t} \leq C+\mathrm{o}_{\mathrm{p}}(1)
$$
where $c, C$, and $o_{p}(1)$ are uniform in $r \leq j \leq p-1$ and $1 \leq t \leq T$.
