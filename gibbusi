\title{Chapter 9: Portfolio Management: The Basics}

\section*{Overview}

**Questions**
1. What are the basic single-period portfolio optimization formulations? How do we interpret the results?
2. What can go wrong?
3. How do we incorporate prior information in portfolio optimization?

This chapter is devoted to the basics of portfolio construction. The common theme throughout the chapter is that we limit ourselves to a single-period optimization setting. This a chapter for hedgehogs, not for foxes: we set a narrow playing field, but dig a deep hole. The chapter requires knowledge of basic results from optimization theory ${ }^{1}$.

\footnotetext{
${ }^{1}$ Extensive treatments of convex optimization are Boyd and Vandenberghe [2004], Luenberger and Ye [2008] and Bazaraa et al. [2006], and finance-oriented optimization textbooks are CornuÃ©jols et al. [2018], Palomar [2024].
}

\section*{9.1. Why Mean-Variance Optimization?}

Investors have objectives, information, and constraints. Besides this generic statement, there is not much in common among them. A large fraction of investment professionals cannot-and would not-articulate a clear objective function; their constraints are sometimes ad hoc, vague, or inconsistently enforced. Neither George Soros nor Warren Buffett, nor others among the most successful investors in history, have ever known what the volatility of their portfolios was at any point in time. At the other extreme, academics have developed several normative theories for portfolio construction. In this book I am trying to use relevance to applications as a guiding principle. In the vast majority of applications, the optimization formulations are single-period. This is explainable by a combination of the following ${ }^{2}$ :
- Interpretability. Multi-period optimization problems are vastly more complex to formulate and, once solved, their solutions are also harder to interpret.
- Data availability. The amount of data needed for multi-period optimization is larger and more difficult to estimate.
- Computational tractability. Single-period optimization problems are solvable by commercial solvers in a matter of seconds.
- Short-term investment horizon. Investors think only about the short term, partly because they heavily discount the future, partly because they do not know how to quantify information uncertainty and rate of change.
- Lack of standard theoretical results. Few strong results are available characterizing the formulations and the improvement in performance.

\footnotetext{
${ }^{2}$ On justifications of the mean-variance approach to portfolio optimization, see Cochrane [2005], Huang and Litzenberger [1988]. Both cover the standard cases of exponential and quadratic utilities. A number of textbooks exist covering portfolio construction. A classic is Grinold and Kahn [1999]; see also Chincarini and Kim [2022], Qian et al. [2007], Isichenko [2021]. On the statistics of the Sharpe Ratio, see Lo [2002] and, for a comprehensive and definitive reference, Pav [2023] and references therein.
}

The objective function $V$ is a function of the portfolio weights $\mathbf{w}$ and of the returns $\mathbf{r}$. Economic theory interprets $V$ as a utility function, taking different values under different realizations of the future. The expected value of the utility function gives the investor the ex ante value of the bet she would be taking by investing in a portfolio. We assume that the investor has initial wealth $W_{0}$, that she knows the distribution of the random vector $\mathbf{r}$, and that she solves the problem
$$
\begin{equation*}
\max E\left[V\left(W_{0}+\mathbf{w}^{\boldsymbol{\top}} \mathbf{r}\right)\right] \tag{9.1}
\end{equation*}
$$

The choice of $V$ is not obvious. Common properties of $V$ are that it must be monotonically increasing (more wealth is better than less) and concave (corresponding to risk aversion, and decreasing value of a marginal dollar as a function of wealth). One approach, followed by Markowitz [1959], is to consider a polynomial local approximation of the objective function: $V\left(W_{0}+\mathbf{w}^{\top} \mathbf{r}\right) \simeq$ $V\left(W_{0}\right)+V^{\prime}\left(W_{0}\right) \mathbf{w}^{\top} \mathbf{r}+V^{\prime \prime}\left(W_{0}\right)\left(\mathbf{w}^{\top} \mathbf{r}\right)^{2} / 2$. Taking expectations, we obtain
$$
\begin{aligned}
E\left[V\left(W_{0}+\mathbf{w}^{\top} \mathbf{r}\right)\right] \simeq & \simeq\left(W_{0}\right)+V^{\prime}\left(W_{0}\right) \mathbf{w}^{\top} \boldsymbol{\mu}_{\mathbf{r}}+ \\
& \frac{V^{\prime \prime}\left(W_{0}\right)}{2}\left(\mathbf{w}^{\top} \boldsymbol{\Omega}_{\mathbf{r}} \mathbf{w}+\left(\mathbf{w}^{\top} \boldsymbol{\mu}_{\mathbf{r}}\right)^{2}\right) \\
\simeq & V\left(W_{0}\right)+V^{\prime}\left(W_{0}\right) \mathbf{w}^{\top} \boldsymbol{\mu}_{\mathbf{r}}+ \\
& \frac{V^{\prime \prime}\left(W_{0}\right)}{2} \mathbf{w}^{\top} \boldsymbol{\Omega}_{\mathbf{r}} \mathbf{w}
\end{aligned}
$$

We maximize a concave quadratic objective function which is the weighted sum of expected return and variance; hence the name Mean-Variance Optimization
(MVO) [De Finetti, 1940, Markowitz, 1952]:
$$
\begin{aligned}
\frac{E\left[V\left(W_{0}+\mathbf{w}^{\top} \mathbf{r}\right)\right]-V\left(W_{0}\right)}{V^{\prime}\left(W_{0}\right)} & \simeq \mathbf{w}^{\top} \boldsymbol{\mu}_{\mathbf{r}}-\frac{\rho}{2} \mathbf{w}^{\top} \boldsymbol{\Omega}_{\mathbf{r}} \mathbf{w} \\
\rho & :=-\frac{V^{\prime \prime}\left(W_{0}\right)}{V^{\prime}\left(W_{0}\right)}
\end{aligned}
$$
$\rho>0$ is called the coefficient of absolute risk aversion (CARA). The higher the $\rho$, the more risk-averse the investor is.

As examples, consider an objective function of the form $V(x)=-\exp (-a x)$. The CARA for this function is constant $\rho=a$ : it is independent of the wealth $W_{0}$ of the investor, and so are her allocation decisions. The optimization problem is
$$
\max _{\mathbf{w}} \mathbf{w}^{\top} \boldsymbol{\mu}_{\mathbf{r}}-\frac{a}{2} \mathbf{w}^{\top} \boldsymbol{\Omega}_{\mathbf{r}} \mathbf{w}
$$

Alternatively, consider the objective function $V(x)=\log (x)$. This function is associated to the Kelly criterion for investing. It has unique properties which warrant a dedicated chapter. Here, let us consider its implications for approximate portfolio optimization. The CARA is $\rho=1 / W_{0}$, so that we solve
$$
\max _{\mathbf{w}} \mathbf{w}^{\top} \boldsymbol{\mu}_{\mathbf{r}}-\frac{1}{2 W_{0}} \mathbf{w}^{\top} \boldsymbol{\Omega}_{\mathbf{r}} \mathbf{w}
$$

The wealthier the investor is, the more risk-seeking she becomes.
We have shown that a quadratic utility function implies a mean-variance optimization problem for the investor. This result is standard. Less known is the converse: if an investor selects an investment on the basis of mean and variance only, her utility function is necessarily quadratic [Baron, 1977, Johnstone and Lindley, 2011]. Viewed in the context of axiomatic decision theory,
portfolio mean-variance optimization is not satisfactory, because a quadratic utility implies that investors are satiated, and have even a dislike of wealth beyond a certain threshold. As a local approximation, however, mean-variance optimization is appropriate. Moments of returns (and portfolios) beyond the second one are beyond the realm of what's possible, as seen in Chapter 2. A portfolio manager settled a long discussion on the topic with the laconic statement that "the first two moments should be enough for everybody".

\section*{9.2. Mean-Variance Optimal Portfolios}

A factor model gives us an asset-asset covariance matrix $\boldsymbol{\Omega}_{\mathrm{r}} \in \mathbb{R}^{n \times n}$. Given this information, it is straightforward to compute the variance of a portfolio, as we saw in Section 4.5.2 on risk decomposition. The other essential input to the optimization problem is a vector $\boldsymbol{\alpha} \in \mathbb{R}^{n}$ of expected returns, over the same interval at which we have a volatility forecast. The simplest optimization problem is to maximize expected PnL, subject to a constraint on the maximum tolerable volatility, denoted by $\sigma>0$. The problem can be stated as
$$
\begin{align*}
& \max \boldsymbol{\alpha}^{\top} \mathbf{w}  \tag{9.2}\\
& \text { s.t. } \mathbf{w}^{\top} \boldsymbol{\Omega}_{\mathbf{r}} \mathbf{w} \leq \sigma^{2}
\end{align*}
$$

One of the most important metrics used for the evaluation of strategies is the Sharpe Ratio, which we covered in previous chapters. If we have covariance matrix and expected returns, we can formulate the Sharpe Ratio optimization
thus:
$$
\max _{\mathbf{w}} \frac{\boldsymbol{\alpha}^{\top} \mathbf{w}}{\sqrt{\mathbf{w}^{\top} \boldsymbol{\Omega}_{\mathrm{r}} \mathbf{w}}}
$$

This optimization, however, is indefinite because the objective function $\operatorname{SR}(\mathbf{w})$ is independent of the portfolio size, i.e., homogeneous of degree $0: \operatorname{SR}(t \mathbf{w})=\operatorname{SR}(\mathbf{w})$ for all $t>0$. We can address this issue by bounding the denominator. This means fixing the portfolio size. The upper bound constraint on the denominator is always binding if there is a portfolio $\mathbf{w}$ such that $\boldsymbol{\alpha}^{\top} \mathbf{w}>0$ :
$$
\begin{array}{r}
\max _{\mathbf{w}} \frac{\boldsymbol{\alpha}^{\top} \mathbf{w}}{\sqrt{\mathbf{w}^{\top} \boldsymbol{\Omega}_{\mathbf{r}} \mathbf{w}}} \\
\text { s.t. } \sqrt{\mathbf{w}^{\top} \boldsymbol{\Omega}_{\mathbf{r}} \mathbf{w}} \leq \sigma \\
\text { equivalent to } \max _{\mathbf{w}} \frac{\boldsymbol{\alpha}^{\top} \mathbf{w}}{\sigma} \\
\text { s.t. } \mathbf{w}^{\top} \boldsymbol{\Omega}_{\mathbf{r}} \mathbf{w} \leq \sigma^{2} \\
\text { equivalent to } \max _{\mathbf{w}} \boldsymbol{\alpha}^{\top} \mathbf{w} \\
\text { s.t. } \mathbf{w}^{\top} \boldsymbol{\Omega}_{\mathbf{r}} \mathbf{w} \leq \sigma^{2}
\end{array}
$$

Which is optimization problem (9.2). The First-Order Necessary Conditions (FONC) for this problem are:
$$
\begin{aligned}
\nabla_{\mathbf{w}}\left(\boldsymbol{\alpha}^{\top} \mathbf{w}-\lambda \mathbf{w}^{\top} \boldsymbol{\Omega}_{\mathbf{r}} \mathbf{w}\right) & =\boldsymbol{\alpha}-2 \lambda \boldsymbol{\Omega}_{\mathbf{r}} \mathbf{w} \\
& =0 \\
\mathbf{w}^{\top} \boldsymbol{\Omega}_{\mathbf{r}} \mathbf{w} & \leq \sigma^{2} \\
\lambda & \geq 0 \\
\lambda\left(\mathbf{w}^{\top} \boldsymbol{\Omega}_{\mathbf{r}} \mathbf{w}-\sigma^{2}\right) & =0
\end{aligned}
$$

The solution to these equations is
$$
\begin{align*}
\mathbf{w}^{\star} & =\frac{\sigma}{\sqrt{\boldsymbol{\alpha}^{\top} \boldsymbol{\Omega}_{\mathbf{r}}^{-1} \boldsymbol{\alpha}}} \boldsymbol{\Omega}_{\mathbf{r}}^{-1} \boldsymbol{\alpha}  \tag{9.3}\\
\lambda^{\star} & =\frac{\sqrt{\boldsymbol{\alpha}^{\top} \boldsymbol{\Omega}_{\mathbf{r}}^{-1} \boldsymbol{\alpha}}}{2 \sigma} \tag{9.4}
\end{align*}
$$

The expected return and the Sharpe Ratio of the portfolio are
$$
\begin{align*}
E\left(\mathbf{r}^{\top} \mathbf{w}^{\star}\right) & =\sigma \sqrt{\boldsymbol{\alpha}^{\top} \boldsymbol{\Omega}_{\mathbf{r}}^{-1} \boldsymbol{\alpha}} \\
\mathrm{SR}^{\star} & =\sqrt{\boldsymbol{\alpha}^{\top} \boldsymbol{\Omega}_{\mathbf{r}}^{-1} \boldsymbol{\alpha}} \tag{9.5}
\end{align*}
$$

A way to interpret (and derive quickly) the solution is to recall that the optimal portfolio is proportional to $\boldsymbol{\Omega}_{\mathbf{r}}^{-1} \boldsymbol{\alpha}$, and then to find the proportionality factor so that the variance constraint is met. The optimal portfolio is proportional to the volatility budget: the higher the budget, the bigger the portfolio. However, the portfolio is independent of the magnitude of the alpha vector (it is homogeneous of degree zero in alpha): replacing $\boldsymbol{\alpha}$ with $\kappa \boldsymbol{\alpha}$ gives the same solution. This
is interesting. The parameter $\lambda^{\star}$ also merits special consideration. It is the shadow price (or Lagrange multiplier) of the volatility constraint. If we increase the variance budget by one unit, the expected return increases by $\lambda^{\star}$. In other terms, the shadow price of the variance constraint is the derivative of the objective function with respect to the variance. While this relationship is not very useful in this specific case, it will come in handy for other constraints.

In its simplicity, the solution contains the essential data of the problem: the inverse of the covariance matrix (also called the precision matrix) and the vector of expected return. In the next few pages I would like to interpret, eviscerate, extend this simple formula; and finally, as you start believing it is useful, to caution you against its use. Like all the good things in life, mean-variance optimization is at its most pleasant when it is accompanied by precautionary measures.
[WILEY EDITORS: place Box (proc/faq/insight) 9.2 around here.]
First of all, we can derive the same solution when we solve an unconstrained problem:
$$
\begin{align*}
& \max \boldsymbol{\alpha}^{\top} \mathbf{w}-\lambda \mathbf{w}^{\top} \boldsymbol{\Omega}_{\mathbf{r}} \mathbf{w}  \tag{9.8}\\
& \text { s.t. } \mathbf{w} \in \mathbb{R}^{n} \tag{9.9}
\end{align*}
$$


We have added the constraint to the objective function in the form of a penalty term; the informal term for this operation is pricing out the constraint. The objective function is concave, and the solution is given by
$$
\mathbf{w}^{\star}=\frac{1}{2 \lambda} \boldsymbol{\Omega}_{\mathbf{r}}^{-1} \boldsymbol{\alpha}
$$
which gives the same solution as the vol-constrained problem when
$$
\lambda=\frac{\sqrt{\boldsymbol{\alpha}^{\top} \boldsymbol{\Omega}_{\mathbf{r}}^{-1} \boldsymbol{\alpha}}}{2 \sigma}
$$

The larger the volatility budget, the smaller the penalty coefficient.
Notice that this penalty value is the same as the shadow price in the previous formulation. This is not a coincidence. We obtain the same solution when we price out the constraint and we give the variance a unit price equal to the shadow price of that constraint.

A third equivalent formulation is the one where we minimize volatility, subject to a return constraint:
$$
\begin{align*}
& \min \mathbf{w}^{\top} \boldsymbol{\Omega}_{\mathbf{r}} \mathbf{w}  \tag{9.10}\\
& \text { s.t. } \boldsymbol{\alpha}^{\top} \mathbf{w} \geq \mu \tag{9.11}
\end{align*}
$$

The solution is
$$
\mathrm{w}^{\star}=\frac{\mu}{\boldsymbol{\alpha}^{\top} \boldsymbol{\Omega}_{\mathbf{r}}^{-1} \boldsymbol{\alpha}} \boldsymbol{\Omega}_{\mathbf{r}}^{-1} \boldsymbol{\alpha}
$$
[WILEY EDITORS: place Box (proc/faq/insight) 9.3 around here.]



\subsection*{Insight 9.1: Miscalibration of alpha size is not catastrophic}

If you have a volatility constraint, a good volatility model, and your relative alphas are accurate then the error in the absolute size of the alphas does not matter.

\subsection*{Insight 9.2: MVO from asset Sharpes and correlations}
There is yet another formulation that is equivalent to the previous ones. Oftentimes, we think of portfolio positions not in terms on net market value, but of volatility. We do not invest $\$ 10 \mathrm{M}$ in AAPL. The annualized volatility of AAPL is $20 \%$, and therefore we have a $\$ 2 \mathrm{M}$ volatility position in the stock. This conveys the position size in terms of its range of dollar movement over the course of a year. Now, we can express the Sharpe-Optimal portfolio in terms of volatility in the following way. Let the stock volatilities be $\sigma_{1}, \ldots, \sigma_{n}$, and define $\mathbf{V}$ a diagonal matrix with these volatilities on the main diagonal. Denote the asset correlation matrix with $\mathbf{C}$. The covariance matrix is $\boldsymbol{\Omega}_{\mathrm{r}}=\mathbf{V C V}$. Now let's rewrite the solution to the MVO problem:
$$
\begin{align*}
\mathbf{w}^{\star} & =\frac{1}{2 \lambda}(\mathbf{V C V})^{-1} \boldsymbol{\alpha} \\
\mathbf{V w}^{\star} & =\frac{1}{2 \lambda} \mathbf{C}^{-1}\left(\mathbf{V}^{-1} \boldsymbol{\alpha}\right) \\
\mathbf{v}^{\star} & =\frac{1}{2 \lambda} \mathbf{C}^{-1} \mathbf{s}  \tag{9.6}\\
\mathrm{SR}^{\star} & =\sqrt{\mathbf{s}^{\top} \mathbf{C}^{-1} \mathbf{s}} \tag{9.7}
\end{align*}
$$

In the formula above, $\mathbf{v}^{\star}:=\mathbf{V w}^{\star}$ is the vector of optimal dollar volatilities, and $\mathbf{s}$ is the vector of asset-level Sharpe Ratios. Therefore, the optimal dollar volatilities are proportional to the Sharpe Ratios, multiplied by the inverse of the correlation matrix. This is interesting, because dollar volatilities, correlations, and asset Sharpe Ratios are more intuitive quantities than covariances and returns.


\subsection*{Insight 9.3: Asset correlations, dispersion, and limits to performance}
1. From Equation 9.6 when assets are uncorrelated, the optimal dollar vol allocation is proportional to the asset Sharpe Ratios and the optimal Sharpe Ratio is the length of the vector $\left(s_{1}, \ldots, s_{n}\right)$, which is not linear in the single-asset Sharpe Ratios; Sharpe Ratios squared is what matters.
2. Say that the assets have a pairwise correlation of $\rho \neq 0$. Then ${ }^{a}$ the optimal volatility allocated to asset $i$, in the many-asset case $|\rho n| \gg 0$, is proportional to the excess Sharpe Ratio of the asset, compared to the average Sharpe Ratio:
$$
v_{i} \propto s_{i}-E(\mathbf{s})
$$
where we define $E(\mathbf{s}):=\frac{1}{n} \sum_{i} s_{i}$. The optimal Sharpe Ratio is
$$
\mathrm{SR}^{\star}=\sqrt{\frac{n}{1-\rho} \operatorname{var}(\mathbf{s})+\frac{n}{1+(n-1) \rho} E^{2}(\mathbf{s})}
$$
with $\operatorname{var}(\mathbf{s}):=E\left(\mathbf{s}^{2}\right)-E^{2}(\mathbf{s})$. If all assets have the same Sharpe Ratio $s$, then
$$
\mathrm{SR}^{\star}=\sqrt{\frac{n s^{2}}{1+(n-1) \rho}}
$$

Finally, in the many-asset limit, we have $\mathrm{SR}^{\star}=s / \sqrt{\rho}$.
Summing up the results above:
- If there is no dispersion in Sharpe Ratios, then the Sharpe Ratio approaches an upper bound $s / \sqrt{\rho}$.
- However, if there is dispersion in Sharpe Ratios, then the Sharpe Ratio is still proportional to $\sqrt{n}$ and to the dispersion, measured as the cross-sectional standard deviation of the assets' Sharpe Ratios.
${ }^{a}$ To prove this, verify directly that the inverse of the correlation matrix is
$$
\mathbf{C}^{-1}=\frac{1}{1-\rho}\left(\mathbf{I}_{n}-\frac{\rho}{1+(n-1) \rho} \mathbf{e}^{\top}\right)
$$


\subsection*{Insight 9.4: $\star$ Reading the entries of the precision matrix}

Is there a way to interpret further the relationship $\mathbf{w}^{\star} \propto \boldsymbol{\Omega}_{\mathbf{r}}^{-1} \boldsymbol{\alpha}$ ? The optimal position of asset $i$ is a weighted sum of alphas. The $\left[\Omega_{\mathbf{r}}^{-1}\right]_{i, j}$ are proportional to minus the partial correlations of the returns of $i$ and $j$ after controlling for the other asset returns. The interpretation of partial correlation is that it captures collinearity between two random variables, after removing the collinearity of these variables with a set of controlling variables. In practice, one follows this procedure: 1. regress the returns of asset $i$ and $j$ on the returns of the other assets; 2 . compute the correlation between the residuals from the two regressions, which we denote $\rho_{i, j}$. The formula for the optimal portfolio is
$$
w_{i} \propto\left[\Omega_{\mathbf{r}}^{-1}\right]_{i, i}\left(\alpha_{i}-\sum_{j \neq i} \rho_{i, j}\left[\Omega_{\mathbf{r}}^{-1}\right]_{j, j} \alpha_{j}\right)
$$

The diagonal terms of the precision matrix are always positive. The interpretation of this rather convoluted formula is that, whenever the returns of two assets are positively correlated after removing the joint effect of correlations with other variables, the size of the portfolio is reduced, because the collinearity makes the alpha common to both asset $i$ and $j$.

\section*{9.3. Trading in Factor Space}

\subsection*{9.3.1. Factor-Mimicking Portfolios}

We have a factor model, and we estimate the expected factor returns $\boldsymbol{\lambda}$. Say that we want to generate a portfolio which has the closest possible return to one of the factors. For example, we want to generate a "momentum factor" portfolio. What would it be? The returns of the factor-mimicking portfolio (FMP) should be as close as possible to those of the factor: the variance of the difference of the two returns should be minimized. A portfolio $\mathbf{w}$ has an associated factor exposure $\mathbf{b}$. Its returns are $\mathbf{r}^{\top} \mathbf{w}=\mathbf{b}^{\top} \mathbf{f}+\mathbf{w}^{\boldsymbol{\top}} \boldsymbol{\epsilon}$. The tracking variance ${ }^{3}$ between $f_{i}$ and $\mathbf{r}^{\boldsymbol{\top}} \mathbf{w}$ is $E\left[\left(\left(b_{i}-1\right) f_{i}+\sum_{j \neq i} b_{j} f_{j}+\mathbf{w}^{\boldsymbol{\top}} \boldsymbol{\epsilon}\right)^{2}\right]$. This is minimized when $b_{i}-1=0, b_{j}=0$ for $j \neq i$, and the portfolio's idio variance is minimized. The optimization formulation is
$$
\begin{aligned}
& \min \mathbf{w}^{\top} \boldsymbol{\Omega}_{\epsilon} \mathbf{w} \\
& \text { s.t. } \mathbf{B}^{\top} \mathbf{w}=\mathbf{e}_{i}
\end{aligned}
$$

\footnotetext{
${ }^{3}$ We ignore the term $\boldsymbol{\alpha}_{\perp}$, both out of simplicity and because it is very small.
}

The solution is $\mathbf{v}_{i}=\boldsymbol{\Omega}_{\epsilon}^{-1} \mathbf{B}\left(\mathbf{B}^{\top} \boldsymbol{\Omega}_{\epsilon}^{-1} \mathbf{B}\right)^{-1} \mathbf{e}_{i}$. The matrix whose column vectors are the factor-mimicking portfolios is ( $\mathbf{P}$ is for "portfolios")
$$
\begin{align*}
\mathbf{P} & :=\left[\begin{array}{cccc}
\mid & \mid & \ldots & \mid \\
\mathbf{v}_{1} & \mathbf{v}_{2} & \ldots & \mathbf{v}_{m} \\
\mid & \mid & \ldots & \mid
\end{array}\right]  \tag{9.12}\\
& =\boldsymbol{\Omega}_{\epsilon}^{-1} \mathbf{B}\left(\mathbf{B}^{\top} \boldsymbol{\Omega}_{\epsilon}^{-1} \mathbf{B}\right)^{-1}\left[\begin{array}{cccc}
\mid & \mid & \ldots & \mid \\
\mathbf{e}_{1} & \mathbf{e}_{2} & \ldots & \mathbf{e}_{m} \\
\mid & \mid & \ldots & \mid
\end{array}\right] \\
& =\boldsymbol{\Omega}_{\epsilon}^{-1} \mathbf{B}\left(\mathbf{B}^{\top} \boldsymbol{\Omega}_{\epsilon}^{-1} \mathbf{B}\right)^{-1}
\end{align*}
$$

We now have factor portfolios as tradable instruments. The expected return of a factor portfolio is $\left(\boldsymbol{\alpha}_{\perp}^{\top}+\boldsymbol{\lambda}^{\top} \mathbf{B}^{\boldsymbol{\top}}\right) \mathbf{v}_{i}=\lambda_{i}$. In practice, we:
1. generate the FMPs compositions over time;
2. compute their per-period PnL;
3. compute their empirical average PnL ;
4. apply modifications to the expected PnL, such as penalties ${ }^{4}$;
5. optimize in factor space.

\footnotetext{
${ }^{4}$ The subject will be covered in Section 10.2.3.
}

We now prove that FMPs emerge naturally from certain assumptions about returns and FMP composition. In the Appendix (Theorem 9.1), we prove that if alpha spanned is zero and if the idiosyncratic variance of the factor-mimicking portfolios is small, then the mean-variance optimization problem reduces to one in which we only trade FMPs. First, we solve the low-dimensional optimization problem
$$
\begin{aligned}
& \max \boldsymbol{\lambda}^{\top} \mathbf{u}-\frac{1}{2 \gamma} \mathbf{u}^{\top} \boldsymbol{\Omega}_{\mathrm{f}} \mathbf{u} \\
& \text { s.t. } \mathbf{u} \in \mathbb{R}^{m}
\end{aligned}
$$

Say that the solution is $\mathbf{u}^{\star}$. The optimal portfolio is the weighted sum of the FMPs $\mathbf{w}^{\star}=\mathbf{P} \mathbf{u}^{\star}$. A few remarks on the appeal and limitations of the previous result:
- In factor space, the dimensionality of the problem collapses, but we still have an MVO problem, which is usually more interpretable. The possible drawbacks of mean-variance optimization still hold, but so do the possible remedies, which we present in Chapter 10.
- Factor-mimicking portfolios make their appearance as the necessary synthetic instruments for trading in factor space. In synthesis, if you perform mean-variance optimization and factors are sufficiently "pure" (having low idiosyncratic risk), then you necessarily trade FMPs. It is an economical, beautiful result.
- Keep in mind that FMPs are associated to the loadings matrix B, and that there are many loadings matrices resulting in equivalent factor models (see Section 4.4.1). Think of FMPs as a vector basis in a finite-dimensional subspace. There are infinitely many such bases, and they don't need to be orthogonal. The subspace, however, is uniquely identified.
- The assumption of small factor idiosyncratic variance can be expressed as $\left\|\left(\mathbf{B}^{\top} \boldsymbol{\Omega}_{\epsilon}^{-1} \mathbf{B}\right)^{-1}\right\| \ll 1$. The matrix inside the norm appears repeatedly in this book - in an ideal world, we would like it to be small, in the real world, it is not. The ideal-world solution works well as a sketch of the real world. It tells
us the broad shape of the portfolio. When trading, we should include the idiosyncratic variance of the portfolio and not solve for the limit case.
- In conjunction with the previous point, we have also ignored execution costs. They should not be ignored in applications. Chapter 11 is devoted to the subject.

\subsection*{9.3.2. Adding, Estimating, and Trading a New Factor}

Let us consider a simple example, and let us work through the individual steps. In a way, all the steps are implicitly contained in the theory developed so far. The starting point is a factor model with $m$ factors, with parameters $\mathbf{B}, \boldsymbol{\Omega}_{\mathbf{f}}, \boldsymbol{\Omega}_{\boldsymbol{\epsilon}}$. We assume that they are constant through time for notational simplicity; extending the example to time-varying parameters is straighforward. The factors have expected returns $\boldsymbol{\lambda}$. We are exploring a new asset characteristic vector $\mathbf{a} \in \mathbb{R}^{n}$. We can add the new factor to the existing model without reestimating the entire model by pushing out the model.
1. Orthogonalization. First we orthogonalize the new factor to the existing factors. The orthogonalized factor is given by standard linear regression formulas ${ }^{5}$
$$
\mathbf{b}_{m+1}=\left(\mathbf{I}_{n}-\mathbf{B}\left(\mathbf{B}^{\top} \boldsymbol{\Omega}_{\epsilon}^{-1} \mathbf{B}\right)^{-1} \mathbf{B}^{\top} \boldsymbol{\Omega}_{\epsilon}^{-1}\right) \mathbf{a}
$$
2. Estimation. Next, we regress in every period the residual returns from the existing model against the orthogonalized factor by using Frisch-Waugh-Lovell theorem ${ }^{6}$ :
$$
\begin{align*}
\boldsymbol{\epsilon}_{t} & =\mathbf{b}_{m+1} \hat{f}_{m+1, t}+\hat{\boldsymbol{\epsilon}}_{t}  \tag{9.13}\\
\Rightarrow \hat{f}_{m+1, t} & :=\frac{\mathbf{b}_{m+1}^{\top} \boldsymbol{\Omega}_{\epsilon}^{-1} \boldsymbol{\epsilon}_{t}}{\mathbf{b}_{m+1}^{\top} \boldsymbol{\Omega}_{\epsilon}^{-1} \mathbf{b}_{m+1}}  \tag{9.14}\\
\hat{\lambda}_{m+1} & :=\frac{1}{T} \sum_{t} \hat{f}_{m+1, t}  \tag{9.15}\\
\hat{\sigma}_{m+1} & :=\left(\frac{1}{T} \sum_{t} \hat{f}_{m+1, t}^{2}\right)  \tag{9.16}\\
\widehat{\mathrm{SR}} & =\frac{\hat{\lambda}_{m+1}}{\hat{\sigma}_{m+1}} \tag{9.17}
\end{align*}
$$

\footnotetext{
${ }^{5}$ See Section 4.7.1.
}

\footnotetext{
${ }^{6}$ See Section 4.7.3.
}

In the Appendix (Theorem 9.2), we show that the approximate variance of the new factor is $\hat{\sigma}_{m+1}^{2}=\left(\mathbf{b}_{m+1}^{\top} \boldsymbol{\Omega}_{\epsilon}^{-1} \mathbf{b}_{m+1}\right)^{-1}$.
3. Risk updating. We show in Section 9.7.4 that the approximate factor covariance matrix including the new factor is given by
$$
\tilde{\boldsymbol{\Omega}}_{\mathbf{f}} \simeq\left[\begin{array}{cc}
\boldsymbol{\Omega}_{\mathbf{f}} & \mathbf{0} \\
\mathbf{0} & \left(\mathbf{b}_{m+1}^{\top} \boldsymbol{\Omega}_{\epsilon}^{-1} \mathbf{b}_{m+1}\right)^{-1}
\end{array}\right]
$$

This result holds only for constant parameters and well-diversified factor portfolios. For time-varying models, we need to resort to numerical estimates for the factor covariance matrix. The analytical results provide a useful approximation.
4. Trading. The Factor-Mimicking Portfolio of the new factor is
$$
\mathbf{v}_{m+1}=\frac{\boldsymbol{\Omega}_{\epsilon}^{-1} \mathbf{b}_{m+1}}{\mathbf{b}_{m+1}^{\top} \boldsymbol{\Omega}_{\epsilon}^{-1} \mathbf{b}_{m+1}}
$$

This follows from the definition of FMPs, Equation (9.12). A faster route is via the factor return estimation above. The factor return estimate is the same whether we regress using residual returns or total returns ${ }^{7}$ :
$$
\begin{aligned}
\hat{f}_{m+1, t} & =\frac{\mathbf{b}_{m+1}^{\top} \boldsymbol{\Omega}_{\epsilon}^{-1} \hat{\epsilon}_{t}}{\mathbf{b}_{m+1}^{\top} \boldsymbol{\Omega}_{\epsilon}^{-1} \mathbf{b}_{m+1}} \\
& =\frac{\mathbf{b}_{m+1}^{\top} \boldsymbol{\Omega}_{\epsilon}^{-1} \mathbf{r}_{t}}{\mathbf{b}_{m+1}^{\top} \boldsymbol{\Omega}_{\epsilon}^{-1} \mathbf{b}_{m+1}} \\
& =\mathbf{v}_{m+1}^{\top} \mathbf{r}_{t}
\end{aligned}
$$

Let $\tilde{\boldsymbol{\lambda}}=\left(\boldsymbol{\lambda} \mid \hat{\lambda}_{m+1}\right)$. Finally, we solve the optimization problem
$$
\begin{aligned}
\max & \tilde{\boldsymbol{\lambda}}^{\top} \mathbf{u}-\frac{1}{2 \gamma} \mathbf{u}^{\top} \tilde{\boldsymbol{\Omega}}_{\mathbf{f}} \mathbf{u} \\
\text { s.t. } \mathbf{u} & \in \mathbb{R}^{m+1}
\end{aligned}
$$
whose solution is simple, because of the block structure of the factor covariance matrix
$$
\mathbf{u}^{\star}=\gamma\left[\begin{array}{c}
\boldsymbol{\Omega}_{\mathbf{f}}^{-1} \boldsymbol{\lambda} \\
\left(\mathbf{b}_{m+1}^{\top} \boldsymbol{\Omega}_{\boldsymbol{\epsilon}}^{-1} \mathbf{b}_{m+1}\right) \hat{\lambda}_{m+1}
\end{array}\right]
$$

So, our investment in the preexisting factors is unchanged, but we add a position in the new factor, proportional to the expected factor return divided by its variance.

\footnotetext{
${ }^{7}$ See Sections 4.7.2 and 4.7.3.
}

\subsection*{Procedure 9.1: Adding a new factor to a model and trading it}
1. Inputs: a factor model ( $\left.\mathbf{b}_{t}, \boldsymbol{\Omega}_{\mathbf{f}, t}, \boldsymbol{\Omega}_{\boldsymbol{\epsilon}, t}, \boldsymbol{\epsilon}_{t}\right)$, with expected factor returns $\boldsymbol{\lambda}$; raw loadings for the new factor $\mathbf{a}_{t}$.
2. Orthogonalize the factor:
$$
\mathbf{b}_{m+1, t}=\left(\mathbf{I}_{n}-\mathbf{b}_{t}\left(\mathbf{b}_{t}^{\top} \boldsymbol{\Omega}_{\epsilon}^{-1} \mathbf{b}_{t}\right)^{-1} \mathbf{b}_{t}^{\top} \boldsymbol{\Omega}_{\epsilon}^{-1}\right) \mathbf{a}_{t}
$$
3. Compute the Factor-Mimicking Portfolio:
$$
\begin{aligned}
\mathbf{v}_{m+1, t} & :=\frac{\boldsymbol{\Omega}_{\epsilon, t}^{-1} \mathbf{b}_{m+1, t}}{\mathbf{b}_{m+1, t}^{\top} \boldsymbol{\Omega}_{\epsilon, t}^{-1} \mathbf{b}_{m+1, t}} \\
\hat{\lambda}_{m+1} & :=\frac{1}{T} \sum_{t} \mathbf{v}_{m+1, t}^{\top} \mathbf{r}_{t}
\end{aligned}
$$
4. Compute new factor covariance matrix
$$
\tilde{\boldsymbol{\Omega}}_{\mathbf{f}} \simeq\left[\begin{array}{cc}
\boldsymbol{\Omega}_{\mathbf{f}, t} & \mathbf{0} \\
\mathbf{0} & \left(\mathbf{b}_{m+1, t}^{\top} \boldsymbol{\Omega}_{\boldsymbol{\epsilon}, t}^{-1} \mathbf{b}_{m+1, t}\right)^{-1}
\end{array}\right]
$$
5. Compute new weights for FMPs:
$$
\mathbf{u}_{t}^{\star}=\gamma\left[\begin{array}{c}
\boldsymbol{\Omega}_{\mathbf{f}, t}^{-1} \boldsymbol{\lambda} \\
\left(\mathbf{b}_{m+1}^{\top} \boldsymbol{\Omega}_{\boldsymbol{\epsilon}, t}^{-1} \mathbf{b}_{m+1, t}\right) \hat{\lambda}_{m+1, t}
\end{array}\right]
$$
and trade portfolio
$$
\mathbf{w}_{t}=\left[\begin{array}{cccc}
\mid & \mid & \ldots & \mid \\
\mathbf{v}_{1, t} & \mathbf{v}_{2, t} & \ldots & \mathbf{v}_{m+1, t} \\
\mid & \mid & \ldots & \mid
\end{array}\right] \mathbf{u}_{t}^{\star}
$$

\subsection*{9.3.3. Factor Portfolios from Sorts}

A very popular way to form factor portfolios is to sort securities by a given characteristic, and then form a portfolio in which the long positions are top $x$-quantile positions (say, the top $25 \%$ positions) and the shorts are the bottom $x$-quantile positions. The Net Market Value of each position is identical, so that the portfolio is dollar-neutral. For example, we consider book value-to-price (BtP) as the characteristic for a US investment universe of 2000 stocks, and go long $\$ 1000$ the 500 stocks with the highest value of the ratio, and short $\$ 1000$ the 500 stocks with the lowest value of the ratio. This approach originates with the paper by Fama and MacBeth [1973], who introduced them to alleviate the problem of estimation error of time-series betas of single securities, by estimating portfolio betas instead. The resulting portfolios are sometimes called portfolios from sorts or characteristic portfolios (CPs ; Daniel et al. [2020]). They are widely used by practitioners to convert a metric that describes a potential mispricing into an investable portfolio. What are the drawbacks of this approach? There are at least four.
1. The characteristic portfolios will have unwanted exposures to other factors. As a result, you may be betting on the characteristic of interest as well as on some other source of systematic risk and return. The unwanted exposures may both increase the overall portfolio risk and reduce the return of the portfolio.
2. The securities in the characteristic portfolio are equal weighted. This is inefficient, since more volatile securities should have a lower weight.
3. Being equal-weighted, the sizes in the characteristic portfolio do not reflect the magnitude of the characteristic. For example, if asset A has twice the BtP of asset B , and they both are in top $x$-quantile of the distribution,
they receive the same weight. This is the same as dichotomizing the characteristic. Dichotomization of data is usually a poor modeling strategy (see, e.g., Harrell [2015]).
4. Over time, characteristics change, and certain securities may be dropped from/added to the portfolio abruptly (from a target weight to zero). This makes trading more expensive and require some adjustment over the naÃ¯ve weights.

\subsection*{FAQ 9.1: What about factor portfolios from sorts?}
Portfolios from sorts (or characteristic portfolios) are dollar-neutral portfolios which consist of equal-weighted long positions for securities having the highest values of a certain characteristic, and equal-weighted short positions for an equal number of securities with the lowest value of a characteristic. They hold the intuitive appeal of being a simple implementation of a dollar-neutral portfolio. However they have many drawbacks: non-optimal volatility weighting, non-optimal characteristic weighting, unwanted exposures to other factors, and high turnover due to abrupt inclusions/exclusions in the portfolio. FMPs are designed to be the most efficient (i.e., lowest risk) portfolios with unit exposure to a characteristic of interest.

\section*{9.4. Trading in Idio Space}

In Section 4.3 we introduced the concepts of alpha spanned and alpha orthogonal. Alpha spanned are asset expected excess returns attributable to non-zero factor expected returns; alpha orthogonal are non explainable by factor returns. Because of Equation (4.3), Sharpe Ratio scales at least like $\sqrt{n}$. Because of this, alpha orthogonal is the golden currency in investing. How does one build a portfolio that exploits only this alpha? By requiring that the optimal portfolio have no exposures, and therefore no returns, to factors. There are many ways to achieve this, and they are encountered in practice. The first one is to build a portfolio that has an upper bound on volatility, maximizes expected returns, and has no factor exposures. By construction, the portfolio contains "pure alpha" and no factor-related PnL. The formulation is:
$$
\begin{align*}
& \max \boldsymbol{\alpha}_{\perp}^{\top} \mathbf{w}  \tag{9.18}\\
& \text { s.t. } \mathbf{B}^{\top} \mathbf{w}=0 \\
& \quad \mathbf{w}^{\top} \boldsymbol{\Omega}_{\epsilon} \mathbf{w} \leq \sigma^{2}
\end{align*}
$$
whose solution ${ }^{8}$ is
$$
\begin{aligned}
\hat{\boldsymbol{\alpha}}_{\perp} & :=\left(\mathbf{I}_{n}-\mathbf{B}\left(\mathbf{B}^{\top} \boldsymbol{\Omega}_{\epsilon}^{-1} \mathbf{B}\right)^{-1} \mathbf{B}^{\top} \boldsymbol{\Omega}_{\epsilon}^{-1}\right) \boldsymbol{\alpha}_{\perp} \\
\mathbf{w}^{\star} & =\frac{\sigma}{\sqrt{\hat{\boldsymbol{\alpha}}_{\perp}^{\top} \boldsymbol{\Omega}_{\epsilon}^{-1} \hat{\boldsymbol{\alpha}}_{\perp}}} \boldsymbol{\Omega}_{\epsilon}^{-1} \hat{\boldsymbol{\alpha}}_{\perp}
\end{aligned}
$$
\footnotetext{
${ }^{8}$ Derive it as an exercise, or see Section 9.7.2.
}
In Section 9.3.2, we built an FMP for a new factor through two steps: first, orthogonalization; second, inverse variance weighting. The portfolio construction for an alpha orthogonal portfolio is indeed, identical: orthogonalization and inverse variance weighting. If all the asset idiosyncratic volatilities are identical, $\Omega_{\epsilon}$ is proportional to the identity, and the orthogonalization step is superfluous: $\hat{\boldsymbol{\alpha}}_{\perp}=\boldsymbol{\alpha}_{\perp}$.

\section*{9.5. Drivers of Information Ratio: Information Coefficient and Diversification}

What makes a good strategy? Before we are trading (i.e., ex ante), we are living the dream, i.e. Equation (9.5):
$$
\mathrm{SR}^{\star}=\sqrt{\boldsymbol{\alpha}^{\top} \boldsymbol{\Omega}_{\mathbf{r}}^{-1} \boldsymbol{\alpha}}
$$

A substantial part of this and of the next chapter is dedicated to the notion that we do not exist in the Dreamtime. Our forecasted returns and risk models are incorrect, and we should take this knowledge in the investment process. A first step is to establish some ex post relationship for the Sharpe Ratio. Start with the solution to the MVO problem, Equation (9.3):
$$
\mathbf{w}^{\star}=\frac{\sigma}{\sqrt{\boldsymbol{\alpha}^{\top} \boldsymbol{\Omega}_{\mathbf{r}}^{-1} \boldsymbol{\alpha}}} \boldsymbol{\Omega}_{\mathbf{r}}^{-1} \boldsymbol{\alpha}
$$

And assume that the covariance matrix $\boldsymbol{\Omega}_{\mathrm{r}}$ is accurate; admittedly a strong assumption. The expected realized return is
$$
\begin{aligned}
E\left(\mathbf{r}^{\top} \mathbf{w}^{\star}\right) & =\frac{\sigma}{\sqrt{\boldsymbol{\alpha}^{\top} \boldsymbol{\Omega}_{\mathbf{r}}^{-1} \boldsymbol{\alpha}}} E\left(\mathbf{r}^{\top} \boldsymbol{\Omega}_{\mathbf{r}}^{-1} \boldsymbol{\alpha}\right) \\
& =\frac{E\left(\mathbf{r}^{\top} \boldsymbol{\Omega}_{\mathbf{r}}^{-1} \boldsymbol{\alpha}\right)}{\sqrt{\boldsymbol{\alpha}^{\top} \boldsymbol{\Omega}_{\mathbf{r}}^{-1} \boldsymbol{\alpha}} \sqrt{E\left(\mathbf{r}^{\top} \boldsymbol{\Omega}_{\mathbf{r}}^{-1} \mathbf{r}\right)}} \sqrt{\frac{E\left(\mathbf{r}^{\top} \boldsymbol{\Omega}_{\mathbf{r}}^{-1} \mathbf{r}\right)}{n}} \sqrt{n}
\end{aligned}
$$

Recall the Information Coefficient, already introduced in Section 8.3.1:
$$
\mathrm{IC}:=\frac{E\left(\mathbf{r}^{\top} \boldsymbol{\Omega}_{\mathbf{r}}^{-1} \boldsymbol{\alpha}\right)}{\sqrt{\boldsymbol{\alpha}^{\top} \boldsymbol{\Omega}_{\mathbf{r}}^{-1} \boldsymbol{\alpha}} \sqrt{E\left(\mathbf{r}^{\top} \boldsymbol{\Omega}_{\mathbf{r}}^{-1} \mathbf{r}\right)}}
$$

The important thing to know is that the Information Coefficient is a correlation. To see why, we need to transform variables:
$$
\begin{align*}
\tilde{\mathbf{r}} & =\boldsymbol{\Omega}_{\mathbf{r}}^{-1 / 2} \mathbf{r}  \tag{9.19}\\
\hat{\boldsymbol{\alpha}} & =\boldsymbol{\Omega}_{\mathbf{r}}^{-1 / 2} \boldsymbol{\alpha}
\end{align*}
$$

So that the Information Coefficient can be rewritten in a more succinct form
$$
\operatorname{IC}(\hat{\boldsymbol{\alpha}}, \tilde{\mathbf{r}}):=\frac{E\left(\tilde{\mathbf{r}}^{\top} \hat{\boldsymbol{\alpha}}\right)}{\sqrt{\hat{\boldsymbol{\alpha}}^{\top} \hat{\boldsymbol{\alpha}}} \sqrt{E\left(\tilde{\mathbf{r}}^{\top} \tilde{\mathbf{r}}\right)}}
$$
which can be interpreted as a cross-sectional uncentered correlation.
We can simplify things further by proving that $E\left(\mathbf{r}^{\top} \boldsymbol{\Omega}_{\mathbf{r}}^{-1} \mathbf{r}\right)=n$. The random vector $\mathbf{r}$ has the same covariance matrix ${ }^{9}$ as $\boldsymbol{\Omega}_{\mathbf{r}}^{1 / 2} \boldsymbol{\xi}$, where $\boldsymbol{\xi}$ is a standard multivariate normal.
$$
\begin{aligned}
E\left(\mathbf{r}^{\top} \boldsymbol{\Omega}_{\mathbf{r}}^{-1} \mathbf{r}\right) & =E\left(\boldsymbol{\xi}^{\top} \boldsymbol{\Omega}_{\mathbf{r}}^{1 / 2} \boldsymbol{\Omega}_{\mathbf{r}}^{-1} \boldsymbol{\Omega}_{\mathbf{r}}^{1 / 2} \boldsymbol{\xi}\right) \\
& =\sum_{i=1}^{n} E\left(\xi_{i}^{2}\right) \\
& =n
\end{aligned}
$$

\footnotetext{
${ }^{9}$ Prove this step-by-step in Exercise 4.3.
}

Putting everything together, the $E\left(\mathbf{r}^{\top} \mathbf{w}^{\star}\right) / \sigma$ is
$$
\mathrm{SR}=\mathrm{IC}(\hat{\boldsymbol{\alpha}}, \tilde{\mathbf{r}}) \sqrt{n}
$$

This relationship goes back to Grinold [1989] and Grinold and Kahn [1999], who named it The Fundamental Law of Active Management ${ }^{10}$. It is often invoked by practitioners. In practice, users of the formula do not whiten returns and alphas in Equation (9.19). Instead, they apply the law to the active component of a portfolio, so that $\boldsymbol{\Omega}_{\mathrm{r}}$ is replaced by the diagonal $\boldsymbol{\Omega}_{\boldsymbol{\epsilon}}$ and $\boldsymbol{\alpha}$ by $\boldsymbol{\alpha}_{\perp}$. Then, IC becomes the cross-sectional correlation between the standardized alphas (expected excess returns in units of volatility) and the standardized idio returns (so that they have unit variance).

\footnotetext{
${ }^{10}$ Quite an important name for a "law"! And why not? Nobody had thought of using this title at the time. I can imagine Grinold playing air guitar and singing to an Iron Maiden tune as he was drafting the original 1989 paper.
}


The Fundamental Law has several important implications. The first, and most obvious one, is that performance is driven by two factors. The first one is a measure of skill: the Information Coefficient. It is a strength of the predictive strength of the signal. If we have the ability to extend our forecast to a larger panel of stocks without degrading its predictive power, we should do so! This may or not be the case in real life, depending on specifics of your strategy. Many investors also have a notion of "idea velocity", expressed as the number of forecasts $T$ per year. A higher idea velocity increases, in principle, the Information Ratio. It is really difficult, however, to increase effectively the frequency of independent forecasts.

The Fundamental Law also connects Information Ratio to an ex post measure (the IC) that is interpretable as a correlation, which can be related to a special kind of regression (as per Insight 9.5).



\subsection*{Insight 9.5: Information Coefficient and predictive regression}
Being a correlation, the IC is also naturally related to the predictive strength of our alphas, as measured by a cross-sectional regression. As an important step in exploring alphas, we perform a cross-sectional weighted-least squares regression of residual returns against alpha. We estimate a coefficient $x$ that solves the following minimization problem:
$$
\min _{b} \sum_{i} \frac{\left(r_{i}-\alpha_{i} b\right)^{2}}{\sigma_{\epsilon, i}^{2}}=\min _{b}\|\tilde{\mathbf{r}}-\hat{\boldsymbol{\alpha}} b\|^{2}
$$

The solution is given by $b^{\star}=\tilde{\mathbf{r}}^{\top} \hat{\boldsymbol{\alpha}} /\|\hat{\boldsymbol{\alpha}}\|^{2}$ and the residual sum of squares is $\|\tilde{\mathbf{r}}\|^{2}-\left(\tilde{\mathbf{r}}^{\top} \hat{\boldsymbol{\alpha}}\right)^{2} /\|\hat{\boldsymbol{\alpha}}\|^{2}$, while the total sum of squares is $\|\tilde{\mathbf{r}}\|^{2}$. The Coefficient of Determination ("R squared") is, in expectation, equal to:
$$
R^{2}=\frac{\left(\tilde{\mathbf{r}}^{\top} \hat{\boldsymbol{\alpha}}\right)^{2}}{\|\hat{\boldsymbol{\alpha}}\|^{2}\|\tilde{\mathbf{r}}\|^{2}}=(\mathrm{IC})^{2}
$$

And we can link the coefficient of determination in predictive regressions to the Information Ratio:
$$
\mathrm{IR}=\sqrt{R^{2} n}
$$

If there are $T$ investment periods in a year, the annualized Information has a convenient form as a function of per-period cross-sectional R squared
$$
\mathrm{IR}=\sqrt{R^{2} n T}=\mathrm{IC} \sqrt{n T}
$$

Otherwise stated, the annualized Information Ratio is equal to the Information Coefficient times the independent number of return forecasts in a year ${ }^{a}$.

\footnotetext{
${ }^{a}$ For the relationship between Coefficient of Determination and Information Ratio, see Chincarini and Kim [2007, 2022].
}


\section*{9.6. Aggregation: Signals vs. Portfolios}

So far, we have considered the optimization of a single portfolio. That is the situation usually faced by a quantitative portfolio manager, but is far from being the only one. Let us consider two examples. In the first one, you have a fundamental portfolio manager managing a large team. In order to scale her book, the PM delegates to the analyst trading decisions for the the stocks they cover. The portfolio of the entire team is simply the aggregation of the individual portfolios. This is a fully decentralized solution to portfolio management. What would be the alternative? The analysts do their own research, summarize it into a thesis for each stock, and communicate to the PM, who converts them into positions. This is the centralized solution to portfolio management. Now, we produce the second example by going up one level. We have a large number of portfolio managers; the hedge fund has some excess capital it would like to deploy. One option available to the hedge fund is to take the portfolio positions of the individual teams, and increment them by a given percentage, say, $50 \%$. This can be directly performed at the time of an order's submission. This is
analogous to the decentralized solution in the first example. There is no need to look inside the box of a team. It's only the output that matters. The predictable alternative is the centralized solution: gather the signals from the teams and construct a portfolio. Figure 9.1 visualizes the two approaches.

[WILEY EDITORS: place Figure 9.1 around here.]

![](https://cdn.mathpix.com/cropped/2024_12_19_198f16e16831a68479f0g-342.jpg?height=353&width=1215&top_left_y=799&top_left_x=406)

Figure 9.1: Left: the decentralized solution to portfolio combination. Right: the centralized solution

A lot of PnL rides on the decision to centralize vs decentralize portfolio construction! How should we organize large teams? How should we deploy spare capital in the most efficient way? The rest of this section is devoted to proving a simple result: under some simple conditions the two approach give the same result. The conditions are, very roughly, that the portfolio constructor is a Mean-Variance optimization problem, and there are no transaction costs. Technical details matter, however. The rest of the section spells them out in detail and states the precise result. As for many equivalent results in economic theory ${ }^{11}$, the theorem is interesting because it doesn't hold in practice. It allows us to compare the idealized conditions under which it holds, and the real-world situation, and identify areas where one solution may have the advantage.

\footnotetext{
${ }^{11}$ For example, Modigliani-Miller's theorem and Merton's result on the equivalence of an option claim and a replicating portfolio.
}

Let us formalize the problem. There is an investment universe of $n$ stocks. We have $m$ portfolio managers working under a principal hedge fund manager. Without loss of generality, each one has the same investment coverage of $n$ stocks. Every portfolio manager uses the same asset covariance matrix $\boldsymbol{\Omega}_{\mathbf{r}}$, and has a forecast $\boldsymbol{\alpha}_{i}$.

We model the portfolio managers by assuming that they are mean-variance maximizers. Without loss of generality, PM $i$ produces a unit-volatility portfolio:
$$
\begin{aligned}
& \mathbf{w}_{i}=\frac{\boldsymbol{\Omega}_{\mathbf{r}}^{-1} \boldsymbol{\alpha}_{i}}{\sigma_{i}} \\
& \sigma_{i}:=\sqrt{\boldsymbol{\alpha}_{i}^{\top} \boldsymbol{\Omega}_{\mathbf{r}}^{-1} \boldsymbol{\alpha}_{i}}
\end{aligned}
$$

Now we consider two procedures.
1. Decentralized: PMs trade, the hedge fund manager estimates their Sharpe Ratios and return correlations, and combines their portfolios so as to maximize the overall Sharpe Ratio.
2. Centralized: The hedge fund manager receives the signals, simulates their properties (e.g., Sharpe Ratio of the MVO portfolios and return correlations of the portfolios) and then combines the signals and trade a single Sharpe-maximizing portfolio.

We consider the two solutions.
1. Decentralized solution. The hedge fund manager observes Sharpe Ratio $s_{i}$, for $i=1, \ldots, m$ for each PM, as well as the correlation matrix $\mathbf{C}$ for the $m$. Consider Example ?? in Appendix 9.7: the optimal dollar volatility allocated to strategy $i$ is $v_{i}:=\left[\mathbf{C}^{-1} \mathbf{s}\right]_{i}$. The portfolios $\mathbf{w}_{i}$ have
unit volatility, hence the aggregated portfolio is
$$
\mathbf{w}_{\mathrm{dec}}=\sum_{i} v_{i} \mathbf{w}_{i}=\sum_{i}\left[\mathbf{C}^{-1} \mathbf{s}\right]_{i} \frac{\boldsymbol{\Omega}_{\mathbf{r}}^{-1} \boldsymbol{\alpha}_{i}}{\sigma_{i}}
$$
2. Centralized solution. The hedge fund manager receives signals and aggregates them: $\boldsymbol{\alpha}=\sum_{i} u_{i} \boldsymbol{\alpha}_{i}$. We need to identify weights $u_{i}$. Let $\mathbf{a}:=E(\mathbf{r})$. The expected PnL of the portfolio $\boldsymbol{\Omega}_{\mathbf{r}}^{-1} \boldsymbol{\alpha}$ is
$$
\begin{array}{r}
\mathbf{a}^{\top} \boldsymbol{\Omega}_{\mathbf{r}}^{-1} \sum_{i} u_{i} \boldsymbol{\alpha}_{i}=\sum_{i} u_{i} \mathbf{a}^{\top} \boldsymbol{\Omega}_{\mathbf{r}}^{-1} \boldsymbol{\alpha}_{i} \\
=\sum_{i} u_{i} \sigma_{i} s_{i}
\end{array}
$$

The covariance of the portfolio is
$$
\begin{aligned}
\left(\boldsymbol{\Omega}_{\mathbf{r}}^{-1} \sum_{i} u_{i} \boldsymbol{\alpha}_{i}\right)^{\top} \boldsymbol{\Omega}_{\mathbf{r}}\left(\boldsymbol{\Omega}_{\mathbf{r}}^{-1} \sum_{j} u_{j} \boldsymbol{\alpha}_{j}\right) & =\sum_{i} \sum_{j} \boldsymbol{\alpha}_{i}^{\top} \boldsymbol{\Omega}_{\mathbf{r}}^{-1} \boldsymbol{\alpha}_{j} u_{i} u_{j} \\
& =\sum_{i} \sum_{j}[\mathbf{C}]_{i, j} \sigma_{i} \sigma_{j} u_{i} u_{j}
\end{aligned}
$$

We find the weights so that the hedge fund manager maximizes the Sharpe Ratio. Define $x_{i}:=\sigma_{i} u_{i}$. The maximization problem is
$$
\begin{aligned}
& \max \frac{\mathbf{s}^{\top} \mathbf{x}}{\sqrt{\mathbf{x}^{\top} \mathbf{C x}}} \\
& \text { s.t. } \mathbf{x} \in \mathbf{R}^{m}
\end{aligned}
$$

The solution is $\mathbf{x}^{\star}=\mathbf{C}^{-1} \mathbf{s} / \sqrt{\mathbf{s C}^{-1} \mathbf{s}}$, so that
$$
\mathbf{w}_{\mathrm{cen}}=\frac{1}{\sqrt{\mathbf{s C}^{-1} \mathbf{s}}} \boldsymbol{\Omega}_{\mathbf{r}}^{-1} \sum_{i} \frac{\left[\mathbf{C}^{-1} \mathbf{s}\right]_{i}}{\sigma_{i}} \boldsymbol{\alpha}_{i}
$$

The two portfolios $\mathbf{w}_{\mathrm{cen}}$ and $\mathbf{w}_{\mathrm{dec}}$ are identical, save for a multiplicative constant,
which is not essential.
This equivalency result is, in a sense, positive, because it suggests that, at least to a first approximation, we can decentralize portfolio construction decisions. What could go wrong? A lot. It is a good point to reexamine the assumptions:
- First, we have ignored execution costs. It is possible that the centralized solution has the advantage, since it would net out opposite-side positions of individual portfolio managers. Optimal execution turns the problem into a multi-period one, so that the analysis in this section does not carry over.
- Secondly, we have assumed that the portfolio manager solve an MVO problem; the formulation accommodates total return and idio return problems. In real-world implementations, there are side constraints that may differ by portfolio managers. Covariance matrices may also differ among managers, and between them and the hedge fund manager.
- When the individual units are not systematic, but rather discretionary portfolio managers, the portfolios produced by them are not generated by MVO.
- In many cases, the volatility allocation to the signals of the PMs in the centralized solution is not done using MVO. Heuristics, precommitments to individual PMs, and other constraints may play a role.
- Finally, especially in the latter case of discretionary managers, the alpha signal may not be communicated in a timely manner.

In summary, the result suggests that in a real-world setting, provided that transaction costs do not dominate and that agents are MVO optimizers, the centralized solution should not dramatically dominate the decentralized one. The emphasis is on "suggests"; more research is (always) needed.

\section*{9.7. ÃAppendix}

\subsection*{9.7.1. Some Useful Results from Linear Algebra}

Spiked Covariance Matrices are the sum of a full-rank sparse (possibly diagonal) matrix and a low-rank matrix. For this class of matrices, there are useful, computationally cheap ways to compute inverse and determinant: the Woodbury-Sherman-Morrison Lemma, and the Matrix Determinant Lemma.

Woodbury-Sherman-Morrison Lemma. Useful to compute the inverse of a matrix (e.g., min-variance portfolio and log-likelihood).
$$
\begin{equation*}
\left(\mathbf{D}+\mathbf{B} \boldsymbol{\Omega} \mathbf{B}^{\top}\right)^{-1}=\mathbf{D}^{-1}-\mathbf{D}^{-1} \mathbf{B}\left(\boldsymbol{\Omega}^{-1}+\mathbf{B}^{\top} \mathbf{D}^{-1} \mathbf{B}\right)^{-1} \mathbf{B}^{\top} \mathbf{D}^{-1} \tag{9.20}
\end{equation*}
$$

Determinant Lemma. Useful in log-likelihood calculations.
$$
\begin{equation*}
\operatorname{det}\left(\mathbf{D}+\mathbf{B} \boldsymbol{\Omega} \mathbf{B}^{\boldsymbol{\top}}\right)=\operatorname{det}(\mathbf{D}) \operatorname{det}(\boldsymbol{\Omega}) \operatorname{det}\left(\boldsymbol{\Omega}^{-1}+\mathbf{B}^{\top} \mathbf{D}^{-1} \mathbf{B}\right) \tag{9.21}
\end{equation*}
$$

\subsection*{9.7.2. Some Portfolio Optimization Problems}

Example 9.1(Maximize expected return subject to a vol constraint and linear homogeneous equalities):
$$
\begin{align*}
& \max \boldsymbol{\alpha}^{\top} \mathbf{w}  \tag{9.22}\\
& \text { s.t. } \mathbf{B}^{\top} \mathbf{w}=0 \\
& \quad \mathbf{w}^{\top} \boldsymbol{\Omega} \mathbf{w} \leq \sigma^{2}
\end{align*}
$$

The solution $\mathbf{w}^{\star}$ to this problem is given by
$$
\begin{aligned}
\boldsymbol{\Pi} & :=\mathbf{I}_{n}-\mathbf{B}\left(\mathbf{B}^{\top} \boldsymbol{\Omega}^{-1} \mathbf{B}\right)^{-1} \mathbf{B}^{\top} \boldsymbol{\Omega}^{-1} \\
\tilde{\boldsymbol{\alpha}} & :=\boldsymbol{\Pi} \boldsymbol{\alpha} \\
\mathbf{w}^{\star} & =\frac{\sigma}{\sqrt{\tilde{\boldsymbol{\alpha}}^{\top} \boldsymbol{\Omega}^{-1} \tilde{\boldsymbol{\alpha}}}} \boldsymbol{\Omega}^{-1} \tilde{\boldsymbol{\alpha}}
\end{aligned}
$$

Example 9.2(Minimum-variance portfolio subject to linear equalities):
$$
\begin{align*}
& \min \mathbf{w}^{\top} \boldsymbol{\Omega} \mathbf{w}  \tag{9.23}\\
& \text { s.t. } \mathbf{B}^{\top} \mathbf{w}=\mathbf{b} \tag{9.24}
\end{align*}
$$

The solution is $\mathbf{w}^{\star}=\boldsymbol{\Omega}^{-1} \mathbf{B}\left(\mathbf{B}^{\top} \boldsymbol{\Omega}^{-1} \mathbf{B}\right)^{-1} \mathbf{b}$. Of special interest is the case where $\boldsymbol{\Omega}=\mathbf{B} \boldsymbol{\Omega}_{\mathbf{f}} \mathbf{B}^{\boldsymbol{\top}}+\boldsymbol{\Omega}_{\boldsymbol{\epsilon}}$. In this case the objective is equal to $\mathbf{b}^{\top} \boldsymbol{\Omega}_{\mathbf{f}} \mathbf{b}+$ $\mathbf{w}^{\top} \boldsymbol{\Omega}_{\epsilon} \mathbf{W}$. The first term is constant, so the objective is $\mathbf{w}^{\top} \boldsymbol{\Omega}_{\epsilon} \mathbf{W}$, and the $\mathbf{w}^{\star}=$ $\boldsymbol{\Omega}_{\boldsymbol{\epsilon}}^{-1} \mathbf{B}\left(\mathbf{B}^{\top} \boldsymbol{\Omega}_{\boldsymbol{\epsilon}}^{-1} \mathbf{B}\right)^{-1} \mathbf{b}=\mathbf{P b}$, where $\mathbf{P}$ is the matrix whose columns are the Factor-Mimicking Portfolios associated to the factor model. These are introduced in Section 9.3.

\subsection*{9.7.3. Optimality of FMPs}

We now prove that FMPs emerge naturally from certain assumptions about returns and FMP composition, which we use in Section 9.3.

Theorem 9.1: Consider a sequence of models $\left(\mathbf{B}, \boldsymbol{\Omega}_{\mathbf{f}}, \boldsymbol{\Omega}_{\epsilon}^{(i)}\right)$. Assume that
1. Alpha orthogonal is zero, so that $\boldsymbol{\alpha}=\mathbf{B} \boldsymbol{\lambda}$, for some $\boldsymbol{\lambda} \in \mathbb{R}^{m}$.
2. Idiosyncratic variance converges to zero in norm:
$$
\lim _{i \rightarrow \infty}\left\|\left(\mathbf{B}^{\top}\left(\boldsymbol{\Omega}_{\epsilon}^{(i)}\right)^{-1} \mathbf{B}\right)^{-1}\right\|=0
$$

Then in the limit Sharpe-optimizing portfolio is a weighted sum of the FMPs, and the weights themselves solve a MVO in factor space
$$
\begin{aligned}
\mathbf{w}^{\star} & =\mathbf{P} \mathbf{u}^{\star} \\
\text { where } \mathbf{u}^{\star} & =\arg \max \left\{\mathbf{u} \in \mathbb{R}^{m} \mid \boldsymbol{\lambda}^{\top} \mathbf{u}-(1 / 2 \gamma) \mathbf{u}^{\top} \boldsymbol{\Omega}_{\mathbf{f}} \mathbf{u}\right\} \\
& =\gamma \boldsymbol{\Omega}_{\mathbf{f}}^{-1} \boldsymbol{\lambda}
\end{aligned}
$$
for some $\gamma>0$. The Sharpe Ratio of the optimal portfolio is equal to $S R^{\star}=$ $\sqrt{\lambda^{\top} \Omega_{f}^{-1} \lambda}$.

The second condition on idiosyncratic variance has a simple interpretation. It is easy to check that the term inside the norm is $\mathbf{P}^{\top} \boldsymbol{\Omega}_{\epsilon}^{(i)} \mathbf{P}$, i.e., the covariance matrix of the idiosyncratic PnL of the FMPs. The condition states that the idiosyncratic variance of the FMPs goes to zero. Proof. Start with the Sharpe-optimizing portfolio problem, Equation (9.8):
$$
\begin{aligned}
& \max _{\mathbf{w} \in \mathbb{R}^{n}} \boldsymbol{\alpha}^{\top} \mathbf{w}-\frac{1}{2 \gamma} \mathbf{w}^{\top} \boldsymbol{\Omega}_{\mathbf{r}} \mathbf{w} \\
\Rightarrow \mathbf{w}^{\star} & =\gamma \boldsymbol{\Omega}_{\mathbf{r}}^{-1} \mathbf{B} \boldsymbol{\lambda} \\
& =\gamma\left[\left(\boldsymbol{\Omega}_{\epsilon}^{(i)}\right)^{-1}-\left(\boldsymbol{\Omega}_{\epsilon}^{(i)}\right)^{-1} \mathbf{B}\left(\boldsymbol{\Omega}_{\mathbf{f}}^{-1}+\mathbf{B}^{\top}\left(\boldsymbol{\Omega}_{\epsilon}^{(i)}\right)^{-1} \mathbf{B}\right)^{-1} \mathbf{B}^{\top}\left(\boldsymbol{\Omega}_{\epsilon}^{(i)}\right)^{-1}\right] \mathbf{B} \boldsymbol{\lambda}
\end{aligned}
$$

The second identity is Woodbury-Sherman-Morrison Lemma.

Now we perform a first-order expansion: Notice that ${ }^{12}$
$$
\left\|\boldsymbol{\Omega}_{\mathbf{f}}^{-1}\left(\mathbf{B}^{\top}\left(\boldsymbol{\Omega}_{\epsilon}^{(i)}\right)^{-1} \mathbf{B}\right)^{-1}\right\| \leq\left\|\boldsymbol{\Omega}_{\mathbf{f}}^{-1}\right\|\left\|\left(\mathbf{B}^{\top}\left(\boldsymbol{\Omega}_{\epsilon}^{(i)}\right)^{-1} \mathbf{B}\right)^{-1}\right\| \rightarrow 0, \quad i \rightarrow \infty
$$

So we perform a first-order approximation of the inverse ${ }^{13}$ :
$$
\begin{aligned}
\left(\boldsymbol{\Omega}_{\mathbf{f}}^{-1}+\mathbf{B}^{\top}\left(\boldsymbol{\Omega}_{\epsilon}^{(i)}\right)^{-1} \mathbf{B}\right)^{-1} & =\left[\left(\boldsymbol{\Omega}_{\mathbf{f}}^{-1}\left(\mathbf{B}^{\top}\left(\boldsymbol{\Omega}_{\epsilon}^{(i)}\right)^{-1} \mathbf{B}\right)^{-1}+\mathbf{I}_{m}\right)\left(\mathbf{B}^{\top}\left(\boldsymbol{\Omega}_{\epsilon}^{(i)}\right)^{-1} \mathbf{B}\right)\right]^{-1} \\
& \simeq\left(\mathbf{B}^{\top}\left(\boldsymbol{\Omega}_{\epsilon}^{(i)}\right)^{-1} \mathbf{B}\right)^{-1}\left[\mathbf{I}_{m}-\boldsymbol{\Omega}_{\mathbf{f}}^{-1}\left(\mathbf{B}^{\top}\left(\boldsymbol{\Omega}_{\epsilon}^{(i)}\right)^{-1} \mathbf{B}\right)^{-1}\right]
\end{aligned}
$$

Replace the expression in the solution of $\mathbf{w}^{\star}$ :
$$
\begin{aligned}
\mathbf{w}^{\star} & =\gamma\left(\boldsymbol{\Omega}_{\epsilon}^{(i)}\right)^{-1}\left[\mathbf{B}-\mathbf{B}\left(\mathbf{B}^{\top}\left(\boldsymbol{\Omega}_{\epsilon}^{(i)}\right)^{-1} \mathbf{B}\right)^{-1}\left[\mathbf{I}_{m}-\boldsymbol{\Omega}_{\mathbf{f}}^{-1}\left(\mathbf{B}^{\top}\left(\boldsymbol{\Omega}_{\epsilon}^{(i)}\right)^{-1} \mathbf{B}\right)^{-1}\right] \mathbf{B}^{\top}\left(\boldsymbol{\Omega}_{\epsilon}^{(i)}\right) \mathbf{B}\right] \boldsymbol{\lambda} \\
& =\gamma\left(\boldsymbol{\Omega}_{\epsilon}^{(i)}\right)^{-1}\left[\mathbf{B}-\mathbf{B}\left(\mathbf{B}^{\top}\left(\boldsymbol{\Omega}_{\epsilon}^{(i)}\right)^{-1} \mathbf{B}\right)^{-1}\left[\mathbf{B}^{\top}\left(\boldsymbol{\Omega}_{\epsilon}^{(i)}\right) \mathbf{B}-\boldsymbol{\Omega}_{\mathbf{f}}^{-1}\right]\right] \boldsymbol{\lambda} \\
& =\gamma\left(\boldsymbol{\Omega}_{\epsilon}^{(i)}\right)^{-1} \mathbf{B}\left(\mathbf{B}^{\top}\left(\boldsymbol{\Omega}_{\epsilon}^{(i)}\right)^{-1} \mathbf{B}\right)^{-1} \boldsymbol{\Omega}_{\mathbf{f}}^{-1} \boldsymbol{\lambda} \\
& =\mathbf{P u}^{\star}
\end{aligned}
$$

The expected PnL of the optimal solution is $\gamma \boldsymbol{\lambda}^{\top} \boldsymbol{\Omega}_{\mathbf{f}}^{-1} \boldsymbol{\lambda}$. The factor exposure of the optimal solution is $\gamma \boldsymbol{\Omega}_{\mathrm{f}}^{-1} \boldsymbol{\lambda}$. The factor variance is $\gamma^{2} \boldsymbol{\lambda}^{\top} \boldsymbol{\Omega}_{\mathrm{f}}^{-1} \boldsymbol{\lambda}$. The idiosyncratic variance is
$$
\begin{aligned}
\left(\mathbf{w}^{\star}\right)^{\top} \boldsymbol{\Omega}_{\epsilon}^{(i)} \mathbf{w}^{\star} & =\mathbf{P}^{\top} \boldsymbol{\Omega}_{\epsilon} \mathbf{P} \\
& =\left(\mathbf{u}^{\star}\right)^{\top}\left(\mathbf{B}^{\top}\left(\boldsymbol{\Omega}_{\epsilon}^{(i)}\right)^{-1} \mathbf{B}\right)^{-1} \mathbf{u}^{\star} \\
& \leq\left\|\left(\mathbf{B}^{\top}\left(\boldsymbol{\Omega}_{\epsilon}^{(i)}\right)^{-1} \mathbf{B}\right)^{-1}\right\|\left\|\mathbf{u}^{\star}\right\|^{2}
\end{aligned}
$$
and is zero in the limit, per the second assumption. The Sharpe Ratio is $\sqrt{\lambda^{\top} \Omega_{f}^{-1} \lambda}$.

\footnotetext{
${ }^{12}$ Given two square matrices $\mathbf{A}, \mathbf{B}$, the inequality on spectral norms $\|\mathbf{A B}\| \leq\|\mathbf{A}\|\|\mathbf{B}\|$ holds.
${ }^{13}$ The first-order expansion (from Neumann's series) is $(\mathbf{I}+\mathbf{A})^{-1} \simeq \mathbf{I}-\mathbf{A}$.
}

\subsection*{9.7.4. Single-Factor Covariance Matrix Updating}

Here we prove a basic result on the updated factor covariance matrix when adding a new factor. The analysis assumes that the parameters $\mathbf{B}, \boldsymbol{\Omega}_{\mathbf{f}}, \boldsymbol{\Omega}_{\boldsymbol{\epsilon}}$ of the factor model are constant, and so is the vector a or characteristics that we using to augment the factor model. As in Section 9.3.2.

Theorem 9.2: Let the loadings, factor covariance matrix and idiosyncratic of a factor model be $\mathbf{B}, \boldsymbol{\Omega}_{\mathbf{f}}, \boldsymbol{\Omega}_{\boldsymbol{\epsilon}}$, and let $\mathbf{a} \in \mathbb{R}^{n}$ be a vector of characteristic. Define
$$
\mathbf{b}_{m+1}=\left(\mathbf{I}_{n}-\mathbf{B}\left(\mathbf{B}^{\top} \boldsymbol{\Omega}_{\epsilon}^{-1} \mathbf{B}\right)^{-1} \mathbf{B}^{\top} \boldsymbol{\Omega}_{\epsilon}^{-1}\right) \mathbf{a}
$$

The factor covariance matrix associated to the model with loadings $\left[\mathbf{B} \mid \mathbf{b}_{m+1}\right]$ is given by
$$
\tilde{\boldsymbol{\Omega}}_{\mathrm{f}} \simeq\left[\begin{array}{cc}
\boldsymbol{\Omega}_{\mathbf{f}} & \mathbf{0} \\
\mathbf{0} & \hat{\sigma}_{m+1}^{2}
\end{array}\right]
$$

Proof. Let the factor return of the new factor be
$$
\begin{aligned}
\hat{f}_{m+1, t} & =\left(\frac{\mathbf{b}_{m+1}^{\top} \boldsymbol{\Omega}_{\epsilon}^{-1}}{\mathbf{b}_{m+1}^{\top} \boldsymbol{\Omega}_{\epsilon}^{-1} \mathbf{b}_{m+1}}\right) \mathbf{r}_{t} \\
& =\mathbf{v}_{m+1}^{\top} \mathbf{r}_{t}
\end{aligned}
$$
as in Equation (9.14). We assume that the new factor does not have a big impact on the idiosyncratic returns in the sense that $\left|b_{m+1, i} \hat{f}_{m+1, t}\right| \ll\left|\epsilon_{t, i}\right|$, so that $\Omega_{\epsilon}$ is approximately unchanged by the addition of the new factor. Then the volatility of the new factor is $\hat{\sigma}_{m+1}=\left(\mathbf{b}_{m+1}^{\top} \boldsymbol{\Omega}_{\epsilon}^{-1} \mathbf{b}_{m+1}\right)^{-1 / 2}$.
$$
\begin{aligned}
\hat{f}_{m+1, t}^{2} & =\frac{E\left(\mathbf{b}_{m+1}^{\top} \boldsymbol{\Omega}_{\epsilon}^{-1} \boldsymbol{\epsilon}_{t} \epsilon_{t}^{\top} \boldsymbol{\Omega}_{\epsilon}^{-1} \mathbf{b}_{m+1}\right)}{\left(\mathbf{b}_{m+1}^{\top} \boldsymbol{\Omega}_{\epsilon}^{-1} \mathbf{b}_{m+1}\right)^{2}} \\
\Rightarrow \hat{\sigma}_{m+1}^{2} & =\frac{\mathbf{b}_{m+1}^{\top} \boldsymbol{\Omega}_{\epsilon}^{-1} \boldsymbol{\Omega}_{\epsilon} \boldsymbol{\Omega}_{\epsilon}^{-1} \mathbf{b}_{m+1}}{\left(\mathbf{b}_{m+1}^{\top} \boldsymbol{\Omega}_{\epsilon}^{-1} \mathbf{b}_{m+1}\right)^{2}} \\
& =\left(\mathbf{b}_{m+1}^{\top} \boldsymbol{\Omega}_{\epsilon}^{-1} \mathbf{b}_{m+1}\right)^{-1}
\end{aligned}
$$

We show that $\hat{f}_{m+1}$ is approximately uncorrelated to the first $m$ factors. The column vector of the first $m$ factor returns is $\mathbf{P}^{\top} \mathbf{r}_{t}$.
$$
\begin{aligned}
E\left(\mathbf{f} \hat{f}_{m+1}\right) & =E\left(\mathbf{P}^{\top} \mathbf{r}_{t} \mathbf{r}_{t}^{\top} \mathbf{v}_{m+1}\right) \\
& =\hat{\sigma}_{m+1}^{2} \mathbf{P}^{\top} \boldsymbol{\Omega}_{\mathbf{r}} \boldsymbol{\Omega}_{\epsilon}^{-1} \mathbf{b}_{m+1} \\
& =\hat{\sigma}_{m+1}^{2} \mathbf{P}^{\top}\left(\mathbf{B} \boldsymbol{\Omega}_{\mathbf{f}} \mathbf{B}^{\top}+\boldsymbol{\Omega}_{\epsilon}\right) \boldsymbol{\Omega}_{\epsilon}^{-1} \mathbf{b}_{m+1} \\
& =\hat{\sigma}_{m+1}^{2}\left(\boldsymbol{\Omega}_{\mathbf{f}}\left(\mathbf{B}^{\top} \boldsymbol{\Omega}_{\epsilon}^{-1} \mathbf{b}_{m+1}\right)+\mathbf{P}^{\top} \boldsymbol{\Omega}_{\epsilon}^{-1} \mathbf{b}_{m+1}\right) \\
& =\mathbf{P}^{\top} \boldsymbol{\Omega}_{\epsilon} \mathbf{v}_{m+1}
\end{aligned}
$$

The last equality follows from the orthogonality of $\mathbf{b}_{m+1}$. The correlation between FMPs is given by the idiosyncratic component of their returns, which should be small if the factors are diversified.
